!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);onmessage=function(e){!function(e){self.printStream="",e='\nlocal js = require "js"\nlocal oldPrint = print\n_G.print = function(...)\n    local elements = table.pack(...)\n    for i = 1, elements.n do\n      js.global.printStream = js.global.printStream .. tostring(elements[i]) .. "\\t"\n    end\n    js.global.printStream = js.global.printStream .. "\\n"\nend\n'+e;var t=r.lauxlib.luaL_newstate();if(r.lualib.luaL_openlibs(t),r.lauxlib.luaL_requiref(t,r.to_luastring("js"),r.interop.luaopen_js,1),r.lua.lua_pop(t,1),r.lauxlib.luaL_dostring(t,r.to_luastring(e))===r.lua.LUA_OK){if(r.lua.lua_isboolean(t,-1))return r.lua.lua_toboolean(t,-1);if(r.lua.lua_isnil(t,-1))return null;if(r.lua.lua_isnumber(t,-1))return r.lua.lua_tonumber(t,-1);if(r.lua.lua_isstring(t,-1))return r.lua.lua_tojsstring(t,-1);throw new Error("Unsupported lua return type: "+r.to_jsstring(r.lua.lua_typename(t,r.lua.lua_type(t,-1))))}throw new Error("LUA ERROR: "+r.to_jsstring(r.lua.lua_tostring(t,-1).filter(function(e){return e>=20})))}(e.data.luaStr),postMessage({luaPrint:self.printStream})}},function(e,t){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=34)}([function(e,t,n){"use strict";
/**
@license MIT

Copyright Â© 2017-2018 Benoit Giannangeli
Copyright Â© 2017-2018 Daurnimator
Copyright Â© 1994â€“2017 Lua.org, PUC-Rio.
*/const r=n(5);e.exports.FENGARI_AUTHORS=r.FENGARI_AUTHORS,e.exports.FENGARI_COPYRIGHT=r.FENGARI_COPYRIGHT,e.exports.FENGARI_RELEASE=r.FENGARI_RELEASE,e.exports.FENGARI_VERSION=r.FENGARI_VERSION,e.exports.FENGARI_VERSION_MAJOR=r.FENGARI_VERSION_MAJOR,e.exports.FENGARI_VERSION_MINOR=r.FENGARI_VERSION_MINOR,e.exports.FENGARI_VERSION_NUM=r.FENGARI_VERSION_NUM,e.exports.FENGARI_VERSION_RELEASE=r.FENGARI_VERSION_RELEASE,e.exports.luastring_eq=r.luastring_eq,e.exports.luastring_indexOf=r.luastring_indexOf,e.exports.luastring_of=r.luastring_of,e.exports.to_jsstring=r.to_jsstring,e.exports.to_luastring=r.to_luastring,e.exports.to_uristring=r.to_uristring;const a=n(3),u=n(2),l=n(7),s=n(17);e.exports.luaconf=a,e.exports.lua=u,e.exports.lauxlib=l,e.exports.lualib=s},function(e,t,n){"use strict";let r,a,u;if(r="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e){let t=0,n=e.length,r=new Uint8Array(n);for(;n>t;)r[t]=e[t++];return r},"function"==typeof(new Uint8Array).indexOf)a=function(e,t,n){return e.indexOf(t,n)};else{let e=[].indexOf;if(0!==e.call(new Uint8Array(1),0))throw Error("missing .indexOf");a=function(t,n,r){return e.call(t,n,r)}}u="function"==typeof Uint8Array.of?Uint8Array.of.bind(Uint8Array):function(){return r(arguments)};const l=function(e){return e instanceof Uint8Array},s="cannot convert invalid utf8 to javascript string",o=";,/?:@&=+$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,-_.!~*'()#".split("").reduce(function(e,t){return e[t.charCodeAt(0)]=!0,e},{}),i={},c=function(e,t){if("string"!=typeof e)throw new TypeError("to_luastring expects a javascript string");if(t){let t=i[e];if(l(t))return t}let n=e.length,a=Array(n),u=0;for(let t=0;t<n;++t){let r=e.charCodeAt(t);if(r<=127)a[u++]=r;else if(r<=2047)a[u++]=192|r>>6,a[u++]=128|63&r;else{if(r>=55296&&r<=56319&&t+1<n){let n=e.charCodeAt(t+1);n>=56320&&n<=57343&&(t++,r=1024*(r-55296)+n+9216)}r<=65535?(a[u++]=224|r>>12,a[u++]=128|r>>6&63,a[u++]=128|63&r):(a[u++]=240|r>>18,a[u++]=128|r>>12&63,a[u++]=128|r>>6&63,a[u++]=128|63&r)}}return a=r(a),t&&(i[e]=a),a};e.exports.luastring_from=r,e.exports.luastring_indexOf=a,e.exports.luastring_of=u,e.exports.is_luastring=l,e.exports.luastring_eq=function(e,t){if(e!==t){let n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1}return!0},e.exports.to_jsstring=function(e,t,n,r){if(!l(e))throw new TypeError("to_jsstring expects a Uint8Array");n=void 0===n?e.length:Math.min(e.length,n);let a="";for(let u=void 0!==t?t:0;u<n;){let t=e[u++];if(t<128)a+=String.fromCharCode(t);else if(t<194||t>244){if(!r)throw RangeError(s);a+="ï¿½"}else if(t<=223){if(u>=n){if(!r)throw RangeError(s);a+="ï¿½";continue}let l=e[u++];if(128!=(192&l)){if(!r)throw RangeError(s);a+="ï¿½";continue}a+=String.fromCharCode(((31&t)<<6)+(63&l))}else if(t<=239){if(u+1>=n){if(!r)throw RangeError(s);a+="ï¿½";continue}let l=e[u++];if(128!=(192&l)){if(!r)throw RangeError(s);a+="ï¿½";continue}let o=e[u++];if(128!=(192&o)){if(!r)throw RangeError(s);a+="ï¿½";continue}let i=((15&t)<<12)+((63&l)<<6)+(63&o);if(i<=65535)a+=String.fromCharCode(i);else{let e=55296+((i-=65536)>>10),t=i%1024+56320;a+=String.fromCharCode(e,t)}}else{if(u+2>=n){if(!r)throw RangeError(s);a+="ï¿½";continue}let l=e[u++];if(128!=(192&l)){if(!r)throw RangeError(s);a+="ï¿½";continue}let o=e[u++];if(128!=(192&o)){if(!r)throw RangeError(s);a+="ï¿½";continue}let i=e[u++];if(128!=(192&i)){if(!r)throw RangeError(s);a+="ï¿½";continue}let c=((7&t)<<18)+((63&l)<<12)+((63&o)<<6)+(63&i),_=55296+((c-=65536)>>10),f=c%1024+56320;a+=String.fromCharCode(_,f)}}return a},e.exports.to_uristring=function(e){if(!l(e))throw new TypeError("to_uristring expects a Uint8Array");let t="";for(let n=0;n<e.length;n++){let r=e[n];o[r]?t+=String.fromCharCode(r):t+="%"+(r<16?"0":"")+r.toString(16)}return t},e.exports.to_luastring=c,e.exports.from_userstring=function(e){if(!l(e)){if("string"!=typeof e)throw new TypeError("expects an array of bytes or javascript string");e=c(e)}return e};const _=c("Lua");e.exports.LUA_SIGNATURE=_,e.exports.LUA_VERSION_MAJOR="5",e.exports.LUA_VERSION_MINOR="3",e.exports.LUA_VERSION_NUM=503,e.exports.LUA_VERSION_RELEASE="4",e.exports.LUA_VERSION="Lua 5.3",e.exports.LUA_RELEASE="Lua 5.3.4",e.exports.LUA_COPYRIGHT="Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio",e.exports.LUA_AUTHORS="R. Ierusalimschy, L. H. de Figueiredo, W. Celes";const f={LUA_TNONE:-1,LUA_TNIL:0,LUA_TBOOLEAN:1,LUA_TLIGHTUSERDATA:2,LUA_TNUMBER:3,LUA_TSTRING:4,LUA_TTABLE:5,LUA_TFUNCTION:6,LUA_TUSERDATA:7,LUA_TTHREAD:8,LUA_NUMTAGS:9};f.LUA_TSHRSTR=0|f.LUA_TSTRING,f.LUA_TLNGSTR=16|f.LUA_TSTRING,f.LUA_TNUMFLT=0|f.LUA_TNUMBER,f.LUA_TNUMINT=16|f.LUA_TNUMBER,f.LUA_TLCL=0|f.LUA_TFUNCTION,f.LUA_TLCF=16|f.LUA_TFUNCTION,f.LUA_TCCL=32|f.LUA_TFUNCTION;const{LUAI_MAXSTACK:p}=n(3),L=-p-1e3;e.exports.LUA_HOOKCALL=0,e.exports.LUA_HOOKCOUNT=3,e.exports.LUA_HOOKLINE=2,e.exports.LUA_HOOKRET=1,e.exports.LUA_HOOKTAILCALL=4,e.exports.LUA_MASKCALL=1,e.exports.LUA_MASKCOUNT=8,e.exports.LUA_MASKLINE=4,e.exports.LUA_MASKRET=2,e.exports.LUA_MINSTACK=20,e.exports.LUA_MULTRET=-1,e.exports.LUA_OPADD=0,e.exports.LUA_OPBAND=7,e.exports.LUA_OPBNOT=13,e.exports.LUA_OPBOR=8,e.exports.LUA_OPBXOR=9,e.exports.LUA_OPDIV=5,e.exports.LUA_OPEQ=0,e.exports.LUA_OPIDIV=6,e.exports.LUA_OPLE=2,e.exports.LUA_OPLT=1,e.exports.LUA_OPMOD=3,e.exports.LUA_OPMUL=2,e.exports.LUA_OPPOW=4,e.exports.LUA_OPSHL=10,e.exports.LUA_OPSHR=11,e.exports.LUA_OPSUB=1,e.exports.LUA_OPUNM=12,e.exports.LUA_REGISTRYINDEX=L,e.exports.LUA_RIDX_GLOBALS=2,e.exports.LUA_RIDX_LAST=2,e.exports.LUA_RIDX_MAINTHREAD=1,e.exports.constant_types=f,e.exports.lua_Debug=class{constructor(){this.event=NaN,this.name=null,this.namewhat=null,this.what=null,this.source=null,this.currentline=NaN,this.linedefined=NaN,this.lastlinedefined=NaN,this.nups=NaN,this.nparams=NaN,this.isvararg=NaN,this.istailcall=NaN,this.short_src=null,this.i_ci=null}},e.exports.lua_upvalueindex=function(e){return L-e},e.exports.thread_status={LUA_OK:0,LUA_YIELD:1,LUA_ERRRUN:2,LUA_ERRSYNTAX:3,LUA_ERRMEM:4,LUA_ERRGCMM:5,LUA_ERRERR:6}},function(e,t,n){"use strict";const r=n(1),a=n(18),u=n(11),l=n(8),s=n(12);e.exports.LUA_AUTHORS=r.LUA_AUTHORS,e.exports.LUA_COPYRIGHT=r.LUA_COPYRIGHT,e.exports.LUA_ERRERR=r.thread_status.LUA_ERRERR,e.exports.LUA_ERRGCMM=r.thread_status.LUA_ERRGCMM,e.exports.LUA_ERRMEM=r.thread_status.LUA_ERRMEM,e.exports.LUA_ERRRUN=r.thread_status.LUA_ERRRUN,e.exports.LUA_ERRSYNTAX=r.thread_status.LUA_ERRSYNTAX,e.exports.LUA_HOOKCALL=r.LUA_HOOKCALL,e.exports.LUA_HOOKCOUNT=r.LUA_HOOKCOUNT,e.exports.LUA_HOOKLINE=r.LUA_HOOKLINE,e.exports.LUA_HOOKRET=r.LUA_HOOKRET,e.exports.LUA_HOOKTAILCALL=r.LUA_HOOKTAILCALL,e.exports.LUA_MASKCALL=r.LUA_MASKCALL,e.exports.LUA_MASKCOUNT=r.LUA_MASKCOUNT,e.exports.LUA_MASKLINE=r.LUA_MASKLINE,e.exports.LUA_MASKRET=r.LUA_MASKRET,e.exports.LUA_MINSTACK=r.LUA_MINSTACK,e.exports.LUA_MULTRET=r.LUA_MULTRET,e.exports.LUA_NUMTAGS=r.constant_types.LUA_NUMTAGS,e.exports.LUA_OK=r.thread_status.LUA_OK,e.exports.LUA_OPADD=r.LUA_OPADD,e.exports.LUA_OPBAND=r.LUA_OPBAND,e.exports.LUA_OPBNOT=r.LUA_OPBNOT,e.exports.LUA_OPBOR=r.LUA_OPBOR,e.exports.LUA_OPBXOR=r.LUA_OPBXOR,e.exports.LUA_OPDIV=r.LUA_OPDIV,e.exports.LUA_OPEQ=r.LUA_OPEQ,e.exports.LUA_OPIDIV=r.LUA_OPIDIV,e.exports.LUA_OPLE=r.LUA_OPLE,e.exports.LUA_OPLT=r.LUA_OPLT,e.exports.LUA_OPMOD=r.LUA_OPMOD,e.exports.LUA_OPMUL=r.LUA_OPMUL,e.exports.LUA_OPPOW=r.LUA_OPPOW,e.exports.LUA_OPSHL=r.LUA_OPSHL,e.exports.LUA_OPSHR=r.LUA_OPSHR,e.exports.LUA_OPSUB=r.LUA_OPSUB,e.exports.LUA_OPUNM=r.LUA_OPUNM,e.exports.LUA_REGISTRYINDEX=r.LUA_REGISTRYINDEX,e.exports.LUA_RELEASE=r.LUA_RELEASE,e.exports.LUA_RIDX_GLOBALS=r.LUA_RIDX_GLOBALS,e.exports.LUA_RIDX_LAST=r.LUA_RIDX_LAST,e.exports.LUA_RIDX_MAINTHREAD=r.LUA_RIDX_MAINTHREAD,e.exports.LUA_SIGNATURE=r.LUA_SIGNATURE,e.exports.LUA_TNONE=r.constant_types.LUA_TNONE,e.exports.LUA_TNIL=r.constant_types.LUA_TNIL,e.exports.LUA_TBOOLEAN=r.constant_types.LUA_TBOOLEAN,e.exports.LUA_TLIGHTUSERDATA=r.constant_types.LUA_TLIGHTUSERDATA,e.exports.LUA_TNUMBER=r.constant_types.LUA_TNUMBER,e.exports.LUA_TSTRING=r.constant_types.LUA_TSTRING,e.exports.LUA_TTABLE=r.constant_types.LUA_TTABLE,e.exports.LUA_TFUNCTION=r.constant_types.LUA_TFUNCTION,e.exports.LUA_TUSERDATA=r.constant_types.LUA_TUSERDATA,e.exports.LUA_TTHREAD=r.constant_types.LUA_TTHREAD,e.exports.LUA_VERSION=r.LUA_VERSION,e.exports.LUA_VERSION_MAJOR=r.LUA_VERSION_MAJOR,e.exports.LUA_VERSION_MINOR=r.LUA_VERSION_MINOR,e.exports.LUA_VERSION_NUM=r.LUA_VERSION_NUM,e.exports.LUA_VERSION_RELEASE=r.LUA_VERSION_RELEASE,e.exports.LUA_YIELD=r.thread_status.LUA_YIELD,e.exports.lua_Debug=r.lua_Debug,e.exports.lua_upvalueindex=r.lua_upvalueindex,e.exports.lua_absindex=a.lua_absindex,e.exports.lua_arith=a.lua_arith,e.exports.lua_atpanic=a.lua_atpanic,e.exports.lua_atnativeerror=a.lua_atnativeerror,e.exports.lua_call=a.lua_call,e.exports.lua_callk=a.lua_callk,e.exports.lua_checkstack=a.lua_checkstack,e.exports.lua_close=s.lua_close,e.exports.lua_compare=a.lua_compare,e.exports.lua_concat=a.lua_concat,e.exports.lua_copy=a.lua_copy,e.exports.lua_createtable=a.lua_createtable,e.exports.lua_dump=a.lua_dump,e.exports.lua_error=a.lua_error,e.exports.lua_gc=a.lua_gc,e.exports.lua_getallocf=a.lua_getallocf,e.exports.lua_getextraspace=a.lua_getextraspace,e.exports.lua_getfield=a.lua_getfield,e.exports.lua_getglobal=a.lua_getglobal,e.exports.lua_gethook=u.lua_gethook,e.exports.lua_gethookcount=u.lua_gethookcount,e.exports.lua_gethookmask=u.lua_gethookmask,e.exports.lua_geti=a.lua_geti,e.exports.lua_getinfo=u.lua_getinfo,e.exports.lua_getlocal=u.lua_getlocal,e.exports.lua_getmetatable=a.lua_getmetatable,e.exports.lua_getstack=u.lua_getstack,e.exports.lua_gettable=a.lua_gettable,e.exports.lua_gettop=a.lua_gettop,e.exports.lua_getupvalue=a.lua_getupvalue,e.exports.lua_getuservalue=a.lua_getuservalue,e.exports.lua_insert=a.lua_insert,e.exports.lua_isboolean=a.lua_isboolean,e.exports.lua_iscfunction=a.lua_iscfunction,e.exports.lua_isfunction=a.lua_isfunction,e.exports.lua_isinteger=a.lua_isinteger,e.exports.lua_islightuserdata=a.lua_islightuserdata,e.exports.lua_isnil=a.lua_isnil,e.exports.lua_isnone=a.lua_isnone,e.exports.lua_isnoneornil=a.lua_isnoneornil,e.exports.lua_isnumber=a.lua_isnumber,e.exports.lua_isproxy=a.lua_isproxy,e.exports.lua_isstring=a.lua_isstring,e.exports.lua_istable=a.lua_istable,e.exports.lua_isthread=a.lua_isthread,e.exports.lua_isuserdata=a.lua_isuserdata,e.exports.lua_isyieldable=l.lua_isyieldable,e.exports.lua_len=a.lua_len,e.exports.lua_load=a.lua_load,e.exports.lua_newstate=s.lua_newstate,e.exports.lua_newtable=a.lua_newtable,e.exports.lua_newthread=s.lua_newthread,e.exports.lua_newuserdata=a.lua_newuserdata,e.exports.lua_next=a.lua_next,e.exports.lua_pcall=a.lua_pcall,e.exports.lua_pcallk=a.lua_pcallk,e.exports.lua_pop=a.lua_pop,e.exports.lua_pushboolean=a.lua_pushboolean,e.exports.lua_pushcclosure=a.lua_pushcclosure,e.exports.lua_pushcfunction=a.lua_pushcfunction,e.exports.lua_pushfstring=a.lua_pushfstring,e.exports.lua_pushglobaltable=a.lua_pushglobaltable,e.exports.lua_pushinteger=a.lua_pushinteger,e.exports.lua_pushjsclosure=a.lua_pushjsclosure,e.exports.lua_pushjsfunction=a.lua_pushjsfunction,e.exports.lua_pushlightuserdata=a.lua_pushlightuserdata,e.exports.lua_pushliteral=a.lua_pushliteral,e.exports.lua_pushlstring=a.lua_pushlstring,e.exports.lua_pushnil=a.lua_pushnil,e.exports.lua_pushnumber=a.lua_pushnumber,e.exports.lua_pushstring=a.lua_pushstring,e.exports.lua_pushthread=a.lua_pushthread,e.exports.lua_pushvalue=a.lua_pushvalue,e.exports.lua_pushvfstring=a.lua_pushvfstring,e.exports.lua_rawequal=a.lua_rawequal,e.exports.lua_rawget=a.lua_rawget,e.exports.lua_rawgeti=a.lua_rawgeti,e.exports.lua_rawgetp=a.lua_rawgetp,e.exports.lua_rawlen=a.lua_rawlen,e.exports.lua_rawset=a.lua_rawset,e.exports.lua_rawseti=a.lua_rawseti,e.exports.lua_rawsetp=a.lua_rawsetp,e.exports.lua_register=a.lua_register,e.exports.lua_remove=a.lua_remove,e.exports.lua_replace=a.lua_replace,e.exports.lua_resume=l.lua_resume,e.exports.lua_rotate=a.lua_rotate,e.exports.lua_setallof=l.lua_setallof,e.exports.lua_setfield=a.lua_setfield,e.exports.lua_setglobal=a.lua_setglobal,e.exports.lua_sethook=u.lua_sethook,e.exports.lua_seti=a.lua_seti,e.exports.lua_setlocal=u.lua_setlocal,e.exports.lua_setmetatable=a.lua_setmetatable,e.exports.lua_settable=a.lua_settable,e.exports.lua_settop=a.lua_settop,e.exports.lua_setupvalue=a.lua_setupvalue,e.exports.lua_setuservalue=a.lua_setuservalue,e.exports.lua_status=a.lua_status,e.exports.lua_stringtonumber=a.lua_stringtonumber,e.exports.lua_toboolean=a.lua_toboolean,e.exports.lua_todataview=a.lua_todataview,e.exports.lua_tointeger=a.lua_tointeger,e.exports.lua_tointegerx=a.lua_tointegerx,e.exports.lua_tojsstring=a.lua_tojsstring,e.exports.lua_tolstring=a.lua_tolstring,e.exports.lua_tonumber=a.lua_tonumber,e.exports.lua_tonumberx=a.lua_tonumberx,e.exports.lua_topointer=a.lua_topointer,e.exports.lua_toproxy=a.lua_toproxy,e.exports.lua_tostring=a.lua_tostring,e.exports.lua_tothread=a.lua_tothread,e.exports.lua_touserdata=a.lua_touserdata,e.exports.lua_type=a.lua_type,e.exports.lua_typename=a.lua_typename,e.exports.lua_upvalueid=a.lua_upvalueid,e.exports.lua_upvaluejoin=a.lua_upvaluejoin,e.exports.lua_version=a.lua_version,e.exports.lua_xmove=a.lua_xmove,e.exports.lua_yield=l.lua_yield,e.exports.lua_yieldk=l.lua_yieldk,e.exports.lua_tocfunction=a.lua_tocfunction},function(e,t,n){"use strict";const r={},{LUA_VERSION_MAJOR:a,LUA_VERSION_MINOR:u,to_luastring:l}=n(1);e.exports.LUA_PATH_SEP=";",e.exports.LUA_PATH_MARK="?",e.exports.LUA_EXEC_DIR="!";const s=a+"."+u;e.exports.LUA_VDIR=s;{const t="/";e.exports.LUA_DIRSEP=t;const n="./lua/"+s+"/";e.exports.LUA_LDIR=n;const r=n;e.exports.LUA_JSDIR=r;const a=l(n+"?.lua;"+n+"?/init.lua;./?.lua;./?/init.lua");e.exports.LUA_PATH_DEFAULT=a;const u=l(r+"?.js;"+r+"loadall.js;./?.js");e.exports.LUA_JSPATH_DEFAULT=u}const o=r.LUA_COMPAT_FLOATSTRING||!1,i=r.LUAI_MAXSTACK||1e6,c=r.LUA_IDSIZE||59,_=r.LUAL_BUFFERSIZE||8192,f=function(e,t){for(var n=Math.min(3,Math.ceil(Math.abs(t)/1023)),r=e,a=0;a<n;a++)r*=Math.pow(2,Math.floor((t+a)/n));return r};e.exports.LUAI_MAXSTACK=i,e.exports.LUA_COMPAT_FLOATSTRING=o,e.exports.LUA_IDSIZE=c,e.exports.LUA_INTEGER_FMT="%d",e.exports.LUA_INTEGER_FRMLEN="",e.exports.LUA_MAXINTEGER=2147483647,e.exports.LUA_MININTEGER=-2147483648,e.exports.LUA_NUMBER_FMT="%.14g",e.exports.LUA_NUMBER_FRMLEN="",e.exports.LUAL_BUFFERSIZE=_,e.exports.frexp=function(e){if(0===e)return[e,0];var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e);var n=t.getUint32(0)>>>20&2047;0===n&&(t.setFloat64(0,e*Math.pow(2,64)),n=(t.getUint32(0)>>>20&2047)-64);var r=n-1022;return[f(e,-r),r]},e.exports.ldexp=f,e.exports.lua_getlocaledecpoint=function(){return 46},e.exports.lua_integer2str=function(e){return String(e)},e.exports.lua_number2str=function(e){return String(Number(e.toPrecision(14)))},e.exports.lua_numbertointeger=function(e){return e>=-2147483648&&e<2147483648&&e},e.exports.luai_apicheck=function(e,t){if(!t)throw Error(t)}},function(e,t,n){"use strict";const{luai_apicheck:r}=n(3),a=function(e){if(!e)throw Error("assertion failed")};e.exports.lua_assert=a,e.exports.luai_apicheck=r||function(e,t){return a(t)},e.exports.api_check=function(e,t,n){return r(e,t&&n)},e.exports.LUAI_MAXCCALLS=200,e.exports.LUA_MINBUFFER=32,e.exports.luai_nummod=function(e,t,n){let r=t%n;return r*n<0&&(r+=n),r},e.exports.MAX_INT=2147483647,e.exports.MIN_INT=-2147483648},function(e,t,n){const r=n(1),a="Fengari 0.1.4  Copyright (C) 2017-2018 B. Giannangeli, Daurnimator\nBased on: "+r.LUA_COPYRIGHT;e.exports.FENGARI_AUTHORS="B. Giannangeli, Daurnimator",e.exports.FENGARI_COPYRIGHT=a,e.exports.FENGARI_RELEASE="Fengari 0.1.4",e.exports.FENGARI_VERSION="Fengari 0.1",e.exports.FENGARI_VERSION_MAJOR="0",e.exports.FENGARI_VERSION_MINOR="1",e.exports.FENGARI_VERSION_NUM=1,e.exports.FENGARI_VERSION_RELEASE="4",e.exports.is_luastring=r.is_luastring,e.exports.luastring_eq=r.luastring_eq,e.exports.luastring_from=r.luastring_from,e.exports.luastring_indexOf=r.luastring_indexOf,e.exports.luastring_of=r.luastring_of,e.exports.to_jsstring=r.to_jsstring,e.exports.to_luastring=r.to_luastring,e.exports.to_uristring=r.to_uristring,e.exports.from_userstring=r.from_userstring},function(e,t,n){"use strict";const{LUA_OPADD:r,LUA_OPBAND:a,LUA_OPBNOT:u,LUA_OPBOR:l,LUA_OPBXOR:s,LUA_OPDIV:o,LUA_OPIDIV:i,LUA_OPMOD:c,LUA_OPMUL:_,LUA_OPPOW:f,LUA_OPSHL:p,LUA_OPSHR:L,LUA_OPSUB:h,LUA_OPUNM:d,constant_types:{LUA_NUMTAGS:A,LUA_TBOOLEAN:g,LUA_TCCL:x,LUA_TFUNCTION:T,LUA_TLCF:b,LUA_TLCL:O,LUA_TLIGHTUSERDATA:k,LUA_TLNGSTR:v,LUA_TNIL:E,LUA_TNUMBER:m,LUA_TNUMFLT:U,LUA_TNUMINT:N,LUA_TSHRSTR:R,LUA_TSTRING:S,LUA_TTABLE:w,LUA_TTHREAD:I,LUA_TUSERDATA:y},from_userstring:M,luastring_indexOf:P,luastring_of:C,to_jsstring:D,to_luastring:V}=n(1),{lisdigit:B,lisprint:G,lisspace:K,lisxdigit:F}=n(22),j=n(11),H=n(8),X=n(12),{luaS_bless:z,luaS_new:Y}=n(10),q=n(9),{LUA_COMPAT_FLOATSTRING:Z,ldexp:J,lua_integer2str:W,lua_number2str:Q}=n(3),$=n(15),{MAX_INT:ee,luai_nummod:te,lua_assert:ne}=n(4),re=n(14),ae=A,ue=A+1;class le{constructor(e,t){this.type=e,this.value=t}ttype(){return 63&this.type}ttnov(){return 15&this.type}checktag(e){return this.type===e}checktype(e){return this.ttnov()===e}ttisnumber(){return this.checktype(m)}ttisfloat(){return this.checktag(U)}ttisinteger(){return this.checktag(N)}ttisnil(){return this.checktag(E)}ttisboolean(){return this.checktag(g)}ttislightuserdata(){return this.checktag(k)}ttisstring(){return this.checktype(S)}ttisshrstring(){return this.checktag(R)}ttislngstring(){return this.checktag(v)}ttistable(){return this.checktag(w)}ttisfunction(){return this.checktype(T)}ttisclosure(){return(31&this.type)===T}ttisCclosure(){return this.checktag(x)}ttisLclosure(){return this.checktag(O)}ttislcf(){return this.checktag(b)}ttisfulluserdata(){return this.checktag(y)}ttisthread(){return this.checktag(I)}ttisdeadkey(){return this.checktag(ue)}l_isfalse(){return this.ttisnil()||this.ttisboolean()&&!1===this.value}setfltvalue(e){this.type=U,this.value=e}chgfltvalue(e){ne(this.type==U),this.value=e}setivalue(e){this.type=N,this.value=e}chgivalue(e){ne(this.type==N),this.value=e}setnilvalue(){this.type=E,this.value=null}setfvalue(e){this.type=b,this.value=e}setpvalue(e){this.type=k,this.value=e}setbvalue(e){this.type=g,this.value=e}setsvalue(e){this.type=v,this.value=e}setuvalue(e){this.type=y,this.value=e}setthvalue(e){this.type=I,this.value=e}setclLvalue(e){this.type=O,this.value=e}setclCvalue(e){this.type=x,this.value=e}sethvalue(e){this.type=w,this.value=e}setdeadvalue(){this.type=ue,this.value=null}setfrom(e){this.type=e.type,this.value=e.value}tsvalue(){return ne(this.ttisstring()),this.value}svalue(){return this.tsvalue().getstr()}vslen(){return this.tsvalue().tsslen()}jsstring(e,t){return D(this.svalue(),e,t,!0)}}const se=function(e,t,n){e.stack[t].setsvalue(n)},oe=new le(E,null);Object.freeze(oe),e.exports.luaO_nilobject=oe;class ie{constructor(e,t){this.id=e.l_G.id_counter++,this.p=null,this.nupvalues=t,this.upvals=new Array(t)}}class ce{constructor(e,t,n){for(this.id=e.l_G.id_counter++,this.f=t,this.nupvalues=n,this.upvalue=new Array(n);n--;)this.upvalue[n]=new le(E,null)}}class _e{constructor(e,t){this.id=e.l_G.id_counter++,this.metatable=null,this.uservalue=new le(E,null),this.len=t,this.data=Object.create(null)}}const fe=V("..."),pe=V('[string "'),Le=V('"]'),he=function(e){return B(e)?e-48:(223&e)-55},de=function(e,t){let n=1;if(ne(t<=1114111),t<128)e[7]=t;else{let r=63;do{e[8-n++]=128|63&t,t>>=6,r>>=1}while(t>r);e[8-n]=~r<<1|t}return n},Ae=[46,120,88,110,78],ge={46:".",120:"x",88:"x",110:"n",78:"n"},xe=Math.floor(ee/10),Te=ee%10,be=function(e,t){let n;if(t.ttisinteger())n=V(W(t.value));else{let e=Q(t.value);!Z&&/^[-0123456789]+$/.test(e)&&(e+=".0"),n=V(e)}t.setsvalue(z(e,n))},Oe=function(e,t){H.luaD_inctop(e),se(e,e.top-1,Y(e,t))},ke=function(e,t,n){let r,a=0,u=0,l=0;for(;-1!=(r=P(t,37,u));){switch(Oe(e,t.subarray(u,r)),t[r+1]){case 115:{let t=n[l++];if(null===t)t=V("(null)",!0);else{t=M(t);let e=P(t,0);-1!==e&&(t=t.subarray(0,e))}Oe(e,t);break}case 99:{let t=n[l++];G(t)?Oe(e,C(t)):ve(e,V("<\\%d>",!0),t);break}case 100:case 73:H.luaD_inctop(e),e.stack[e.top-1].setivalue(n[l++]),be(e,e.stack[e.top-1]);break;case 102:H.luaD_inctop(e),e.stack[e.top-1].setfltvalue(n[l++]),be(e,e.stack[e.top-1]);break;case 112:{let t=n[l++];if(t instanceof X.lua_State||t instanceof q.Table||t instanceof _e||t instanceof ie||t instanceof ce)Oe(e,V("0x"+t.id.toString(16)));else switch(typeof t){case"undefined":Oe(e,V("undefined"));break;case"number":Oe(e,V("Number("+t+")"));break;case"string":Oe(e,V("String("+JSON.stringify(t)+")"));break;case"boolean":Oe(e,V(t?"Boolean(true)":"Boolean(false)"));break;case"object":if(null===t){Oe(e,V("null"));break}case"function":{let n=e.l_G.ids.get(t);n||(n=e.l_G.id_counter++,e.l_G.ids.set(t,n)),Oe(e,V("0x"+n.toString(16)));break}default:Oe(e,V("<id NYI>"))}break}case 85:{let t=new Uint8Array(8),r=de(t,n[l++]);Oe(e,t.subarray(8-r));break}case 37:Oe(e,V("%",!0));break;default:j.luaG_runerror(e,V("invalid option '%%%c' to 'lua_pushfstring'"),t[r+1])}a+=2,u=r+2}return H.luaD_checkstack(e,1),Oe(e,t.subarray(u)),a>0&&$.luaV_concat(e,a+1),e.stack[e.top-1].svalue()},ve=function(e,t,...n){return ke(e,t,n)},Ee=function(e,t,n,o){switch(t){case r:return n+o|0;case h:return n-o|0;case _:return $.luaV_imul(n,o);case c:return $.luaV_mod(e,n,o);case i:return $.luaV_div(e,n,o);case a:return n&o;case l:return n|o;case s:return n^o;case p:return $.luaV_shiftl(n,o);case L:return $.luaV_shiftl(n,-o);case d:return 0-n|0;case u:return-1^n;default:ne(0)}},me=function(e,t,n,a){switch(t){case r:return n+a;case h:return n-a;case _:return n*a;case o:return n/a;case f:return Math.pow(n,a);case i:return Math.floor(n/a);case d:return-n;case c:return te(e,n,a);default:ne(0)}};e.exports.CClosure=ce,e.exports.LClosure=ie,e.exports.LUA_TDEADKEY=ue,e.exports.LUA_TPROTO=ae,e.exports.LocVar=class{constructor(){this.varname=null,this.startpc=NaN,this.endpc=NaN}},e.exports.TValue=le,e.exports.Udata=_e,e.exports.UTF8BUFFSZ=8,e.exports.luaO_arith=function(e,t,n,i,c){let _="number"==typeof c?e.stack[c]:c;switch(t){case a:case l:case s:case p:case L:case u:{let r,a;if(!1!==(r=$.tointeger(n))&&!1!==(a=$.tointeger(i)))return void _.setivalue(Ee(e,t,r,a));break}case o:case f:{let r,a;if(!1!==(r=$.tonumber(n))&&!1!==(a=$.tonumber(i)))return void _.setfltvalue(me(e,t,r,a));break}default:{let r,a;if(n.ttisinteger()&&i.ttisinteger())return void _.setivalue(Ee(e,t,n.value,i.value));if(!1!==(r=$.tonumber(n))&&!1!==(a=$.tonumber(i)))return void _.setfltvalue(me(e,t,r,a));break}}ne(null!==e),re.luaT_trybinTM(e,n,i,c,t-r+re.TMS.TM_ADD)},e.exports.luaO_chunkid=function(e,t){let n,r=e.length;if(61===e[0])r<t?(n=new Uint8Array(r-1)).set(e.subarray(1)):(n=new Uint8Array(t)).set(e.subarray(1,t+1));else if(64===e[0])r<=t?(n=new Uint8Array(r-1)).set(e.subarray(1)):((n=new Uint8Array(t)).set(fe),t-=fe.length,n.set(e.subarray(r-t),fe.length));else{n=new Uint8Array(t);let a=P(e,10);n.set(pe);let u=pe.length;r<(t-=pe.length+fe.length+Le.length)&&-1===a?(n.set(e,u),u+=e.length):(-1!==a&&(r=a),r>t&&(r=t),n.set(e.subarray(0,r),u),u+=r,n.set(fe,u),u+=fe.length),n.set(Le,u),u+=Le.length,n=n.subarray(0,u)}return n},e.exports.luaO_hexavalue=he,e.exports.luaO_int2fb=function(e){let t=0;if(e<8)return e;for(;e>=128;)e=e+15>>4,t+=4;for(;e>=16;)e=e+1>>1,t++;return t+1<<3|e-8},e.exports.luaO_pushfstring=ve,e.exports.luaO_pushvfstring=ke,e.exports.luaO_str2num=function(e,t){let n=function(e){let t,n=0,r=0,a=!0;for(;K(e[n]);)n++;if((t=45===e[n])?n++:43===e[n]&&n++,48!==e[n]||120!==e[n+1]&&88!==e[n+1])for(;n<e.length&&B(e[n]);n++){let u=e[n]-48;if(r>=xe&&(r>xe||u>Te+t))return null;r=10*r+u|0,a=!1}else for(n+=2;n<e.length&&F(e[n]);n++)r=16*r+he(e[n])|0,a=!1;for(;n<e.length&&K(e[n]);)n++;return a||n!==e.length&&0!==e[n]?null:{n:0|(t?-r:r),i:n}}(e);return null!==n?(t.setivalue(n.n),n.i+1):null!==(n=function(e){let t=e.length,n=0;for(let r=0;r<t;r++){let t=e[r];if(-1!==Ae.indexOf(t)){n=t;break}}let r=ge[n];return"n"===r?null:function(e,t){let n="x"===t?function(e){let t,n=0,r=0,a=0,u=0,l=0,s=!1;for(;K(e[n]);)n++;if((t=45===e[n])?n++:43===e[n]&&n++,48!==e[n]||120!==e[n+1]&&88!==e[n+1])return null;for(n+=2;;n++)if(46===e[n]){if(s)break;s=!0}else{if(!F(e[n]))break;0===a&&48===e[n]?u++:++a<=30?r=16*r+he(e[n]):l++,s&&l--}if(u+a===0)return null;if(l*=4,112===e[n]||80===e[n]){let t,r=0;if((t=45===e[++n])?n++:43===e[n]&&n++,!B(e[n]))return null;for(;B(e[n]);)r=10*r+e[n++]-48;t&&(r=-r),l+=r}return t&&(r=-r),{n:J(r,l),i:n}}(e):function(e){try{e=D(e)}catch(e){return null}let t=/^[\t\v\f \n\r]*[+-]?(?:[0-9]+\.?[0-9]*|\.[0-9]*)(?:[eE][+-]?[0-9]+)?/.exec(e);if(!t)return null;let n=parseFloat(t[0]);return isNaN(n)?null:{n:n,i:t[0].length}}(e);if(null===n)return null;for(;K(e[n.i]);)n.i++;return n.i===e.length||0===e[n.i]?n:null}(e,r)}(e))?(t.setfltvalue(n.n),n.i+1):0},e.exports.luaO_tostring=be,e.exports.luaO_utf8esc=de,e.exports.numarith=me,e.exports.pushobj2s=function(e,t){e.stack[e.top++]=new le(t.type,t.value)},e.exports.pushsvalue2s=function(e,t){e.stack[e.top++]=new le(v,t)},e.exports.setobjs2s=function(e,t,n){e.stack[t].setfrom(e.stack[n])},e.exports.setobj2s=function(e,t,n){e.stack[t].setfrom(n)},e.exports.setsvalue2s=se},function(e,t,n){"use strict";const{LUAL_BUFFERSIZE:r}=n(3),{LUA_ERRERR:a,LUA_MULTRET:u,LUA_REGISTRYINDEX:l,LUA_SIGNATURE:s,LUA_TBOOLEAN:o,LUA_TLIGHTUSERDATA:i,LUA_TNIL:c,LUA_TNONE:_,LUA_TNUMBER:f,LUA_TSTRING:p,LUA_TTABLE:L,LUA_VERSION_NUM:h,lua_Debug:d,lua_absindex:A,lua_atpanic:g,lua_call:x,lua_checkstack:T,lua_concat:b,lua_copy:O,lua_createtable:k,lua_error:v,lua_getfield:E,lua_getinfo:m,lua_getmetatable:U,lua_getstack:N,lua_gettop:R,lua_insert:S,lua_isinteger:w,lua_isnil:I,lua_isnumber:y,lua_isstring:M,lua_istable:P,lua_len:C,lua_load:D,lua_newstate:V,lua_newtable:B,lua_next:G,lua_pcall:K,lua_pop:F,lua_pushboolean:j,lua_pushcclosure:H,lua_pushcfunction:X,lua_pushfstring:z,lua_pushinteger:Y,lua_pushliteral:q,lua_pushlstring:Z,lua_pushnil:J,lua_pushstring:W,lua_pushvalue:Q,lua_pushvfstring:$,lua_rawequal:ee,lua_rawget:te,lua_rawgeti:ne,lua_rawlen:re,lua_rawseti:ae,lua_remove:ue,lua_setfield:le,lua_setglobal:se,lua_setmetatable:oe,lua_settop:ie,lua_toboolean:ce,lua_tointeger:_e,lua_tointegerx:fe,lua_tojsstring:pe,lua_tolstring:Le,lua_tonumber:he,lua_tonumberx:de,lua_topointer:Ae,lua_tostring:ge,lua_touserdata:xe,lua_type:Te,lua_typename:be,lua_version:Oe}=n(2),{from_userstring:ke,luastring_eq:ve,to_luastring:Ee,to_uristring:me}=n(5),Ue=a+1,Ne=Ee("_LOADED"),Re=Ee("_PRELOAD"),Se=Ee("FILE*"),we=Ee("__name"),Ie=Ee("__tostring"),ye=new Uint8Array(0);class Me{constructor(){this.L=null,this.b=ye,this.n=0}}const Pe=function(e,t,n){if(0===n||!P(e,-1))return 0;for(J(e);G(e,-2);){if(Te(e,-2)===p){if(ee(e,t,-1))return F(e,1),1;if(Pe(e,t,n-1))return ue(e,-2),q(e,"."),S(e,-2),b(e,3),1}F(e,1)}return 0},Ce=function(e,t){let n=R(e);if(m(e,Ee("f"),t),E(e,l,Ne),Pe(e,n+1,2)){let t=ge(e,-1);return 95===t[0]&&71===t[1]&&46===t[2]&&(W(e,t.subarray(3)),ue(e,-2)),O(e,-1,n+1),F(e,2),1}return ie(e,n),0},De=function(e,t){Ce(e,t)?(z(e,Ee("function '%s'"),ge(e,-1)),ue(e,-2)):0!==t.namewhat.length?z(e,Ee("%s '%s'"),t.namewhat,t.name):t.what&&109===t.what[0]?q(e,"main chunk"):t.what&&76===t.what[0]?z(e,Ee("function <%s:%d>"),t.short_src,t.linedefined):q(e,"?")},Ve=function(e){let t="PANIC: unprotected error in call to Lua API ("+pe(e,-1)+")";throw new Error(t)},Be=function(e,t,n){let r=new d;return N(e,0,r)?(m(e,Ee("n"),r),ve(r.namewhat,Ee("method"))&&0==--t?Fe(e,Ee("calling '%s' on bad self (%s)"),r.name,n):(null===r.name&&(r.name=Ce(e,r)?ge(e,-1):Ee("?")),Fe(e,Ee("bad argument #%d to '%s' (%s)"),t,r.name,n))):Fe(e,Ee("bad argument #%d (%s)"),t,n)},Ge=function(e,t,n){let r;r=_t(e,t,we)===p?ge(e,-1):Te(e,t)===i?Ee("light userdata",!0):Ye(e,t);let a=z(e,Ee("%s expected, got %s"),n,r);return Be(e,t,a)},Ke=function(e,t){let n=new d;N(e,t,n)&&(m(e,Ee("Sl",!0),n),n.currentline>0)?z(e,Ee("%s:%d: "),n.short_src,n.currentline):W(e,Ee(""))},Fe=function(e,t,...n){return Ke(e,1),$(e,t,n),b(e,2),v(e)},je=function(e,t,n,r){if(t)return j(e,1),1;{let t,a;return J(e),r?(t=r.message,a=-r.errno):(t="Success",a=0),n?z(e,Ee("%s: %s"),n,Ee(t)):W(e,Ee(t)),Y(e,a),3}},He=function(e,t){return E(e,l,t)},Xe=function(e,t,n){let r=xe(e,t);return null!==r&&U(e,t)?(He(e,n),ee(e,-1,-2)||(r=null),F(e,2),r):null},ze=function(e,t,n){Ge(e,t,be(e,n))},Ye=function(e,t){return be(e,Te(e,t))},qe=function(e,t){let n=Le(e,t);return null!=n||ze(e,t,p),n},Ze=qe,Je=function(e,t,n){return Te(e,t)<=0?null===n?null:ke(n):qe(e,t)},We=Je,Qe=function(e,t){let n=de(e,t);return!1===n&&ze(e,t,f),n},$e=function(e,t){let n=fe(e,t);return!1===n&&function(e,t){y(e,t)?Be(e,t,Ee("number has no integer representation",!0)):ze(e,t,f)}(e,t),n},et=function(e,t){let n=e.n+t;if(e.b.length<n){let t=Math.max(2*e.b.length,n),r=new Uint8Array(t);r.set(e.b),e.b=r}return e.b.subarray(e.n,n)},tt=function(e,t){t.L=e,t.b=ye},nt=function(e,t,n){n>0&&(t=ke(t),et(e,n).set(t.subarray(0,n)),ut(e,n))},rt=function(e,t){t=ke(t),nt(e,t,t.length)},at=function(e){Z(e.L,e.b,e.n),e.n=0,e.b=ye},ut=function(e,t){e.n+=t},lt=function(e,t,n,r){return Te(e,n)<=0?r:t(e,n)},st=function(e,t){let n=t.string;return t.string=null,n},ot=function(e,t,n,r,a){return D(e,st,{string:t},r,a)},it=function(e,t,n,r){return ot(e,t,0,r,null)},ct=function(e,t){return it(e,t,t.length,t)},_t=function(e,t,n){if(U(e,t)){W(e,n);let t=te(e,-2);return t===c?F(e,2):ue(e,-2),t}return c},ft=function(e,t,n){return t=A(e,t),_t(e,t,n)!==c&&(Q(e,t),x(e,1,1),!0)},pt=Ee("%I"),Lt=Ee("%f"),ht=function(e,t,n){var r=n>>>0,a=t.length,u=e.length+1-a;e:for(;r<u;r++){for(let n=0;n<a;n++)if(e[r+n]!==t[n])continue e;return r}return-1},dt=function(e,t,n){return E(e,t,n)===L||(F(e,1),t=A(e,t),B(e),Q(e,-1),le(e,t,n),!1)},At=function(e,t,n){gt(e,n,Ee("too many upvalues",!0));for(let r in t){for(let t=0;t<n;t++)Q(e,-n);H(e,t[r],n),le(e,-(n+2),Ee(r))}F(e,n)},gt=function(e,t,n){T(e,t)||(n?Fe(e,Ee("stack overflow (%s)"),n):Fe(e,Ee("stack overflow",!0)))},xt=function(e,t,n,r){let a=r.message,u=ge(e,n).subarray(1);return z(e,Ee("cannot %s %s: %s"),Ee(t),u,Ee(a)),ue(e,n),Ue};let Tt;const bt=[239,187,191];let Ot;{class e{constructor(){this.n=NaN,this.f=null,this.buff=new Uint8Array(1024),this.pos=0,this.err=void 0}}const t=function(e,t){let n=t;if(null!==n.f&&n.n>0){let e=n.n;return n.n=0,n.f=n.f.subarray(n.pos),n.buff.subarray(0,e)}let r=n.f;return n.f=null,r};Tt=function(e){return e.pos<e.f.length?e.f[e.pos++]:null},Ot=function(n,r,a){let u=new e,l=R(n)+1;if(null===r)throw new Error("Can't read stdin in the browser");{z(n,Ee("@%s"),r);let e=me(r),t=new XMLHttpRequest;if(t.open("GET",e,!1),"undefined"==typeof window&&(t.responseType="arraybuffer"),t.send(),!(t.status>=200&&t.status<=299))return u.err=t.status,xt(n,"open",l,{message:`${t.status}: ${t.statusText}`});"string"==typeof t.response?u.f=Ee(t.response):u.f=new Uint8Array(t.response)}let o=function(e){let t=function(e){let t;e.n=0;let n=0;do{if(null===(t=Tt(e))||t!==bt[n])return t;n++,e.buff[e.n++]=t}while(n<bt.length);return e.n=0,Tt(e)}(e);if(35===t){do{t=Tt(e)}while(t&&10!==t);return{skipped:!0,c:Tt(e)}}return{skipped:!1,c:t}}(u);o.c===s[0]&&r||o.skipped&&(u.buff[u.n++]=10),null!==o.c&&(u.buff[u.n++]=o.c);let i=D(n,t,u,ge(n,-1),a),c=u.err;return c?(ie(n,l),xt(n,"read",l,c)):(ue(n,l),i)}}const kt=function(e,t){return Ot(e,t,null)},vt=function(e,t,n){let r=Oe(e);72!=n&&Fe(e,Ee("core and library have incompatible numeric types")),r!=Oe(null)?Fe(e,Ee("multiple Lua VMs detected")):r!==t&&Fe(e,Ee("version mismatch: app. needs %f, Lua core provides %f"),t,r)};e.exports.LUA_ERRFILE=Ue,e.exports.LUA_FILEHANDLE=Se,e.exports.LUA_LOADED_TABLE=Ne,e.exports.LUA_NOREF=-2,e.exports.LUA_PRELOAD_TABLE=Re,e.exports.LUA_REFNIL=-1,e.exports.luaL_Buffer=Me,e.exports.luaL_addchar=function(e,t){et(e,1),e.b[e.n++]=t},e.exports.luaL_addlstring=nt,e.exports.luaL_addsize=ut,e.exports.luaL_addstring=rt,e.exports.luaL_addvalue=function(e){let t=e.L,n=ge(t,-1);nt(e,n,n.length),F(t,1)},e.exports.luaL_argcheck=function(e,t,n,r){t||Be(e,n,r)},e.exports.luaL_argerror=Be,e.exports.luaL_buffinit=tt,e.exports.luaL_buffinitsize=function(e,t,n){return tt(e,t),et(t,n)},e.exports.luaL_callmeta=ft,e.exports.luaL_checkany=function(e,t){Te(e,t)===_&&Be(e,t,Ee("value expected",!0))},e.exports.luaL_checkinteger=$e,e.exports.luaL_checklstring=qe,e.exports.luaL_checknumber=Qe,e.exports.luaL_checkoption=function(e,t,n,r){let a=null!==n?We(e,t,n):Ze(e,t);for(let e=0;r[e];e++)if(ve(r[e],a))return e;return Be(e,t,z(e,Ee("invalid option '%s'"),a))},e.exports.luaL_checkstack=gt,e.exports.luaL_checkstring=Ze,e.exports.luaL_checktype=function(e,t,n){Te(e,t)!==n&&ze(e,t,n)},e.exports.luaL_checkudata=function(e,t,n){let r=Xe(e,t,n);return null===r&&Ge(e,t,n),r},e.exports.luaL_checkversion=function(e){vt(e,h,72)},e.exports.luaL_checkversion_=vt,e.exports.luaL_dofile=function(e,t){return kt(e,t)||K(e,0,u,0)},e.exports.luaL_dostring=function(e,t){return ct(e,t)||K(e,0,u,0)},e.exports.luaL_error=Fe,e.exports.luaL_execresult=function(e,t){let n,r;if(null===t)return j(e,1),q(e,"exit"),Y(e,0),3;if(t.status)n="exit",r=t.status;else{if(!t.signal)return je(e,0,null,t);n="signal",r=t.signal}return J(e),q(e,n),Y(e,r),3},e.exports.luaL_fileresult=je,e.exports.luaL_getmetafield=_t,e.exports.luaL_getmetatable=He,e.exports.luaL_getsubtable=dt,e.exports.luaL_gsub=function(e,t,n,r){let a,u=new Me;for(tt(e,u);(a=ht(t,n))>=0;)nt(u,t,a),rt(u,r),t=t.subarray(a+n.length);return rt(u,t),at(u),ge(e,-1)},e.exports.luaL_len=function(e,t){C(e,t);let n=fe(e,-1);return!1===n&&Fe(e,Ee("object length is not an integer",!0)),F(e,1),n},e.exports.luaL_loadbuffer=it,e.exports.luaL_loadbufferx=ot,e.exports.luaL_loadfile=kt,e.exports.luaL_loadfilex=Ot,e.exports.luaL_loadstring=ct,e.exports.luaL_newlib=function(e,t){k(e),At(e,t,0)},e.exports.luaL_newlibtable=function(e){k(e)},e.exports.luaL_newmetatable=function(e,t){return He(e,t)!==c?0:(F(e,1),k(e,0,2),W(e,t),le(e,-2,we),Q(e,-1),le(e,l,t),1)},e.exports.luaL_newstate=function(){let e=V();return e&&g(e,Ve),e},e.exports.luaL_opt=lt,e.exports.luaL_optinteger=function(e,t,n){return lt(e,$e,t,n)},e.exports.luaL_optlstring=Je,e.exports.luaL_optnumber=function(e,t,n){return lt(e,Qe,t,n)},e.exports.luaL_optstring=We,e.exports.luaL_prepbuffer=function(e){return et(e,r)},e.exports.luaL_prepbuffsize=et,e.exports.luaL_pushresult=at,e.exports.luaL_pushresultsize=function(e,t){ut(e,t),at(e)},e.exports.luaL_ref=function(e,t){let n;return I(e,-1)?(F(e,1),-1):(t=A(e,t),ne(e,t,0),n=_e(e,-1),F(e,1),0!==n?(ne(e,t,n),ae(e,t,0)):n=re(e,t)+1,ae(e,t,n),n)},e.exports.luaL_requiref=function(e,t,n,r){dt(e,l,Ne),E(e,-1,t),ce(e,-1)||(F(e,1),X(e,n),W(e,t),x(e,1,1),Q(e,-1),le(e,-3,t)),ue(e,-2),r&&(Q(e,-1),se(e,t))},e.exports.luaL_setfuncs=At,e.exports.luaL_setmetatable=function(e,t){He(e,t),oe(e,-2)},e.exports.luaL_testudata=Xe,e.exports.luaL_tolstring=function(e,t){if(ft(e,t,Ie))M(e,-1)||Fe(e,Ee("'__tostring' must return a string"));else switch(Te(e,t)){case f:w(e,t)?z(e,pt,_e(e,t)):z(e,Lt,he(e,t));break;case p:Q(e,t);break;case o:q(e,ce(e,t)?"true":"false");break;case c:q(e,"nil");break;default:{let n=_t(e,t,we),r=n===p?ge(e,-1):Ye(e,t);z(e,Ee("%s: %p"),r,Ae(e,t)),n!==c&&ue(e,-2);break}}return Le(e,-1)},e.exports.luaL_traceback=function(e,t,n,r){let a=new d,u=R(e),l=function(e){let t=new d,n=1,r=1;for(;N(e,r,t);)n=r,r*=2;for(;n<r;){let a=Math.floor((n+r)/2);N(e,a,t)?n=a+1:r=a}return r-1}(t),s=l-r>21?10:-1;for(n&&z(e,Ee("%s\n"),n),gt(e,10,null),q(e,"stack traceback:");N(t,r++,a);)0==s--?(q(e,"\n\t..."),r=l-11+1):(m(t,Ee("Slnt",!0),a),z(e,Ee("\n\t%s:"),a.short_src),a.currentline>0&&q(e,`${a.currentline}:`),q(e," in "),De(e,a),a.istailcall&&q(e,"\n\t(...tail calls..)"),b(e,R(e)-u));b(e,R(e)-u)},e.exports.luaL_typename=Ye,e.exports.luaL_unref=function(e,t,n){n>=0&&(t=A(e,t),ne(e,t,0),ae(e,t,n),Y(e,n),ae(e,t,0))},e.exports.luaL_where=Ke,e.exports.lua_writestringerror=function(){for(let e=0;e<arguments.length;e++){let t=arguments[e];do{let e=/([^\n]*)\n?([\d\D]*)/.exec(t);console.error(e[1]),t=e[2]}while(""!==t)}}},function(e,t,n){"use strict";const{LUA_HOOKCALL:r,LUA_HOOKRET:a,LUA_HOOKTAILCALL:u,LUA_MASKCALL:l,LUA_MASKLINE:s,LUA_MASKRET:o,LUA_MINSTACK:i,LUA_MULTRET:c,LUA_SIGNATURE:_,constant_types:{LUA_TCCL:f,LUA_TLCF:p,LUA_TLCL:L,LUA_TNIL:h},thread_status:{LUA_ERRMEM:d,LUA_ERRERR:A,LUA_ERRRUN:g,LUA_ERRSYNTAX:x,LUA_OK:T,LUA_YIELD:b},lua_Debug:O,luastring_indexOf:k,to_luastring:v}=n(1),E=n(18),m=n(11),U=n(13),{api_check:N,lua_assert:R,LUAI_MAXCCALLS:S}=n(4),w=n(6),I=n(16),y=n(23),M=n(12),{luaS_newliteral:P}=n(10),C=n(14),{LUAI_MAXSTACK:D}=n(3),V=n(36),B=n(15),{MBuffer:G}=n(19),K=function(e,t){if(e.top<t)for(;e.top<t;)e.stack[e.top++]=new w.TValue(h,null);else for(;e.top>t;)delete e.stack[--e.top]},F=function(e,t,n){let r=e.top;for(;e.top<n+1;)e.stack[e.top++]=new w.TValue(h,null);switch(t){case d:w.setsvalue2s(e,n,P(e,"not enough memory"));break;case A:w.setsvalue2s(e,n,P(e,"error in error handling"));break;default:w.setobjs2s(e,n,r-1)}for(;e.top>n+1;)delete e.stack[--e.top]},j=D+200,H=function(e,t){R(t<=D||t==j),R(e.stack_last==e.stack.length-M.EXTRA_STACK),e.stack.length=t,e.stack_last=t-M.EXTRA_STACK},X=function(e,t){let n=e.stack.length;if(n>D)ne(e,A);else{let r=e.top+t+M.EXTRA_STACK,a=2*n;a>D&&(a=D),a<r&&(a=r),a>D?(H(e,j),m.luaG_runerror(e,v("stack overflow",!0))):H(e,a)}},z=function(e,t){e.stack_last-e.top<=t&&X(e,t)},Y=function(e){let t=function(e){let t=e.top;for(let n=e.ci;null!==n;n=n.previous)t<n.top&&(t=n.top);return R(t<=e.stack_last),t+1}(e),n=t+Math.floor(t/8)+2*M.EXTRA_STACK;n>D&&(n=D),e.stack.length>D&&M.luaE_freeCI(e),t<=D-M.EXTRA_STACK&&n<e.stack.length&&H(e,n)},q=function(e,t,n){let a=e.stack[t];switch(a.type){case f:case p:{let u=a.type===f?a.value.f:a.value;z(e,i);let s=M.luaE_extendCI(e);s.funcOff=t,s.nresults=n,s.func=a,s.top=e.top+i,R(s.top<=e.stack_last),s.callstatus=0,e.hookmask&l&&W(e,r,-1);let o=u(e);if("number"!=typeof o||o<0||(0|o)!==o)throw Error("invalid return value from JS function (expected integer)");return E.api_checknelems(e,o),Z(e,s,e.top-o,o),!0}case L:{let r,u=a.value.p,s=e.top-t-1,o=u.maxstacksize;if(z(e,o),u.is_vararg)r=$(e,u,s);else{for(;s<u.numparams;s++)e.stack[e.top++]=new w.TValue(h,null);r=t+1}let i=M.luaE_extendCI(e);return i.funcOff=t,i.nresults=n,i.func=a,i.l_base=r,i.top=r+o,K(e,i.top),i.l_code=u.code,i.l_savedpc=0,i.callstatus=M.CIST_LUA,e.hookmask&l&&Q(e,i),!1}default:return z(e,1),ee(e,t,a),q(e,t,n)}},Z=function(e,t,n,r){let u=t.nresults;e.hookmask&(o|s)&&(e.hookmask&o&&W(e,a,-1),e.oldpc=t.previous.l_savedpc);let l=t.funcOff;return e.ci=t.previous,e.ci.next=null,J(e,n,l,r,u)},J=function(e,t,n,r,a){switch(a){case 0:break;case 1:0===r?e.stack[n].setnilvalue():w.setobjs2s(e,n,t);break;case c:for(let a=0;a<r;a++)w.setobjs2s(e,n+a,t+a);for(let t=e.top;t>=n+r;t--)delete e.stack[t];return e.top=n+r,!1;default:{let u;if(a<=r)for(u=0;u<a;u++)w.setobjs2s(e,n+u,t+u);else{for(u=0;u<r;u++)w.setobjs2s(e,n+u,t+u);for(;u<a;u++)n+u>=e.top?e.stack[n+u]=new w.TValue(h,null):e.stack[n+u].setnilvalue()}break}}let u=n+a;for(let t=e.top;t>=u;t--)delete e.stack[t];return e.top=u,!0},W=function(e,t,n){let r=e.hook;if(r&&e.allowhook){let a=e.ci,u=e.top,l=a.top,s=new O;s.event=t,s.currentline=n,s.i_ci=a,z(e,i),a.top=e.top+i,R(a.top<=e.stack_last),e.allowhook=0,a.callstatus|=M.CIST_HOOKED,r(e,s),R(!e.allowhook),e.allowhook=1,a.top=l,K(e,u),a.callstatus&=~M.CIST_HOOKED}},Q=function(e,t){let n=r;t.l_savedpc++,t.previous.callstatus&M.CIST_LUA&&t.previous.l_code[t.previous.l_savedpc-1].opcode==I.OpCodesI.OP_TAILCALL&&(t.callstatus|=M.CIST_TAIL,n=u),W(e,n,-1),t.l_savedpc--},$=function(e,t,n){let r,a=t.numparams,u=e.top-n,l=e.top;for(r=0;r<a&&r<n;r++)w.pushobj2s(e,e.stack[u+r]),e.stack[u+r].setnilvalue();for(;r<a;r++)e.stack[e.top++]=new w.TValue(h,null);return l},ee=function(e,t,n){let r=C.luaT_gettmbyobj(e,n,C.TMS.TM_CALL);r.ttisfunction(r)||m.luaG_typeerror(e,n,v("call",!0)),w.pushobj2s(e,e.stack[e.top-1]);for(let n=e.top-2;n>t;n--)w.setobjs2s(e,n,n-1);w.setobj2s(e,t,r)},te=function(e,t,n){++e.nCcalls>=S&&function(e){e.nCcalls===S?m.luaG_runerror(e,v("JS stack overflow",!0)):e.nCcalls>=S+(S>>3)&&ne(e,A)}(e),q(e,t,n)||B.luaV_execute(e),e.nCcalls--},ne=function(e,t){if(e.errorJmp)throw e.errorJmp.status=t,e.errorJmp;{let n=e.l_G;if(e.status=t,!n.mainthread.errorJmp){let r=n.panic;throw r&&(F(e,t,e.top),e.ci.top<e.top&&(e.ci.top=e.top),r(e)),new Error(`Aborted ${t}`)}n.mainthread.stack[n.mainthread.top++]=e.stack[e.top-1],ne(n.mainthread,t)}},re=function(e,t,n){let r=e.nCcalls,a={status:T,previous:e.errorJmp};e.errorJmp=a;try{t(e,n)}catch(t){if(a.status===T){let n=e.l_G.atnativeerror;if(n)try{if(a.status=T,E.lua_pushcfunction(e,n),E.lua_pushlightuserdata(e,t),_e(e,e.top-2,1),0!==e.errfunc){let t=e.errfunc;w.pushobj2s(e,e.stack[e.top-1]),w.setobjs2s(e,e.top-2,t),_e(e,e.top-2,1)}a.status=g}catch(e){a.status===T&&(a.status=-1)}else a.status=-1}}return e.errorJmp=a.previous,e.nCcalls=r,a.status},ae=function(e,t){let n=e.ci;R(null!==n.c_k&&0===e.nny),R(n.callstatus&M.CIST_YPCALL||t===b),n.callstatus&M.CIST_YPCALL&&(n.callstatus&=~M.CIST_YPCALL,e.errfunc=n.c_old_errfunc),n.nresults===c&&e.ci.top<e.top&&(e.ci.top=e.top);let r=(0,n.c_k)(e,t,n.c_ctx);E.api_checknelems(e,r),Z(e,n,e.top-r,r)},ue=function(e,t){for(null!==t&&ae(e,t);e.ci!==e.base_ci;)e.ci.callstatus&M.CIST_LUA?(B.luaV_finishOp(e),B.luaV_execute(e)):ae(e,b)},le=function(e,t){let n=function(e){for(let t=e.ci;null!==t;t=t.previous)if(t.callstatus&M.CIST_YPCALL)return t;return null}(e);if(null===n)return 0;let r=n.extra;return U.luaF_close(e,r),F(e,t,r),e.ci=n,e.allowhook=n.callstatus&M.CIST_OAH,e.nny=0,Y(e),e.errfunc=n.c_old_errfunc,1},se=function(e,t,n){let r=P(e,t);if(0===n)w.pushsvalue2s(e,r),N(e,e.top<=e.ci.top,"stack overflow");else{for(let t=1;t<n;t++)delete e.stack[--e.top];w.setsvalue2s(e,e.top-1,r)}return g},oe=function(e,t){let n=e.top-t,r=e.ci;e.status===T?q(e,n-1,c)||B.luaV_execute(e):(R(e.status===b),e.status=T,r.funcOff=r.extra,r.func=e.stack[r.funcOff],r.callstatus&M.CIST_LUA?B.luaV_execute(e):(null!==r.c_k&&(t=r.c_k(e,b,r.c_ctx),E.api_checknelems(e,t),n=e.top-t),Z(e,r,n,t)),ue(e,null))},ie=function(e,t,n,r){let a=e.ci;return E.api_checknelems(e,t),e.nny>0&&(e!==e.l_G.mainthread?m.luaG_runerror(e,v("attempt to yield across a JS-call boundary",!0)):m.luaG_runerror(e,v("attempt to yield from outside a coroutine",!0))),e.status=b,a.extra=a.funcOff,a.callstatus&M.CIST_LUA?N(e,null===r,"hooks cannot continue after yielding"):(a.c_k=r,null!==r&&(a.c_ctx=n),a.funcOff=e.top-t-1,a.func=e.stack[a.funcOff],ne(e,b)),R(a.callstatus&M.CIST_HOOKED),0},ce=function(e,t,n,r,a){let u=e.ci,l=e.allowhook,s=e.nny,o=e.errfunc;e.errfunc=a;let i=re(e,t,n);return i!==T&&(U.luaF_close(e,r),F(e,i,r),e.ci=u,e.allowhook=l,e.nny=s,Y(e)),e.errfunc=o,i},_e=function(e,t,n){e.nny++,te(e,t,n),e.nny--},fe=function(e,t,n){t&&-1===k(t,n[0])&&(w.luaO_pushfstring(e,v("attempt to load a %s chunk (mode is '%s')"),n,t),ne(e,x))},pe=function(e,t){let n,r=t.z.zgetc();r===_[0]?(fe(e,t.mode,v("binary",!0)),n=V.luaU_undump(e,t.z,t.name)):(fe(e,t.mode,v("text",!0)),n=y.luaY_parser(e,t.z,t.buff,t.dyd,t.name,r)),R(n.nupvalues===n.p.upvalues.length),U.luaF_initupvals(e,n)};e.exports.adjust_top=K,e.exports.luaD_call=te,e.exports.luaD_callnoyield=_e,e.exports.luaD_checkstack=z,e.exports.luaD_growstack=X,e.exports.luaD_hook=W,e.exports.luaD_inctop=function(e){z(e,1),e.stack[e.top++]=new w.TValue(h,null)},e.exports.luaD_pcall=ce,e.exports.luaD_poscall=Z,e.exports.luaD_precall=q,e.exports.luaD_protectedparser=function(e,t,n,r){let a=new class{constructor(e,t,n){this.z=e,this.buff=new G,this.dyd=new y.Dyndata,this.mode=n,this.name=t}}(t,n,r);e.nny++;let u=ce(e,pe,a,e.top,e.errfunc);return e.nny--,u},e.exports.luaD_rawrunprotected=re,e.exports.luaD_reallocstack=H,e.exports.luaD_throw=ne,e.exports.lua_isyieldable=function(e){return 0===e.nny},e.exports.lua_resume=function(e,t,n){let r=e.nny;if(e.status===T){if(e.ci!==e.base_ci)return se(e,"cannot resume non-suspended coroutine",n)}else if(e.status!==b)return se(e,"cannot resume dead coroutine",n);if(e.nCcalls=t?t.nCcalls+1:1,e.nCcalls>=S)return se(e,"JS stack overflow",n);e.nny=0,E.api_checknelems(e,e.status===T?n+1:n);let a=re(e,oe,n);if(-1===a)a=g;else{for(;a>b&&le(e,a);)a=re(e,ue,a);a>b?(e.status=a,F(e,a,e.top),e.ci.top=e.top):R(a===e.status)}return e.nny=r,e.nCcalls--,R(e.nCcalls===(t?t.nCcalls:0)),a},e.exports.lua_yield=function(e,t){ie(e,t,0,null)},e.exports.lua_yieldk=ie},function(e,t,n){"use strict";const{constant_types:{LUA_TBOOLEAN:r,LUA_TCCL:a,LUA_TLCF:u,LUA_TLCL:l,LUA_TLIGHTUSERDATA:s,LUA_TLNGSTR:o,LUA_TNIL:i,LUA_TNUMFLT:c,LUA_TNUMINT:_,LUA_TSHRSTR:f,LUA_TTABLE:p,LUA_TTHREAD:L,LUA_TUSERDATA:h},to_luastring:d}=n(1),{lua_assert:A}=n(4),g=n(11),x=n(6),{luaS_hashlongstr:T,TString:b}=n(10),O=n(12);let k=new WeakMap;const v=function(e){let t=k.get(e);return t||(t={},k.set(e,t)),t},E=function(e,t){switch(t.type){case i:return g.luaG_runerror(e,d("table index is nil",!0));case c:if(isNaN(t.value))return g.luaG_runerror(e,d("table index is NaN",!0));case _:case r:case p:case l:case u:case a:case h:case L:return t.value;case f:case o:return T(t.tsvalue());case s:{let n=t.value;switch(typeof n){case"string":return"*"+n;case"number":return"#"+n;case"boolean":return n?"?true":"?false";case"function":return v(n);case"object":if(n instanceof O.lua_State&&n.l_G===e.l_G||n instanceof m||n instanceof x.Udata||n instanceof x.LClosure||n instanceof x.CClosure)return v(n);default:return n}}default:throw new Error("unknown key type: "+t.type)}};class m{constructor(e){this.id=e.l_G.id_counter++,this.strong=new Map,this.dead_strong=new Map,this.dead_weak=void 0,this.f=void 0,this.l=void 0,this.metatable=null,this.flags=-1}}const U=function(e,t,n,r){e.dead_strong.clear(),e.dead_weak=void 0;let a=null,u={key:n,value:r,p:a=e.l,n:void 0};e.f||(e.f=u),a&&(a.n=u),e.strong.set(t,u),e.l=u},N=function(e,t){let n=e.strong.get(t);if(n){n.key.setdeadvalue(),n.value=void 0;let r=n.n,a=n.p;n.p=void 0,a&&(a.n=r),r&&(r.p=a),e.f===n&&(e.f=r),e.l===n&&(e.l=a),e.strong.delete(t),("object"==typeof t?null!==t:"function"==typeof t)?(e.dead_weak||(e.dead_weak=new WeakMap),e.dead_weak.set(t,n)):e.dead_strong.set(t,n)}},R=function(e,t){let n=e.strong.get(t);return n?n.value:x.luaO_nilobject},S=function(e,t){return A("number"==typeof t&&(0|t)===t),R(e,t)};e.exports.invalidateTMcache=function(e){e.flags=0},e.exports.luaH_get=function(e,t,n){return A(n instanceof x.TValue),n.ttisnil()||n.ttisfloat()&&isNaN(n.value)?x.luaO_nilobject:R(t,E(e,n))},e.exports.luaH_getint=S,e.exports.luaH_getn=function(e){let t=0,n=e.strong.size+1;for(;n-t>1;){let r=Math.floor((t+n)/2);S(e,r).ttisnil()?n=r:t=r}return t},e.exports.luaH_getstr=function(e,t){return A(t instanceof b),R(e,T(t))},e.exports.luaH_setfrom=function(e,t,n,r){A(n instanceof x.TValue);let a=E(e,n);if(r.ttisnil())return void N(t,a);let u=t.strong.get(a);if(u)u.value.setfrom(r);else{let e,u=n.value;e=n.ttisfloat()&&(0|u)===u?new x.TValue(_,u):new x.TValue(n.type,u);let l=new x.TValue(r.type,r.value);U(t,a,e,l)}},e.exports.luaH_setint=function(e,t,n){A("number"==typeof t&&(0|t)===t&&n instanceof x.TValue);let r=t;if(n.ttisnil())return void N(e,r);let a=e.strong.get(r);if(a)a.value.setfrom(n);else{let a=new x.TValue(_,t),u=new x.TValue(n.type,n.value);U(e,r,a,u)}},e.exports.luaH_new=function(e){return new m(e)},e.exports.luaH_next=function(e,t,n){let r,a=e.stack[n];if(a.type===i){if(!(r=t.f))return!1}else{let n=E(e,a);if(r=t.strong.get(n)){if(!(r=r.n))return!1}else{if(!(r=t.dead_weak&&t.dead_weak.get(n)||t.dead_strong.get(n)))return g.luaG_runerror(e,d("invalid key to 'next'"));do{if(!(r=r.n))return!1}while(r.key.ttisdeadkey())}}return x.setobj2s(e,n,r.key),x.setobj2s(e,n+1,r.value),!0},e.exports.Table=m},function(e,t,n){"use strict";const{is_luastring:r,luastring_eq:a,luastring_from:u,to_luastring:l}=n(1),{lua_assert:s}=n(4);class o{constructor(e,t){this.hash=null,this.realstring=t}getstr(){return this.realstring}tsslen(){return this.realstring.length}}const i=function(e){s(r(e));let t=e.length,n="|";for(let r=0;r<t;r++)n+=e[r].toString(16);return n},c=function(e,t){return s(t instanceof Uint8Array),new o(e,t)};e.exports.luaS_eqlngstr=function(e,t){return s(e instanceof o),s(t instanceof o),e==t||a(e.realstring,t.realstring)},e.exports.luaS_hash=i,e.exports.luaS_hashlongstr=function(e){return s(e instanceof o),null===e.hash&&(e.hash=i(e.getstr())),e.hash},e.exports.luaS_bless=c,e.exports.luaS_new=function(e,t){return c(e,u(t))},e.exports.luaS_newliteral=function(e,t){return c(e,l(t))},e.exports.TString=o},function(e,t,n){"use strict";const{LUA_HOOKCOUNT:r,LUA_HOOKLINE:a,LUA_MASKCOUNT:u,LUA_MASKLINE:l,constant_types:{LUA_TBOOLEAN:s,LUA_TNIL:o,LUA_TTABLE:i},thread_status:{LUA_ERRRUN:c,LUA_YIELD:_},from_userstring:f,luastring_eq:p,luastring_indexOf:L,to_luastring:h}=n(1),{api_check:d,lua_assert:A}=n(4),{LUA_IDSIZE:g}=n(3),x=n(18),T=n(8),b=n(13),O=n(20),k=n(6),v=n(16),E=n(12),m=n(9),U=n(14),N=n(15),R=function(e){return A(e.callstatus&E.CIST_LUA),e.l_savedpc-1},S=function(e){return 0!==e.func.value.p.lineinfo.length?e.func.value.p.lineinfo[R(e)]:-1},w=function(e){if(e.status===_){let t=e.ci,n=t.funcOff;t.func=e.stack[t.extra],t.funcOff=t.extra,t.extra=n}},I=function(e,t){A(t<e.upvalues.length);let n=e.upvalues[t].name;return null===n?h("?",!0):n.getstr()},y=function(e,t,n){let r,a=null;if(t.callstatus&E.CIST_LUA){if(n<0)return function(e,t){let n=e.func.value.p.numparams;return t>=e.l_base-e.funcOff-n?null:{pos:e.funcOff+n+t,name:h("(*vararg)",!0)}}(t,-n);r=t.l_base,a=b.luaF_getlocalname(t.func.value.p,n,R(t))}else r=t.funcOff+1;if(null===a){if(!((t===e.ci?e.top:t.next.funcOff)-r>=n&&n>0))return null;a=h("(*temporary)",!0)}return{pos:r+(n-1),name:a}},M=function(e,t){if(null===t||t instanceof k.CClosure)e.source=h("=[JS]",!0),e.linedefined=-1,e.lastlinedefined=-1,e.what=h("J",!0);else{let n=t.p;e.source=n.source?n.source.getstr():h("=?",!0),e.linedefined=n.linedefined,e.lastlinedefined=n.lastlinedefined,e.what=0===e.linedefined?h("main",!0):h("Lua",!0)}e.short_src=k.luaO_chunkid(e.source,g)},P=function(e,t){let n={name:null,funcname:null};return null===t?null:t.callstatus&E.CIST_FIN?(n.name=h("__gc",!0),n.funcname=h("metamethod",!0),n):!(t.callstatus&E.CIST_TAIL)&&t.previous.callstatus&E.CIST_LUA?B(e,t.previous):null},C=function(e,t,n){let r={name:null,funcname:null};if(v.ISK(n)){let t=e.k[v.INDEXK(n)];if(t.ttisstring())return r.name=t.svalue(),r}else{let r=V(e,t,n);if(r&&99===r.funcname[0])return r}return r.name=h("?",!0),r},D=function(e,t){return e<t?-1:e},V=function(e,t,n){let r={name:b.luaF_getlocalname(e,n+1,t),funcname:null};if(r.name)return r.funcname=h("local",!0),r;let a=function(e,t,n){let r=-1,a=0,u=v.OpCodesI;for(let l=0;l<t;l++){let s=e.code[l],o=s.A;switch(s.opcode){case u.OP_LOADNIL:{let e=s.B;o<=n&&n<=o+e&&(r=D(l,a));break}case u.OP_TFORCALL:n>=o+2&&(r=D(l,a));break;case u.OP_CALL:case u.OP_TAILCALL:n>=o&&(r=D(l,a));break;case u.OP_JMP:{let e=l+1+s.sBx;l<e&&e<=t&&e>a&&(a=e);break}default:v.testAMode(s.opcode)&&n===o&&(r=D(l,a))}}return r}(e,t,n),u=v.OpCodesI;if(-1!==a){let t=e.code[a];switch(t.opcode){case u.OP_MOVE:{let n=t.B;if(n<t.A)return V(e,a,n);break}case u.OP_GETTABUP:case u.OP_GETTABLE:{let n=t.C,l=t.B,s=t.opcode===u.OP_GETTABLE?b.luaF_getlocalname(e,l+1,a):I(e,l);return r.name=C(e,a,n).name,r.funcname=s&&p(s,O.LUA_ENV)?h("global",!0):h("field",!0),r}case u.OP_GETUPVAL:return r.name=I(e,t.B),r.funcname=h("upvalue",!0),r;case u.OP_LOADK:case u.OP_LOADKX:{let n=t.opcode===u.OP_LOADK?t.Bx:e.code[a+1].Ax;if(e.k[n].ttisstring())return r.name=e.k[n].svalue(),r.funcname=h("constant",!0),r;break}case u.OP_SELF:{let n=t.C;return r.name=C(e,a,n).name,r.funcname=h("method",!0),r}}}return null},B=function(e,t){let n={name:null,funcname:null},r=0,a=t.func.value.p,u=R(t),l=a.code[u],s=v.OpCodesI;if(t.callstatus&E.CIST_HOOKED)return n.name=h("?",!0),n.funcname=h("hook",!0),n;switch(l.opcode){case s.OP_CALL:case s.OP_TAILCALL:return V(a,u,l.A);case s.OP_TFORCALL:return n.name=h("for iterator",!0),n.funcname=h("for iterator",!0),n;case s.OP_SELF:case s.OP_GETTABUP:case s.OP_GETTABLE:r=U.TMS.TM_INDEX;break;case s.OP_SETTABUP:case s.OP_SETTABLE:r=U.TMS.TM_NEWINDEX;break;case s.OP_ADD:r=U.TMS.TM_ADD;break;case s.OP_SUB:r=U.TMS.TM_SUB;break;case s.OP_MUL:r=U.TMS.TM_MUL;break;case s.OP_MOD:r=U.TMS.TM_MOD;break;case s.OP_POW:r=U.TMS.TM_POW;break;case s.OP_DIV:r=U.TMS.TM_DIV;break;case s.OP_IDIV:r=U.TMS.TM_IDIV;break;case s.OP_BAND:r=U.TMS.TM_BAND;break;case s.OP_BOR:r=U.TMS.TM_BOR;break;case s.OP_BXOR:r=U.TMS.TM_BXOR;break;case s.OP_SHL:r=U.TMS.TM_SHL;break;case s.OP_SHR:r=U.TMS.TM_SHR;break;case s.OP_UNM:r=U.TMS.TM_UNM;break;case s.OP_BNOT:r=U.TMS.TM_BNOT;break;case s.OP_LEN:r=U.TMS.TM_LEN;break;case s.OP_CONCAT:r=U.TMS.TM_CONCAT;break;case s.OP_EQ:r=U.TMS.TM_EQ;break;case s.OP_LT:r=U.TMS.TM_LT;break;case s.OP_LE:r=U.TMS.TM_LE;break;default:return null}return n.name=e.l_G.tmname[r].getstr(),n.funcname=h("metamethod",!0),n},G=function(e,t){let n=e.ci,r=null;if(n.callstatus&E.CIST_LUA){r=function(e,t,n){let r=t.func.value;for(let e=0;e<r.nupvalues;e++)if(r.upvals[e]===n)return{name:I(r.p,e),funcname:h("upvalue",!0)};return null}(0,n,t);let a=function(e,t,n){for(let r=t.l_base;r<t.top;r++)if(e.stack[r]===n)return r;return!1}(e,n,t);!r&&a&&(r=V(n.func.value.p,R(n),a-n.l_base))}return r?k.luaO_pushfstring(e,h(" (%s '%s')",!0),r.funcname,r.name):h("",!0)},K=function(e,t,n){let r=U.luaT_objtypename(e,t);j(e,h("attempt to %s a %s value%s",!0),n,r,G(e,t))},F=function(e,t,n,r){let a;return a=n?k.luaO_chunkid(n.getstr(),g):h("?",!0),k.luaO_pushfstring(e,h("%s:%d: %s",!0),a,r,t)},j=function(e,t,...n){let r=e.ci,a=k.luaO_pushvfstring(e,t,n);r.callstatus&E.CIST_LUA&&F(e,a,r.func.value.p.source,S(r)),H(e)},H=function(e){if(0!==e.errfunc){let t=e.errfunc;k.pushobj2s(e,e.stack[e.top-1]),k.setobjs2s(e,e.top-2,t),T.luaD_callnoyield(e,e.top-2,1)}T.luaD_throw(e,c)};e.exports.luaG_addinfo=F,e.exports.luaG_concaterror=function(e,t,n){(t.ttisstring()||N.cvt2str(t))&&(t=n),K(e,t,h("concatenate",!0))},e.exports.luaG_errormsg=H,e.exports.luaG_opinterror=function(e,t,n,r){!1===N.tonumber(t)&&(n=t),K(e,n,r)},e.exports.luaG_ordererror=function(e,t,n){let r=U.luaT_objtypename(e,t),a=U.luaT_objtypename(e,n);p(r,a)?j(e,h("attempt to compare two %s values",!0),r):j(e,h("attempt to compare %s with %s",!0),r,a)},e.exports.luaG_runerror=j,e.exports.luaG_tointerror=function(e,t,n){!1===N.tointeger(t)&&(n=t),j(e,h("number%s has no integer representation",!0),G(e,n))},e.exports.luaG_traceexec=function(e){let t=e.ci,n=e.hookmask,s=0==--e.hookcount&&n&u;if(s)e.hookcount=e.basehookcount;else if(!(n&l))return;if(t.callstatus&E.CIST_HOOKYIELD)t.callstatus&=~E.CIST_HOOKYIELD;else{if(s&&T.luaD_hook(e,r,-1),n&l){let n=t.func.value.p,r=t.l_savedpc-1,u=0!==n.lineinfo.length?n.lineinfo[r]:-1;(0===r||t.l_savedpc<=e.oldpc||u!==(0!==n.lineinfo.length?n.lineinfo[e.oldpc-1]:-1))&&T.luaD_hook(e,a,u)}e.oldpc=t.l_savedpc,e.status===_&&(s&&(e.hookcount=1),t.l_savedpc--,t.callstatus|=E.CIST_HOOKYIELD,t.funcOff=e.top-1,t.func=e.stack[t.funcOff],T.luaD_throw(e,_))}},e.exports.luaG_typeerror=K,e.exports.lua_gethook=function(e){return e.hook},e.exports.lua_gethookcount=function(e){return e.basehookcount},e.exports.lua_gethookmask=function(e){return e.hookmask},e.exports.lua_getinfo=function(e,t,n){let r,a,u,l;return t=f(t),w(e),62===t[0]?(u=null,l=e.stack[e.top-1],d(e,l.ttisfunction(),"function expected"),t=t.subarray(1),e.top--):(l=(u=n.i_ci).func,A(u.func.ttisfunction())),r=function(e,t,n,r,a){let u=1;for(;t.length>0;t=t.subarray(1))switch(t[0]){case 83:M(n,r);break;case 108:n.currentline=a&&a.callstatus&E.CIST_LUA?S(a):-1;break;case 117:n.nups=null===r?0:r.nupvalues,null===r||r instanceof k.CClosure?(n.isvararg=!0,n.nparams=0):(n.isvararg=r.p.is_vararg,n.nparams=r.p.numparams);break;case 116:n.istailcall=a?a.callstatus&E.CIST_TAIL:0;break;case 110:{let t=P(e,a);null===t?(n.namewhat=h("",!0),n.name=null):(n.namewhat=t.funcname,n.name=t.name);break}case 76:case 102:break;default:u=0}return u}(e,t,n,a=l.ttisclosure()?l.value:null,u),L(t,102)>=0&&(k.pushobj2s(e,l),d(e,e.top<=e.ci.top,"stack overflow")),w(e),L(t,76)>=0&&function(e,t){if(null===t||t instanceof k.CClosure)e.stack[e.top]=new k.TValue(o,null),x.api_incr_top(e);else{let n=t.p.lineinfo,r=m.luaH_new(e);e.stack[e.top]=new k.TValue(i,r),x.api_incr_top(e);let a=new k.TValue(s,!0);for(let e=0;e<n.length;e++)m.luaH_setint(r,n[e],a)}}(e,a),r},e.exports.lua_getlocal=function(e,t,n){let r;if(w(e),null===t)r=e.stack[e.top-1].ttisLclosure()?b.luaF_getlocalname(e.stack[e.top-1].value.p,n,0):null;else{let a=y(e,t.i_ci,n);a?(r=a.name,k.pushobj2s(e,e.stack[a.pos]),d(e,e.top<=e.ci.top,"stack overflow")):r=null}return w(e),r},e.exports.lua_getstack=function(e,t,n){let r,a;if(t<0)return 0;for(r=e.ci;t>0&&r!==e.base_ci;r=r.previous)t--;return 0===t&&r!==e.base_ci?(a=1,n.i_ci=r):a=0,a},e.exports.lua_sethook=function(e,t,n,r){null!==t&&0!==n||(n=0,t=null),e.ci.callstatus&E.CIST_LUA&&(e.oldpc=e.ci.l_savedpc),e.hook=t,e.basehookcount=r,e.hookcount=e.basehookcount,e.hookmask=n},e.exports.lua_setlocal=function(e,t,n){let r;w(e);let a=y(e,t.i_ci,n);return a?(r=a.name,k.setobjs2s(e,a.pos,e.top-1),delete e.stack[--e.top]):r=null,w(e),r}},function(e,t,n){"use strict";const{LUA_MINSTACK:r,LUA_RIDX_GLOBALS:a,LUA_RIDX_MAINTHREAD:u,constant_types:{LUA_NUMTAGS:l,LUA_TNIL:s,LUA_TTABLE:o,LUA_TTHREAD:i},thread_status:{LUA_OK:c}}=n(1),_=n(6),f=n(8),p=n(18),L=n(9),h=n(14),d=2*r;class A{constructor(){this.func=null,this.funcOff=NaN,this.top=NaN,this.previous=null,this.next=null,this.l_base=NaN,this.l_code=null,this.l_savedpc=NaN,this.c_k=null,this.c_old_errfunc=null,this.c_ctx=null,this.nresults=NaN,this.callstatus=NaN}}class g{constructor(e){this.id=e.id_counter++,this.base_ci=new A,this.top=NaN,this.stack_last=NaN,this.oldpc=NaN,this.l_G=e,this.stack=null,this.ci=null,this.errorJmp=null,this.nCcalls=0,this.hook=null,this.hookmask=0,this.basehookcount=0,this.allowhook=1,this.hookcount=this.basehookcount,this.nny=1,this.status=c,this.errfunc=0}}const x=function(e){e.ci.next=null},T=function(e,t){e.stack=new Array(d),e.top=0,e.stack_last=d-5;let n=e.base_ci;n.next=n.previous=null,n.callstatus=0,n.funcOff=e.top,n.func=e.stack[e.top],e.stack[e.top++]=new _.TValue(s,null),n.top=e.top+r,e.ci=n},b=function(e){e.ci=e.base_ci,x(e),e.stack=null},O=function(e){let t=e.l_G;T(e),function(e,t){let n=L.luaH_new(e);t.l_registry.sethvalue(n),L.luaH_setint(n,u,new _.TValue(i,e)),L.luaH_setint(n,a,new _.TValue(o,L.luaH_new(e)))}(e,t),h.luaT_init(e),t.version=p.lua_version(null)};e.exports.lua_State=g,e.exports.CallInfo=A,e.exports.CIST_OAH=1,e.exports.CIST_LUA=2,e.exports.CIST_HOOKED=4,e.exports.CIST_FRESH=8,e.exports.CIST_YPCALL=16,e.exports.CIST_TAIL=32,e.exports.CIST_HOOKYIELD=64,e.exports.CIST_LEQ=128,e.exports.CIST_FIN=256,e.exports.EXTRA_STACK=5,e.exports.lua_close=function(e){!function(e){b(e)}(e=e.l_G.mainthread)},e.exports.lua_newstate=function(){let e=new class{constructor(){this.id_counter=1,this.ids=new WeakMap,this.mainthread=null,this.l_registry=new _.TValue(s,null),this.panic=null,this.atnativeerror=null,this.version=null,this.tmname=new Array(h.TMS.TM_N),this.mt=new Array(l)}},t=new g(e);return e.mainthread=t,f.luaD_rawrunprotected(t,O,null)!==c&&(t=null),t},e.exports.lua_newthread=function(e){let t=e.l_G,n=new g(t);return e.stack[e.top]=new _.TValue(i,n),p.api_incr_top(e),n.hookmask=e.hookmask,n.basehookcount=e.basehookcount,n.hook=e.hook,n.hookcount=n.basehookcount,T(n),n},e.exports.luaE_extendCI=function(e){let t=new A;return e.ci.next=t,t.previous=e.ci,t.next=null,e.ci=t,t},e.exports.luaE_freeCI=x,e.exports.luaE_freethread=function(e,t){b(t)}},function(e,t,n){"use strict";const{constant_types:{LUA_TNIL:r}}=n(1),a=n(6);e.exports.MAXUPVAL=255,e.exports.Proto=class{constructor(e){this.id=e.l_G.id_counter++,this.k=[],this.p=[],this.code=[],this.cache=null,this.lineinfo=[],this.upvalues=[],this.numparams=0,this.is_vararg=!1,this.maxstacksize=0,this.locvars=[],this.linedefined=0,this.lastlinedefined=0,this.source=null}},e.exports.luaF_findupval=function(e,t){return e.stack[t]},e.exports.luaF_close=function(e,t){for(let n=t;n<e.top;n++){let t=e.stack[n];e.stack[n]=new a.TValue(t.type,t.value)}},e.exports.luaF_getlocalname=function(e,t,n){for(let r=0;r<e.locvars.length&&e.locvars[r].startpc<=n;r++)if(n<e.locvars[r].endpc&&0==--t)return e.locvars[r].varname.getstr();return null},e.exports.luaF_initupvals=function(e,t){for(let e=0;e<t.nupvalues;e++)t.upvals[e]=new a.TValue(r,null)},e.exports.luaF_newLclosure=function(e,t){return new a.LClosure(e,t)}},function(e,t,n){"use strict";const{constant_types:{LUA_TTABLE:r,LUA_TUSERDATA:a},to_luastring:u}=n(1),{lua_assert:l}=n(4),s=n(6),o=n(8),i=n(12),{luaS_bless:c,luaS_new:_}=n(10),f=n(9),p=n(11),L=n(15),h=["no value","nil","boolean","userdata","number","string","table","function","userdata","thread","proto"].map(e=>u(e)),d=function(e){return h[e+1]},A={TM_INDEX:0,TM_NEWINDEX:1,TM_GC:2,TM_MODE:3,TM_LEN:4,TM_EQ:5,TM_ADD:6,TM_SUB:7,TM_MUL:8,TM_MOD:9,TM_POW:10,TM_DIV:11,TM_IDIV:12,TM_BAND:13,TM_BOR:14,TM_BXOR:15,TM_SHL:16,TM_SHR:17,TM_UNM:18,TM_BNOT:19,TM_LT:20,TM_LE:21,TM_CONCAT:22,TM_CALL:23,TM_N:24},g=u("__name",!0),x=function(e,t,n,r,a,u){let l=e.top;if(s.pushobj2s(e,t),s.pushobj2s(e,n),s.pushobj2s(e,r),u||s.pushobj2s(e,a),e.ci.callstatus&i.CIST_LUA?o.luaD_call(e,l,u):o.luaD_callnoyield(e,l,u),u){let t=e.stack[e.top-1];delete e.stack[--e.top],a.setfrom(t)}},T=function(e,t,n,r,a){let u=O(e,t,a);return u.ttisnil()&&(u=O(e,n,a)),!u.ttisnil()&&(x(e,u,t,n,r,1),!0)},b=function(e,t,n){const r=f.luaH_getstr(e,n);return l(t<=A.TM_EQ),r.ttisnil()?(e.flags|=1<<t,null):r},O=function(e,t,n){let u;switch(t.ttnov()){case r:case a:u=t.value.metatable;break;default:u=e.l_G.mt[t.ttnov()]}return u?f.luaH_getstr(u,e.l_G.tmname[n]):s.luaO_nilobject};e.exports.fasttm=function(e,t,n){return null===t?null:t.flags&1<<n?null:b(t,n,e.l_G.tmname[n])},e.exports.TMS=A,e.exports.luaT_callTM=x,e.exports.luaT_callbinTM=T,e.exports.luaT_trybinTM=function(e,t,n,r,a){if(!T(e,t,n,r,a))switch(a){case A.TM_CONCAT:return p.luaG_concaterror(e,t,n);case A.TM_BAND:case A.TM_BOR:case A.TM_BXOR:case A.TM_SHL:case A.TM_SHR:case A.TM_BNOT:{let r=L.tonumber(t),a=L.tonumber(n);return!1!==r&&!1!==a?p.luaG_tointerror(e,t,n):p.luaG_opinterror(e,t,n,u("perform bitwise operation on",!0))}default:return p.luaG_opinterror(e,t,n,u("perform arithmetic on",!0))}},e.exports.luaT_callorderTM=function(e,t,n,r){let a=new s.TValue;return T(e,t,n,a,r)?!a.l_isfalse():null},e.exports.luaT_gettm=b,e.exports.luaT_gettmbyobj=O,e.exports.luaT_init=function(e){e.l_G.tmname[A.TM_INDEX]=new _(e,u("__index",!0)),e.l_G.tmname[A.TM_NEWINDEX]=new _(e,u("__newindex",!0)),e.l_G.tmname[A.TM_GC]=new _(e,u("__gc",!0)),e.l_G.tmname[A.TM_MODE]=new _(e,u("__mode",!0)),e.l_G.tmname[A.TM_LEN]=new _(e,u("__len",!0)),e.l_G.tmname[A.TM_EQ]=new _(e,u("__eq",!0)),e.l_G.tmname[A.TM_ADD]=new _(e,u("__add",!0)),e.l_G.tmname[A.TM_SUB]=new _(e,u("__sub",!0)),e.l_G.tmname[A.TM_MUL]=new _(e,u("__mul",!0)),e.l_G.tmname[A.TM_MOD]=new _(e,u("__mod",!0)),e.l_G.tmname[A.TM_POW]=new _(e,u("__pow",!0)),e.l_G.tmname[A.TM_DIV]=new _(e,u("__div",!0)),e.l_G.tmname[A.TM_IDIV]=new _(e,u("__idiv",!0)),e.l_G.tmname[A.TM_BAND]=new _(e,u("__band",!0)),e.l_G.tmname[A.TM_BOR]=new _(e,u("__bor",!0)),e.l_G.tmname[A.TM_BXOR]=new _(e,u("__bxor",!0)),e.l_G.tmname[A.TM_SHL]=new _(e,u("__shl",!0)),e.l_G.tmname[A.TM_SHR]=new _(e,u("__shr",!0)),e.l_G.tmname[A.TM_UNM]=new _(e,u("__unm",!0)),e.l_G.tmname[A.TM_BNOT]=new _(e,u("__bnot",!0)),e.l_G.tmname[A.TM_LT]=new _(e,u("__lt",!0)),e.l_G.tmname[A.TM_LE]=new _(e,u("__le",!0)),e.l_G.tmname[A.TM_CONCAT]=new _(e,u("__concat",!0)),e.l_G.tmname[A.TM_CALL]=new _(e,u("__call",!0))},e.exports.luaT_objtypename=function(e,t){let n;if(t.ttistable()&&null!==(n=t.value.metatable)||t.ttisfulluserdata()&&null!==(n=t.value.metatable)){let t=f.luaH_getstr(n,c(e,g));if(t.ttisstring())return t.svalue()}return d(t.ttnov())},e.exports.ttypename=d},function(e,t,n){"use strict";const{LUA_MASKLINE:r,LUA_MASKCOUNT:a,LUA_MULTRET:u,constant_types:{LUA_TBOOLEAN:l,LUA_TLCF:s,LUA_TLIGHTUSERDATA:o,LUA_TLNGSTR:i,LUA_TNIL:c,LUA_TNUMBER:_,LUA_TNUMFLT:f,LUA_TNUMINT:p,LUA_TSHRSTR:L,LUA_TTABLE:h,LUA_TUSERDATA:d},to_luastring:A}=n(1),{INDEXK:g,ISK:x,LFIELDS_PER_FLUSH:T,OpCodesI:{OP_ADD:b,OP_BAND:O,OP_BNOT:k,OP_BOR:v,OP_BXOR:E,OP_CALL:m,OP_CLOSURE:U,OP_CONCAT:N,OP_DIV:R,OP_EQ:S,OP_EXTRAARG:w,OP_FORLOOP:I,OP_FORPREP:y,OP_GETTABLE:M,OP_GETTABUP:P,OP_GETUPVAL:C,OP_IDIV:D,OP_JMP:V,OP_LE:B,OP_LEN:G,OP_LOADBOOL:K,OP_LOADK:F,OP_LOADKX:j,OP_LOADNIL:H,OP_LT:X,OP_MOD:z,OP_MOVE:Y,OP_MUL:q,OP_NEWTABLE:Z,OP_NOT:J,OP_POW:W,OP_RETURN:Q,OP_SELF:$,OP_SETLIST:ee,OP_SETTABLE:te,OP_SETTABUP:ne,OP_SETUPVAL:re,OP_SHL:ae,OP_SHR:ue,OP_SUB:le,OP_TAILCALL:se,OP_TEST:oe,OP_TESTSET:ie,OP_TFORCALL:ce,OP_TFORLOOP:_e,OP_UNM:fe,OP_VARARG:pe}}=n(16),{LUA_MAXINTEGER:Le,LUA_MININTEGER:he,lua_numbertointeger:de}=n(3),{lua_assert:Ae,luai_nummod:ge}=n(4),xe=n(6),Te=n(13),be=n(12),{luaS_bless:Oe,luaS_eqlngstr:ke,luaS_hashlongstr:ve}=n(10),Ee=n(8),me=n(14),Ue=n(9),Ne=n(11),Re=function(e,t,n){return t+n.A},Se=function(e,t,n){return t+n.B},we=function(e,t,n,r){return x(r.B)?n[g(r.B)]:e.stack[t+r.B]},Ie=function(e,t,n,r){return x(r.C)?n[g(r.C)]:e.stack[t+r.C]},ye=function(e,t,n,r){let a=n.A;0!==a&&Te.luaF_close(e,t.l_base+a-1),t.l_savedpc+=n.sBx+r},Me=function(e,t){ye(e,t,t.l_code[t.l_savedpc],1)},Pe=function(e,t,n){if(t.ttisnumber()&&n.ttisnumber())return Fe(t,n)?1:0;if(t.ttisstring()&&n.ttisstring())return He(t.tsvalue(),n.tsvalue())<0?1:0;{let r=me.luaT_callorderTM(e,t,n,me.TMS.TM_LT);return null===r&&Ne.luaG_ordererror(e,t,n),r?1:0}},Ce=function(e,t,n){let r;return t.ttisnumber()&&n.ttisnumber()?je(t,n)?1:0:t.ttisstring()&&n.ttisstring()?He(t.tsvalue(),n.tsvalue())<=0?1:0:null!==(r=me.luaT_callorderTM(e,t,n,me.TMS.TM_LE))?r?1:0:(e.ci.callstatus|=be.CIST_LEQ,r=me.luaT_callorderTM(e,n,t,me.TMS.TM_LT),e.ci.callstatus^=be.CIST_LEQ,null===r&&Ne.luaG_ordererror(e,t,n),r?0:1)},De=function(e,t,n){if(t.ttype()!==n.ttype())return t.ttnov()!==n.ttnov()||t.ttnov()!==_?0:t.value===n.value?1:0;let r;switch(t.ttype()){case c:return 1;case l:return t.value==n.value?1:0;case o:case p:case f:case s:return t.value===n.value?1:0;case L:case i:return ke(t.tsvalue(),n.tsvalue())?1:0;case d:case h:if(t.value===n.value)return 1;if(null===e)return 0;null===(r=me.fasttm(e,t.value.metatable,me.TMS.TM_EQ))&&(r=me.fasttm(e,n.value.metatable,me.TMS.TM_EQ));break;default:return t.value===n.value?1:0}if(null===r)return 0;let a=new xe.TValue;return me.luaT_callTM(e,r,t,n,a,1),a.l_isfalse()?0:1},Ve=function(e,t){let n=!1,r=Be(e,t<0?2:1);if(!1===r){let a=Ke(e);if(!1===a)return!1;0<a?(r=Le,t<0&&(n=!0)):(r=he,t>=0&&(n=!0))}return{stopnow:n,ilimit:r}},Be=function(e,t){if(e.ttisfloat()){let n=e.value,r=Math.floor(n);if(n!==r){if(0===t)return!1;t>1&&(r+=1)}return de(r)}if(e.ttisinteger())return e.value;if($e(e)){let n=new xe.TValue;if(xe.luaO_str2num(e.svalue(),n)===e.vslen()+1)return Be(n,t)}return!1},Ge=function(e){return e.ttisinteger()?e.value:Be(e,0)},Ke=function(e){if(e.ttnov()===_)return e.value;if($e(e)){let t=new xe.TValue;if(xe.luaO_str2num(e.svalue(),t)===e.vslen()+1)return t.value}return!1},Fe=function(e,t){return e.value<t.value},je=function(e,t){return e.value<=t.value},He=function(e,t){let n=ve(e),r=ve(t);return n===r?0:n<r?-1:1},Xe=function(e,t,n){let r;switch(n.ttype()){case h:{let a=n.value;if(null!==(r=me.fasttm(e,a.metatable,me.TMS.TM_LEN)))break;return void t.setivalue(Ue.luaH_getn(a))}case L:case i:return void t.setivalue(n.vslen());default:(r=me.luaT_gettmbyobj(e,n,me.TMS.TM_LEN)).ttisnil()&&Ne.luaG_typeerror(e,n,A("get length of",!0))}me.luaT_callTM(e,r,n,n,t,1)},ze=Math.imul||function(e,t){let n=65535&e,r=65535&t;return n*r+((e>>>16&65535)*r+n*(t>>>16&65535)<<16>>>0)|0},Ye=function(e,t,n){return 0===n&&Ne.luaG_runerror(e,A("attempt to divide by zero")),0|Math.floor(t/n)},qe=function(e,t,n){return 0===n&&Ne.luaG_runerror(e,A("attempt to perform 'n%%0'")),t-Math.floor(t/n)*n|0},Ze=function(e,t){return t<0?t<=-32?0:e>>>-t:t>=32?0:e<<t},Je=function(e,t,n,r){let a=e.cache;if(null!==a){let u=e.upvalues,l=u.length;for(let e=0;e<l;e++){let l=u[e].instack?n[r+u[e].idx]:t[u[e].idx];if(a.upvals[e]!==l)return null}}return a},We=function(e,t,n,r,a){let u=t.upvalues.length,l=t.upvalues,s=new xe.LClosure(e,u);s.p=t,e.stack[a].setclLvalue(s);for(let t=0;t<u;t++)l[t].instack?s.upvals[t]=Te.luaF_findupval(e,r+l[t].idx):s.upvals[t]=n[l[t].idx];t.cache=s},Qe=function(e){return e.ttisnumber()},$e=function(e){return e.ttisstring()},et=function(e,t){let n=e.stack[t];return!!n.ttisstring()||!!Qe(n)&&(xe.luaO_tostring(e,n),!0)},tt=function(e){return e.ttisstring()&&0===e.vslen()},nt=function(e,t,n,r){let a=0;do{let u=e.stack[t-n],l=u.vslen(),s=u.svalue();r.set(s,a),a+=l}while(--n>0)},rt=function(e,t){Ae(t>=2);do{let n=e.top,r=2;if((e.stack[n-2].ttisstring()||Qe(e.stack[n-2]))&&et(e,n-1))if(tt(e.stack[n-1]))et(e,n-2);else if(tt(e.stack[n-2]))xe.setobjs2s(e,n-2,n-1);else{let a=e.stack[n-1].vslen();for(r=1;r<t&&et(e,n-r-1);r++)a+=e.stack[n-r-1].vslen();let u=new Uint8Array(a);nt(e,n,r,u);let l=Oe(e,u);xe.setsvalue2s(e,n-r,l)}else me.luaT_trybinTM(e,e.stack[n-2],e.stack[n-1],e.stack[n-2],me.TMS.TM_CONCAT);for(t-=r-1;e.top>n-(r-1);)delete e.stack[--e.top]}while(t>1)},at=function(e,t,n,r){for(let a=0;a<2e3;a++){let a;if(t.ttistable()){let u=Ue.luaH_get(e,t.value,n);if(!u.ttisnil())return void xe.setobj2s(e,r,u);if(null===(a=me.fasttm(e,t.value.metatable,me.TMS.TM_INDEX)))return void e.stack[r].setnilvalue()}else(a=me.luaT_gettmbyobj(e,t,me.TMS.TM_INDEX)).ttisnil()&&Ne.luaG_typeerror(e,t,A("index",!0));if(a.ttisfunction())return void me.luaT_callTM(e,a,t,n,e.stack[r],1);t=a}Ne.luaG_runerror(e,A("'__index' chain too long; possible loop",!0))},ut=function(e,t,n,r){for(let a=0;a<2e3;a++){let a;if(t.ttistable()){let u=t.value;if(!Ue.luaH_get(e,u,n).ttisnil()||null===(a=me.fasttm(e,u.metatable,me.TMS.TM_NEWINDEX)))return Ue.luaH_setfrom(e,u,n,r),void Ue.invalidateTMcache(u)}else(a=me.luaT_gettmbyobj(e,t,me.TMS.TM_NEWINDEX)).ttisnil()&&Ne.luaG_typeerror(e,t,A("index",!0));if(a.ttisfunction())return void me.luaT_callTM(e,a,t,n,r,0);t=a}Ne.luaG_runerror(e,A("'__newindex' chain too long; possible loop",!0))};e.exports.cvt2str=Qe,e.exports.cvt2num=$e,e.exports.luaV_gettable=at,e.exports.luaV_concat=rt,e.exports.luaV_div=Ye,e.exports.luaV_equalobj=De,e.exports.luaV_execute=function(e){let t=e.ci;t.callstatus|=be.CIST_FRESH;e:for(;;){Ae(t===e.ci);let n=t.func.value,l=n.p.k,s=t.l_base,o=t.l_code[t.l_savedpc++];e.hookmask&(r|a)&&Ne.luaG_traceexec(e);let i=Re(0,s,o);switch(o.opcode){case Y:xe.setobjs2s(e,i,Se(0,s,o));break;case F:{let t=l[o.Bx];xe.setobj2s(e,i,t);break}case j:{Ae(t.l_code[t.l_savedpc].opcode===w);let n=l[t.l_code[t.l_savedpc++].Ax];xe.setobj2s(e,i,n);break}case K:e.stack[i].setbvalue(0!==o.B),0!==o.C&&t.l_savedpc++;break;case H:for(let t=0;t<=o.B;t++)e.stack[i+t].setnilvalue();break;case C:{let t=o.B;xe.setobj2s(e,i,n.upvals[t]);break}case P:{let t=n.upvals[o.B],r=Ie(e,s,l,o);at(e,t,r,i);break}case M:{let t=e.stack[Se(0,s,o)],n=Ie(e,s,l,o);at(e,t,n,i);break}case ne:{let t=n.upvals[o.A],r=we(e,s,l,o),a=Ie(e,s,l,o);ut(e,t,r,a);break}case re:n.upvals[o.B].setfrom(e.stack[i]);break;case te:{let t=e.stack[i],n=we(e,s,l,o),r=Ie(e,s,l,o);ut(e,t,n,r);break}case Z:e.stack[i].sethvalue(Ue.luaH_new(e));break;case $:{let t=Se(0,s,o),n=Ie(e,s,l,o);xe.setobjs2s(e,i+1,t),at(e,e.stack[t],n,i);break}case b:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);r.ttisinteger()&&a.ttisinteger()?e.stack[i].setivalue(r.value+a.value|0):!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(t+n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_ADD);break}case le:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);r.ttisinteger()&&a.ttisinteger()?e.stack[i].setivalue(r.value-a.value|0):!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(t-n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_SUB);break}case q:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);r.ttisinteger()&&a.ttisinteger()?e.stack[i].setivalue(ze(r.value,a.value)):!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(t*n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_MUL);break}case z:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);r.ttisinteger()&&a.ttisinteger()?e.stack[i].setivalue(qe(e,r.value,a.value)):!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(ge(e,t,n)):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_MOD);break}case W:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(Math.pow(t,n)):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_POW);break}case R:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(t/n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_DIV);break}case D:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);r.ttisinteger()&&a.ttisinteger()?e.stack[i].setivalue(Ye(e,r.value,a.value)):!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(Math.floor(t/n)):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_IDIV);break}case O:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);!1!==(t=Ge(r))&&!1!==(n=Ge(a))?e.stack[i].setivalue(t&n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_BAND);break}case v:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);!1!==(t=Ge(r))&&!1!==(n=Ge(a))?e.stack[i].setivalue(t|n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_BOR);break}case E:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);!1!==(t=Ge(r))&&!1!==(n=Ge(a))?e.stack[i].setivalue(t^n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_BXOR);break}case ae:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);!1!==(t=Ge(r))&&!1!==(n=Ge(a))?e.stack[i].setivalue(Ze(t,n)):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_SHL);break}case ue:{let t,n,r=we(e,s,l,o),a=Ie(e,s,l,o);!1!==(t=Ge(r))&&!1!==(n=Ge(a))?e.stack[i].setivalue(Ze(t,-n)):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_SHR);break}case fe:{let t,n=e.stack[Se(0,s,o)];n.ttisinteger()?e.stack[i].setivalue(0|-n.value):!1!==(t=Ke(n))?e.stack[i].setfltvalue(-t):me.luaT_trybinTM(e,n,n,e.stack[i],me.TMS.TM_UNM);break}case k:{let t=e.stack[Se(0,s,o)];t.ttisinteger()?e.stack[i].setivalue(~t.value):me.luaT_trybinTM(e,t,t,e.stack[i],me.TMS.TM_BNOT);break}case J:{let t=e.stack[Se(0,s,o)];e.stack[i].setbvalue(t.l_isfalse());break}case G:Xe(e,e.stack[i],e.stack[Se(0,s,o)]);break;case N:{let n=o.B,r=o.C;e.top=s+r+1,rt(e,r-n+1);let a=s+n;xe.setobjs2s(e,i,a),Ee.adjust_top(e,t.top);break}case V:ye(e,t,o,0);break;case S:De(e,we(e,s,l,o),Ie(e,s,l,o))!==o.A?t.l_savedpc++:Me(e,t);break;case X:Pe(e,we(e,s,l,o),Ie(e,s,l,o))!==o.A?t.l_savedpc++:Me(e,t);break;case B:Ce(e,we(e,s,l,o),Ie(e,s,l,o))!==o.A?t.l_savedpc++:Me(e,t);break;case oe:(o.C?e.stack[i].l_isfalse():!e.stack[i].l_isfalse())?t.l_savedpc++:Me(e,t);break;case ie:{let n=Se(0,s,o),r=e.stack[n];(o.C?r.l_isfalse():!r.l_isfalse())?t.l_savedpc++:(xe.setobjs2s(e,i,n),Me(e,t));break}case m:{let n=o.B,r=o.C-1;if(0!==n&&Ee.adjust_top(e,i+n),!Ee.luaD_precall(e,i,r)){t=e.ci;continue e}r>=0&&Ee.adjust_top(e,t.top);break}case se:{let r=o.B;if(0!==r&&Ee.adjust_top(e,i+r),!Ee.luaD_precall(e,i,u)){let r=e.ci,a=r.previous,u=r.func,l=r.funcOff,s=a.funcOff,o=r.l_base+u.value.p.numparams;n.p.p.length>0&&Te.luaF_close(e,a.l_base);for(let t=0;l+t<o;t++)xe.setobjs2s(e,s+t,l+t);a.l_base=s+(r.l_base-l),a.top=s+(e.top-l),Ee.adjust_top(e,a.top),a.l_code=r.l_code,a.l_savedpc=r.l_savedpc,a.callstatus|=be.CIST_TAIL,a.next=null,t=e.ci=a,Ae(e.top===a.l_base+e.stack[s].value.p.maxstacksize);continue e}break}case Q:{n.p.p.length>0&&Te.luaF_close(e,s);let r=Ee.luaD_poscall(e,t,i,0!==o.B?o.B-1:e.top-i);if(t.callstatus&be.CIST_FRESH)return;t=e.ci,r&&Ee.adjust_top(e,t.top),Ae(t.callstatus&be.CIST_LUA),Ae(t.l_code[t.l_savedpc-1].opcode===m);continue e}case I:if(e.stack[i].ttisinteger()){let n=e.stack[i+2].value,r=e.stack[i].value+n|0,a=e.stack[i+1].value;(0<n?r<=a:a<=r)&&(t.l_savedpc+=o.sBx,e.stack[i].chgivalue(r),e.stack[i+3].setivalue(r))}else{let n=e.stack[i+2].value,r=e.stack[i].value+n,a=e.stack[i+1].value;(0<n?r<=a:a<=r)&&(t.l_savedpc+=o.sBx,e.stack[i].chgfltvalue(r),e.stack[i+3].setfltvalue(r))}break;case y:{let n,r=e.stack[i],a=e.stack[i+1],u=e.stack[i+2];if(r.ttisinteger()&&u.ttisinteger()&&(n=Ve(a,u.value))){let e=n.stopnow?0:r.value;a.value=n.ilimit,r.value=e-u.value|0}else{let t,n,l;!1===(t=Ke(a))&&Ne.luaG_runerror(e,A("'for' limit must be a number",!0)),e.stack[i+1].setfltvalue(t),!1===(n=Ke(u))&&Ne.luaG_runerror(e,A("'for' step must be a number",!0)),e.stack[i+2].setfltvalue(n),!1===(l=Ke(r))&&Ne.luaG_runerror(e,A("'for' initial value must be a number",!0)),e.stack[i].setfltvalue(l-n)}t.l_savedpc+=o.sBx;break}case ce:{let n=i+3;xe.setobjs2s(e,n+2,i+2),xe.setobjs2s(e,n+1,i+1),xe.setobjs2s(e,n,i),Ee.adjust_top(e,n+3),Ee.luaD_call(e,n,o.C),Ee.adjust_top(e,t.top),o=t.l_code[t.l_savedpc++],i=Re(0,s,o),Ae(o.opcode===_e)}case _e:e.stack[i+1].ttisnil()||(xe.setobjs2s(e,i,i+1),t.l_savedpc+=o.sBx);break;case ee:{let n=o.B,r=o.C;0===n&&(n=e.top-i-1),0===r&&(Ae(t.l_code[t.l_savedpc].opcode===w),r=t.l_code[t.l_savedpc++].Ax);let a=e.stack[i].value,u=(r-1)*T+n;for(;n>0;n--)Ue.luaH_setint(a,u--,e.stack[i+n]);Ee.adjust_top(e,t.top);break}case U:{let t=n.p.p[o.Bx],r=Je(t,n.upvals,e.stack,s);null===r?We(e,t,n.upvals,s,i):e.stack[i].setclLvalue(r);break}case pe:{let r,a=o.B-1,u=s-t.funcOff-n.p.numparams-1;for(u<0&&(u=0),a<0&&(a=u,Ee.luaD_checkstack(e,u),Ee.adjust_top(e,i+u)),r=0;r<a&&r<u;r++)xe.setobjs2s(e,i+r,s-u+r);for(;r<a;r++)e.stack[i+r].setnilvalue();break}case w:throw Error("invalid opcode")}}},e.exports.luaV_finishOp=function(e){let t=e.ci,n=t.l_base,r=t.l_code[t.l_savedpc-1],a=r.opcode;switch(a){case b:case le:case q:case R:case D:case O:case v:case E:case ae:case ue:case z:case W:case fe:case k:case G:case P:case M:case $:xe.setobjs2s(e,n+r.A,e.top-1),delete e.stack[--e.top];break;case B:case X:case S:{let n=!e.stack[e.top-1].l_isfalse();delete e.stack[--e.top],t.callstatus&be.CIST_LEQ&&(Ae(a===B),t.callstatus^=be.CIST_LEQ,n=!n),Ae(t.l_code[t.l_savedpc].opcode===V),n!==!!r.A&&t.l_savedpc++;break}case N:{let a=e.top-1,u=a-1-(n+r.B);xe.setobjs2s(e,a-2,a),u>1&&(e.top=a-1,rt(e,u)),xe.setobjs2s(e,t.l_base+r.A,e.top-1),Ee.adjust_top(e,t.top);break}case ce:Ae(t.l_code[t.l_savedpc].opcode===_e),Ee.adjust_top(e,t.top);break;case m:r.C-1>=0&&Ee.adjust_top(e,t.top)}},e.exports.luaV_imul=ze,e.exports.luaV_lessequal=Ce,e.exports.luaV_lessthan=Pe,e.exports.luaV_mod=qe,e.exports.luaV_objlen=Xe,e.exports.luaV_rawequalobj=function(e,t){return De(null,e,t)},e.exports.luaV_shiftl=Ze,e.exports.luaV_tointeger=Be,e.exports.settable=ut,e.exports.tointeger=Ge,e.exports.tonumber=Ke},function(e,t,n){"use strict";const r=[96,113,65,84,80,80,92,108,60,16,60,84,108,124,124,124,124,124,124,124,124,124,124,124,124,96,96,96,96,104,34,188,188,188,132,228,84,84,16,98,98,4,98,20,81,80,23],a=function(e,t){return~(-1<<e)<<t},u=function(e,t){return~a(e,t)},l=function(e,t,n,r){return e.code=e.code&u(r,n)|t<<n&a(r,n),o(e)},s=function(e,t){return l(e,t,14,18)},o=function(e){if("number"==typeof e)return{code:e,opcode:e>>0&a(6,0),A:e>>6&a(8,0),B:e>>23&a(9,0),C:e>>14&a(9,0),Bx:e>>14&a(18,0),Ax:e>>6&a(26,0),sBx:(e>>14&a(18,0))-131071};{let t=e.code;return e.opcode=t>>0&a(6,0),e.A=t>>6&a(8,0),e.B=t>>23&a(9,0),e.C=t>>14&a(9,0),e.Bx=t>>14&a(18,0),e.Ax=t>>6&a(26,0),e.sBx=(t>>14&a(18,0))-131071,e}};e.exports.BITRK=256,e.exports.CREATE_ABC=function(e,t,n,r){return o(e<<0|t<<6|n<<23|r<<14)},e.exports.CREATE_ABx=function(e,t,n){return o(e<<0|t<<6|n<<14)},e.exports.CREATE_Ax=function(e,t){return o(e<<0|t<<6)},e.exports.GET_OPCODE=function(e){return e.opcode},e.exports.GETARG_A=function(e){return e.A},e.exports.GETARG_B=function(e){return e.B},e.exports.GETARG_C=function(e){return e.C},e.exports.GETARG_Bx=function(e){return e.Bx},e.exports.GETARG_Ax=function(e){return e.Ax},e.exports.GETARG_sBx=function(e){return e.sBx},e.exports.INDEXK=function(e){return-257&e},e.exports.ISK=function(e){return 256&e},e.exports.LFIELDS_PER_FLUSH=50,e.exports.MAXARG_A=255,e.exports.MAXARG_Ax=67108863,e.exports.MAXARG_B=511,e.exports.MAXARG_Bx=262143,e.exports.MAXARG_C=511,e.exports.MAXARG_sBx=131071,e.exports.MAXINDEXRK=255,e.exports.NO_REG=255,e.exports.OpArgK=3,e.exports.OpArgN=0,e.exports.OpArgR=2,e.exports.OpArgU=1,e.exports.OpCodes=["MOVE","LOADK","LOADKX","LOADBOOL","LOADNIL","GETUPVAL","GETTABUP","GETTABLE","SETTABUP","SETUPVAL","SETTABLE","NEWTABLE","SELF","ADD","SUB","MUL","MOD","POW","DIV","IDIV","BAND","BOR","BXOR","SHL","SHR","UNM","BNOT","NOT","LEN","CONCAT","JMP","EQ","LT","LE","TEST","TESTSET","CALL","TAILCALL","RETURN","FORLOOP","FORPREP","TFORCALL","TFORLOOP","SETLIST","CLOSURE","VARARG","EXTRAARG"],e.exports.OpCodesI={OP_MOVE:0,OP_LOADK:1,OP_LOADKX:2,OP_LOADBOOL:3,OP_LOADNIL:4,OP_GETUPVAL:5,OP_GETTABUP:6,OP_GETTABLE:7,OP_SETTABUP:8,OP_SETUPVAL:9,OP_SETTABLE:10,OP_NEWTABLE:11,OP_SELF:12,OP_ADD:13,OP_SUB:14,OP_MUL:15,OP_MOD:16,OP_POW:17,OP_DIV:18,OP_IDIV:19,OP_BAND:20,OP_BOR:21,OP_BXOR:22,OP_SHL:23,OP_SHR:24,OP_UNM:25,OP_BNOT:26,OP_NOT:27,OP_LEN:28,OP_CONCAT:29,OP_JMP:30,OP_EQ:31,OP_LT:32,OP_LE:33,OP_TEST:34,OP_TESTSET:35,OP_CALL:36,OP_TAILCALL:37,OP_RETURN:38,OP_FORLOOP:39,OP_FORPREP:40,OP_TFORCALL:41,OP_TFORLOOP:42,OP_SETLIST:43,OP_CLOSURE:44,OP_VARARG:45,OP_EXTRAARG:46},e.exports.POS_A=6,e.exports.POS_Ax=6,e.exports.POS_B=23,e.exports.POS_Bx=14,e.exports.POS_C=14,e.exports.POS_OP=0,e.exports.RKASK=function(e){return 256|e},e.exports.SETARG_A=function(e,t){return l(e,t,6,8)},e.exports.SETARG_Ax=function(e,t){return l(e,t,6,26)},e.exports.SETARG_B=function(e,t){return l(e,t,23,9)},e.exports.SETARG_Bx=s,e.exports.SETARG_C=function(e,t){return l(e,t,14,9)},e.exports.SETARG_sBx=function(e,t){return s(e,t+131071)},e.exports.SET_OPCODE=function(e,t){return e.code=e.code&u(6,0)|t<<0&a(6,0),o(e)},e.exports.SIZE_A=8,e.exports.SIZE_Ax=26,e.exports.SIZE_B=9,e.exports.SIZE_Bx=18,e.exports.SIZE_C=9,e.exports.SIZE_OP=6,e.exports.fullins=o,e.exports.getBMode=function(e){return r[e]>>4&3},e.exports.getCMode=function(e){return r[e]>>2&3},e.exports.getOpMode=function(e){return 3&r[e]},e.exports.iABC=0,e.exports.iABx=1,e.exports.iAsBx=2,e.exports.iAx=3,e.exports.testAMode=function(e){return 64&r[e]},e.exports.testTMode=function(e){return 128&r[e]}},function(e,t,n){"use strict";const{LUA_VERSION_MAJOR:r,LUA_VERSION_MINOR:a}=n(2),u="_"+r+"_"+a;e.exports.LUA_VERSUFFIX=u,e.exports.lua_assert=function(e){},e.exports.luaopen_base=n(24).luaopen_base,e.exports.LUA_COLIBNAME="coroutine",e.exports.luaopen_coroutine=n(25).luaopen_coroutine,e.exports.LUA_TABLIBNAME="table",e.exports.luaopen_table=n(26).luaopen_table,e.exports.LUA_OSLIBNAME="os",e.exports.luaopen_os=n(27).luaopen_os,e.exports.LUA_STRLIBNAME="string",e.exports.luaopen_string=n(28).luaopen_string,e.exports.LUA_UTF8LIBNAME="utf8",e.exports.luaopen_utf8=n(29).luaopen_utf8,e.exports.LUA_BITLIBNAME="bit32",e.exports.LUA_MATHLIBNAME="math",e.exports.luaopen_math=n(30).luaopen_math,e.exports.LUA_DBLIBNAME="debug",e.exports.luaopen_debug=n(31).luaopen_debug,e.exports.LUA_LOADLIBNAME="package",e.exports.luaopen_package=n(32).luaopen_package,e.exports.LUA_FENGARILIBNAME="fengari",e.exports.luaopen_fengari=n(33).luaopen_fengari;const l=n(39);e.exports.luaL_openlibs=l.luaL_openlibs},function(e,t,n){"use strict";const{LUA_MULTRET:r,LUA_OPBNOT:a,LUA_OPEQ:u,LUA_OPLE:l,LUA_OPLT:s,LUA_OPUNM:o,LUA_REGISTRYINDEX:i,LUA_RIDX_GLOBALS:c,LUA_VERSION_NUM:_,constant_types:{LUA_NUMTAGS:f,LUA_TBOOLEAN:p,LUA_TCCL:L,LUA_TFUNCTION:h,LUA_TLCF:d,LUA_TLCL:A,LUA_TLIGHTUSERDATA:g,LUA_TLNGSTR:x,LUA_TNIL:T,LUA_TNONE:b,LUA_TNUMFLT:O,LUA_TNUMINT:k,LUA_TSHRSTR:v,LUA_TTABLE:E,LUA_TTHREAD:m,LUA_TUSERDATA:U},thread_status:{LUA_OK:N},from_userstring:R,to_luastring:S}=n(1),{api_check:w}=n(4),I=n(11),y=n(8),{luaU_dump:M}=n(37),P=n(13),C=n(6),D=n(12),{luaS_bless:V,luaS_new:B,luaS_newliteral:G}=n(10),K=n(14),{LUAI_MAXSTACK:F}=n(3),j=n(15),H=n(9),{ZIO:X}=n(19),z=C.TValue,Y=C.CClosure,q=function(e){e.top++,w(e,e.top<=e.ci.top,"stack overflow")},Z=function(e,t){w(e,t<e.top-e.ci.funcOff,"not enough elements in the stack")},J=function(e){if(!e)throw TypeError("invalid argument")},W=function(e){J("number"==typeof e&&(0|e)===e)},Q=function(e){return e!==C.luaO_nilobject},$=function(e,t){let n=e.ci;if(t>0){let r=n.funcOff+t;return w(e,t<=n.top-(n.funcOff+1),"unacceptable index"),r>=e.top?C.luaO_nilobject:e.stack[r]}return t>i?(w(e,0!==t&&-t<=e.top,"invalid index"),e.stack[e.top+t]):t===i?e.l_G.l_registry:(w(e,(t=i-t)<=P.MAXUPVAL+1,"upvalue index too large"),n.func.ttislcf()?C.luaO_nilobject:t<=n.func.value.nupvalues?n.func.value.upvalue[t-1]:C.luaO_nilobject)},ee=function(e,t){let n=e.ci;if(t>0){let r=n.funcOff+t;return w(e,t<=n.top-(n.funcOff+1),"unacceptable index"),r>=e.top?null:r}if(t>i)return w(e,0!==t&&-t<=e.top,"invalid index"),e.top+t;throw Error("attempt to use pseudo-index")},te=function(e,t){let n,r=e.ci.funcOff;t>=0?(w(e,t<=e.stack_last-(r+1),"new top too large"),n=r+1+t):(w(e,-(t+1)<=e.top-(r+1),"invalid new top"),n=e.top+t+1),y.adjust_top(e,n)},ne=function(e,t){te(e,-t-1)},re=function(e,t,n){for(;t<n;t++,n--){let r=e.stack[t],a=new z(r.type,r.value);C.setobjs2s(e,t,n),C.setobj2s(e,n,a)}},ae=function(e,t,n){let r=e.top-1,a=ee(e,t),u=e.stack[a];w(e,Q(u)&&t>i,"index not in the stack"),w(e,(n>=0?n:-n)<=r-a+1,"invalid 'n'");let l=n>=0?r-n:a-n-1;re(e,a,l),re(e,l+1,e.top-1),re(e,a,e.top-1)},ue=function(e,t,n){let r=$(e,t);$(e,n).setfrom(r)},le=function(e,t,n){if(J("function"==typeof t),W(n),0===n)e.stack[e.top]=new z(d,t);else{Z(e,n),w(e,n<=P.MAXUPVAL,"upvalue index too large");let r=new Y(e,t,n);for(let t=0;t<n;t++)r.upvalue[t].setfrom(e.stack[e.top-n+t]);for(let t=1;t<n;t++)delete e.stack[--e.top];n>0&&--e.top,e.stack[e.top].setclCvalue(r)}q(e)},se=le,oe=function(e,t){le(e,t,0)},ie=oe,ce=function(e,t,n){let r=B(e,R(n));Z(e,1),C.pushsvalue2s(e,r),w(e,e.top<=e.ci.top,"stack overflow"),j.settable(e,t,e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top],delete e.stack[--e.top]},_e=function(e,t){ce(e,H.luaH_getint(e.l_G.l_registry.value,c),t)},fe=function(e,t,n){let r=B(e,R(n));return C.pushsvalue2s(e,r),w(e,e.top<=e.ci.top,"stack overflow"),j.luaV_gettable(e,t,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},pe=function(e,t,n){let r=$(e,t);return W(n),w(e,r.ttistable(),"table expected"),C.pushobj2s(e,H.luaH_getint(r.value,n)),w(e,e.top<=e.ci.top,"stack overflow"),e.stack[e.top-1].ttnov()},Le=function(e,t,n){let r=new C.TValue(E,H.luaH_new(e));e.stack[e.top]=r,q(e)},he=function(e,t,n){switch(W(n),t.ttype()){case L:{let e=t.value;return 1<=n&&n<=e.nupvalues?{name:S("",!0),val:e.upvalue[n-1]}:null}case A:{let e=t.value,r=e.p;if(!(1<=n&&n<=r.upvalues.length))return null;let a=r.upvalues[n-1].name;return{name:a?a.getstr():S("(*no name)",!0),val:e.upvals[n-1]}}default:return null}},de=function(e,t){let n=$(e,t);if(!n.ttisstring()){if(!j.cvt2str(n))return null;C.luaO_tostring(e,n)}return n.svalue()},Ae=de,ge=function(e,t){return j.tointeger($(e,t))},xe=function(e,t){return j.tonumber($(e,t))},Te=new WeakMap,be=function(e,t){y.luaD_callnoyield(e,t.funcOff,t.nresults)},Oe=function(e,t){let n=$(e,t);return Q(n)?n.ttnov():b},ke=S("?"),ve=function(e,t,n){w(e,n===r||e.ci.top-e.top>=n-t,"results from function overflow current stack size")},Ee=function(e,t,n,a,u){w(e,null===u||!(e.ci.callstatus&D.CIST_LUA),"cannot use continuations inside hooks"),Z(e,t+1),w(e,e.status===N,"cannot do calls on non-normal thread"),ve(e,t,n);let l=e.top-(t+1);null!==u&&0===e.nny?(e.ci.c_k=u,e.ci.c_ctx=a,y.luaD_call(e,l,n)):y.luaD_callnoyield(e,l,n),n===r&&e.ci.top<e.top&&(e.ci.top=e.top)},me=function(e,t,n,a,u,l){let s,o;w(e,null===l||!(e.ci.callstatus&D.CIST_LUA),"cannot use continuations inside hooks"),Z(e,t+1),w(e,e.status===N,"cannot do calls on non-normal thread"),ve(e,t,n),o=0===a?0:ee(e,a);let i=e.top-(t+1);if(null===l||e.nny>0){let t={funcOff:i,nresults:n};s=y.luaD_pcall(e,be,t,i,o)}else{let t=e.ci;t.c_k=l,t.c_ctx=u,t.extra=i,t.c_old_errfunc=e.errfunc,e.errfunc=o,t.callstatus&=~D.CIST_OAH|e.allowhook,t.callstatus|=D.CIST_YPCALL,y.luaD_call(e,i,n),t.callstatus&=~D.CIST_YPCALL,e.errfunc=t.c_old_errfunc,s=N}return n===r&&e.ci.top<e.top&&(e.ci.top=e.top),s},Ue=function(e,t,n){let r=$(e,t);w(e,r.ttisLclosure(),"Lua function expected");let a=r.value;return W(n),w(e,1<=n&&n<=a.p.upvalues.length,"invalid upvalue index"),{f:a,i:n-1}};e.exports.api_incr_top=q,e.exports.api_checknelems=Z,e.exports.lua_absindex=function(e,t){return t>0||t<=i?t:e.top-e.ci.funcOff+t},e.exports.lua_arith=function(e,t){t!==o&&t!==a?Z(e,2):(Z(e,1),C.pushobj2s(e,e.stack[e.top-1]),w(e,e.top<=e.ci.top,"stack overflow")),C.luaO_arith(e,t,e.stack[e.top-2],e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top]},e.exports.lua_atpanic=function(e,t){let n=e.l_G.panic;return e.l_G.panic=t,n},e.exports.lua_atnativeerror=function(e,t){let n=e.l_G.atnativeerror;return e.l_G.atnativeerror=t,n},e.exports.lua_call=function(e,t,n){Ee(e,t,n,0,null)},e.exports.lua_callk=Ee,e.exports.lua_checkstack=function(e,t){let n,r=e.ci;return w(e,t>=0,"negative 'n'"),e.stack_last-e.top>t?n=!0:e.top+D.EXTRA_STACK>F-t?n=!1:(y.luaD_growstack(e,t),n=!0),n&&r.top<e.top+t&&(r.top=e.top+t),n},e.exports.lua_compare=function(e,t,n,r){let a=$(e,t),o=$(e,n),i=0;if(Q(a)&&Q(o))switch(r){case u:i=j.luaV_equalobj(e,a,o);break;case s:i=j.luaV_lessthan(e,a,o);break;case l:i=j.luaV_lessequal(e,a,o);break;default:w(e,!1,"invalid option")}return i},e.exports.lua_concat=function(e,t){Z(e,t),t>=2?j.luaV_concat(e,t):0===t&&(C.pushsvalue2s(e,V(e,S("",!0))),w(e,e.top<=e.ci.top,"stack overflow"))},e.exports.lua_copy=ue,e.exports.lua_createtable=Le,e.exports.lua_dump=function(e,t,n,r){Z(e,1);let a=e.stack[e.top-1];return a.ttisLclosure()?M(e,a.value.p,t,n,r):1},e.exports.lua_error=function(e){Z(e,1),I.luaG_errormsg(e)},e.exports.lua_gc=function(){},e.exports.lua_getallocf=function(){return console.warn("lua_getallocf is not available"),0},e.exports.lua_getextraspace=function(){return console.warn("lua_getextraspace is not available"),0},e.exports.lua_getfield=function(e,t,n){return fe(e,$(e,t),n)},e.exports.lua_getglobal=function(e,t){return fe(e,H.luaH_getint(e.l_G.l_registry.value,c),t)},e.exports.lua_geti=function(e,t,n){let r=$(e,t);return W(n),e.stack[e.top]=new z(k,n),q(e),j.luaV_gettable(e,r,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},e.exports.lua_getmetatable=function(e,t){let n,r=$(e,t),a=!1;switch(r.ttnov()){case E:case U:n=r.value.metatable;break;default:n=e.l_G.mt[r.ttnov()]}return null!=n&&(e.stack[e.top]=new z(E,n),q(e),a=!0),a},e.exports.lua_gettable=function(e,t){let n=$(e,t);return j.luaV_gettable(e,n,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},e.exports.lua_gettop=function(e){return e.top-(e.ci.funcOff+1)},e.exports.lua_getupvalue=function(e,t,n){let r=he(0,$(e,t),n);if(r){let t=r.name,n=r.val;return C.pushobj2s(e,n),w(e,e.top<=e.ci.top,"stack overflow"),t}return null},e.exports.lua_getuservalue=function(e,t){let n=$(e,t);w(e,n.ttisfulluserdata(),"full userdata expected");let r=n.value.uservalue;return e.stack[e.top]=new z(r.type,r.value),q(e),e.stack[e.top-1].ttnov()},e.exports.lua_insert=function(e,t){ae(e,t,1)},e.exports.lua_isboolean=function(e,t){return Oe(e,t)===p},e.exports.lua_iscfunction=function(e,t){let n=$(e,t);return n.ttislcf(n)||n.ttisCclosure()},e.exports.lua_isfunction=function(e,t){return Oe(e,t)===h},e.exports.lua_isinteger=function(e,t){return $(e,t).ttisinteger()},e.exports.lua_islightuserdata=function(e,t){return Oe(e,t)===g},e.exports.lua_isnil=function(e,t){return Oe(e,t)===T},e.exports.lua_isnone=function(e,t){return Oe(e,t)===b},e.exports.lua_isnoneornil=function(e,t){return Oe(e,t)<=0},e.exports.lua_isnumber=function(e,t){return!1!==j.tonumber($(e,t))},e.exports.lua_isproxy=function(e,t){let n=Te.get(e);return!!n&&(null===t||t.l_G===n)},e.exports.lua_isstring=function(e,t){let n=$(e,t);return n.ttisstring()||j.cvt2str(n)},e.exports.lua_istable=function(e,t){return $(e,t).ttistable()},e.exports.lua_isthread=function(e,t){return Oe(e,t)===m},e.exports.lua_isuserdata=function(e,t){let n=$(e,t);return n.ttisfulluserdata(n)||n.ttislightuserdata()},e.exports.lua_len=function(e,t){let n=$(e,t),r=new z;j.luaV_objlen(e,r,n),e.stack[e.top]=r,q(e)},e.exports.lua_load=function(e,t,n,r,a){r=r?R(r):ke,null!==a&&(a=R(a));let u=new X(e,t,n),l=y.luaD_protectedparser(e,u,r,a);if(l===N){let t=e.stack[e.top-1].value;if(t.nupvalues>=1){let n=H.luaH_getint(e.l_G.l_registry.value,c);t.upvals[0].setfrom(n)}}return l},e.exports.lua_newtable=function(e){Le(e)},e.exports.lua_newuserdata=function(e,t){let n=function(e,t){return new C.Udata(e,t)}(e,t);return e.stack[e.top]=new C.TValue(U,n),q(e),n.data},e.exports.lua_next=function(e,t){let n=$(e,t);return w(e,n.ttistable(),"table expected"),e.stack[e.top]=new z,H.luaH_next(e,n.value,e.top-1)?(q(e),1):(delete e.stack[e.top],delete e.stack[--e.top],0)},e.exports.lua_pcall=function(e,t,n,r){return me(e,t,n,r,0,null)},e.exports.lua_pcallk=me,e.exports.lua_pop=ne,e.exports.lua_pushboolean=function(e,t){e.stack[e.top]=new z(p,!!t),q(e)},e.exports.lua_pushcclosure=le,e.exports.lua_pushcfunction=oe,e.exports.lua_pushfstring=function(e,t,...n){return t=R(t),C.luaO_pushvfstring(e,t,n)},e.exports.lua_pushglobaltable=function(e){pe(e,i,c)},e.exports.lua_pushinteger=function(e,t){W(t),e.stack[e.top]=new z(k,t),q(e)},e.exports.lua_pushjsclosure=se,e.exports.lua_pushjsfunction=ie,e.exports.lua_pushlightuserdata=function(e,t){e.stack[e.top]=new z(g,t),q(e)},e.exports.lua_pushliteral=function(e,t){if(null==t)e.stack[e.top]=new z(T,null),e.top++;else{J("string"==typeof t);let n=G(e,t);C.pushsvalue2s(e,n),t=n.getstr()}return w(e,e.top<=e.ci.top,"stack overflow"),t},e.exports.lua_pushlstring=function(e,t,n){let r;return W(n),0===n?(t=S("",!0),r=V(e,t)):(t=R(t),w(e,t.length>=n,"invalid length to lua_pushlstring"),r=B(e,t.subarray(0,n))),C.pushsvalue2s(e,r),w(e,e.top<=e.ci.top,"stack overflow"),r.value},e.exports.lua_pushnil=function(e){e.stack[e.top]=new z(T,null),q(e)},e.exports.lua_pushnumber=function(e,t){J("number"==typeof t),e.stack[e.top]=new z(O,t),q(e)},e.exports.lua_pushstring=function(e,t){if(null==t)e.stack[e.top]=new z(T,null),e.top++;else{let n=B(e,R(t));C.pushsvalue2s(e,n),t=n.getstr()}return w(e,e.top<=e.ci.top,"stack overflow"),t},e.exports.lua_pushthread=function(e){return e.stack[e.top]=new z(m,e),q(e),e.l_G.mainthread===e},e.exports.lua_pushvalue=function(e,t){C.pushobj2s(e,$(e,t)),w(e,e.top<=e.ci.top,"stack overflow")},e.exports.lua_pushvfstring=function(e,t,n){return t=R(t),C.luaO_pushvfstring(e,t,n)},e.exports.lua_rawequal=function(e,t,n){let r=$(e,t),a=$(e,n);return Q(r)&&Q(a)?j.luaV_equalobj(null,r,a):0},e.exports.lua_rawget=function(e,t){let n=$(e,t);return w(e,n.ttistable(n),"table expected"),C.setobj2s(e,e.top-1,H.luaH_get(e,n.value,e.stack[e.top-1])),e.stack[e.top-1].ttnov()},e.exports.lua_rawgeti=pe,e.exports.lua_rawgetp=function(e,t,n){let r=$(e,t);w(e,r.ttistable(),"table expected");let a=new z(g,n);return C.pushobj2s(e,H.luaH_get(e,r.value,a)),w(e,e.top<=e.ci.top,"stack overflow"),e.stack[e.top-1].ttnov()},e.exports.lua_rawlen=function(e,t){let n=$(e,t);switch(n.ttype()){case v:case x:return n.vslen();case U:return n.value.len;case E:return H.luaH_getn(n.value);default:return 0}},e.exports.lua_rawset=function(e,t){Z(e,2);let n=$(e,t);w(e,n.ttistable(),"table expected");let r=e.stack[e.top-2],a=e.stack[e.top-1];H.luaH_setfrom(e,n.value,r,a),H.invalidateTMcache(n.value),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_rawseti=function(e,t,n){W(n),Z(e,1);let r=$(e,t);w(e,r.ttistable(),"table expected"),H.luaH_setint(r.value,n,e.stack[e.top-1]),delete e.stack[--e.top]},e.exports.lua_rawsetp=function(e,t,n){Z(e,1);let r=$(e,t);w(e,r.ttistable(),"table expected");let a=new z(g,n),u=e.stack[e.top-1];H.luaH_setfrom(e,r.value,a,u),delete e.stack[--e.top]},e.exports.lua_register=function(e,t,n){oe(e,n),_e(e,t)},e.exports.lua_remove=function(e,t){ae(e,t,-1),ne(e,1)},e.exports.lua_replace=function(e,t){ue(e,-1,t),ne(e,1)},e.exports.lua_rotate=ae,e.exports.lua_setallocf=function(){return console.warn("lua_setallocf is not available"),0},e.exports.lua_setfield=function(e,t,n){ce(e,$(e,t),n)},e.exports.lua_setglobal=_e,e.exports.lua_seti=function(e,t,n){W(n),Z(e,1);let r=$(e,t);e.stack[e.top]=new z(k,n),q(e),j.settable(e,r,e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_setmetatable=function(e,t){let n;Z(e,1);let r=$(e,t);switch(e.stack[e.top-1].ttisnil()?n=null:(w(e,e.stack[e.top-1].ttistable(),"table expected"),n=e.stack[e.top-1].value),r.ttnov()){case U:case E:r.value.metatable=n;break;default:e.l_G.mt[r.ttnov()]=n}return delete e.stack[--e.top],!0},e.exports.lua_settable=function(e,t){Z(e,2);let n=$(e,t);j.settable(e,n,e.stack[e.top-2],e.stack[e.top-1]),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_settop=te,e.exports.lua_setupvalue=function(e,t,n){let r=$(e,t);Z(e,1);let a=he(0,r,n);if(a){let t=a.name;return a.val.setfrom(e.stack[e.top-1]),delete e.stack[--e.top],t}return null},e.exports.lua_setuservalue=function(e,t){Z(e,1);let n=$(e,t);w(e,n.ttisfulluserdata(),"full userdata expected"),n.value.uservalue.setfrom(e.stack[e.top-1]),delete e.stack[--e.top]},e.exports.lua_status=function(e){return e.status},e.exports.lua_stringtonumber=function(e,t){let n=new z,r=C.luaO_str2num(t,n);return 0!==r&&(e.stack[e.top]=n,q(e)),r},e.exports.lua_toboolean=function(e,t){return!$(e,t).l_isfalse()},e.exports.lua_tocfunction=function(e,t){let n=$(e,t);return n.ttislcf()||n.ttisCclosure()?n.value:null},e.exports.lua_todataview=function(e,t){let n=de(e,t);return new DataView(n.buffer,n.byteOffset,n.byteLength)},e.exports.lua_tointeger=function(e,t){let n=ge(e,t);return!1===n?0:n},e.exports.lua_tointegerx=ge,e.exports.lua_tojsstring=function(e,t){let n=$(e,t);if(!n.ttisstring()){if(!j.cvt2str(n))return null;C.luaO_tostring(e,n)}return n.jsstring()},e.exports.lua_tolstring=de,e.exports.lua_tonumber=function(e,t){let n=xe(e,t);return!1===n?0:n},e.exports.lua_tonumberx=xe,e.exports.lua_topointer=function(e,t){let n=$(e,t);switch(n.ttype()){case E:case A:case L:case d:case m:case U:case g:return n.value;default:return null}},e.exports.lua_toproxy=function(e,t){let n=$(e,t);return function(e,t,n){let r=function(r){w(r,r instanceof D.lua_State&&e===r.l_G,"must be from same global state"),r.stack[r.top]=new z(t,n),q(r)};return Te.set(r,e),r}(e.l_G,n.type,n.value)},e.exports.lua_tostring=Ae,e.exports.lua_tothread=function(e,t){let n=$(e,t);return n.ttisthread()?n.value:null},e.exports.lua_touserdata=function(e,t){let n=$(e,t);switch(n.ttnov()){case U:return n.value.data;case g:return n.value;default:return null}},e.exports.lua_type=Oe,e.exports.lua_typename=function(e,t){return w(e,b<=t&&t<f,"invalid tag"),K.ttypename(t)},e.exports.lua_upvalueid=function(e,t,n){let r=$(e,t);switch(r.ttype()){case A:{let r=Ue(e,t,n);return r.f.upvals[r.i]}case L:{let t=r.value;return w(e,(0|n)===n&&n>0&&n<=t.nupvalues,"invalid upvalue index"),t.upvalue[n-1]}default:return w(e,!1,"closure expected"),null}},e.exports.lua_upvaluejoin=function(e,t,n,r,a){let u=Ue(e,t,n),l=Ue(e,r,a),s=l.f.upvals[l.i];u.f.upvals[u.i]=s},e.exports.lua_version=function(e){return null===e?_:e.l_G.version},e.exports.lua_xmove=function(e,t,n){if(e!==t){Z(e,n),w(e,e.l_G===t.l_G,"moving among independent states"),w(e,t.ci.top-t.top>=n,"stack overflow"),e.top-=n;for(let r=0;r<n;r++)t.stack[t.top]=new C.TValue,C.setobj2s(t,t.top,e.stack[e.top+r]),delete e.stack[e.top+r],t.top++}}},function(e,t,n){"use strict";const{lua_assert:r}=n(4),a=function(e){let t=e.reader(e.L,e.data);if(null===t)return-1;r(t instanceof Uint8Array,"Should only load binary of array of bytes");let n=t.length;return 0===n?-1:(e.buffer=t,e.off=0,e.n=n-1,e.buffer[e.off++])};e.exports.EOZ=-1,e.exports.luaZ_buffer=function(e){return e.buffer.subarray(0,e.n)},e.exports.luaZ_buffremove=function(e,t){e.n-=t},e.exports.luaZ_fill=a,e.exports.luaZ_read=function(e,t,n,r){for(;r;){if(0===e.n){if(-1===a(e))return r;e.n++,e.off--}let u=r<=e.n?r:e.n;for(let r=0;r<u;r++)t[n++]=e.buffer[e.off++];e.n-=u,0===e.n&&(e.buffer=null),r-=u}return 0},e.exports.luaZ_resetbuffer=function(e){e.n=0},e.exports.luaZ_resizebuffer=function(e,t,n){let r=new Uint8Array(n);t.buffer&&r.set(t.buffer),t.buffer=r},e.exports.MBuffer=class{constructor(){this.buffer=null,this.n=0}},e.exports.ZIO=class{constructor(e,t,n){this.L=e,r("function"==typeof t,"ZIO requires a reader"),this.reader=t,this.data=n,this.n=0,this.buffer=null,this.off=0}zgetc(){return this.n-- >0?this.buffer[this.off++]:a(this)}}},function(e,t,n){"use strict";const{constant_types:{LUA_TBOOLEAN:r,LUA_TLNGSTR:a},thread_status:{LUA_ERRSYNTAX:u},to_luastring:l}=n(1),{LUA_MINBUFFER:s,MAX_INT:o,lua_assert:i}=n(4),c=n(11),_=n(8),{lisdigit:f,lislalnum:p,lislalpha:L,lisspace:h,lisxdigit:d}=n(22),A=n(6),{luaS_bless:g,luaS_hash:x,luaS_hashlongstr:T,luaS_new:b}=n(10),O=n(9),{EOZ:k,luaZ_buffer:v,luaZ_buffremove:E,luaZ_resetbuffer:m,luaZ_resizebuffer:U}=n(19),N=l("_ENV",!0),R=["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while","//","..","...","==",">=","<=","~=","<<",">>","::","<eof>","<number>","<integer>","<name>","<string>"].map((e,t)=>l(e));class S{constructor(){this.r=NaN,this.i=NaN,this.ts=null}}class w{constructor(){this.token=NaN,this.seminfo=new S}}const I=function(e,t){let n=e.buff;if(n.n+1>n.buffer.length){n.buffer.length>=o/2&&j(e,l("lexical element too long",!0),0);let t=2*n.buffer.length;U(e.L,n,t)}n.buffer[n.n++]=t<0?255+t+1:t},y=function(e,t){if(t<257)return A.luaO_pushfstring(e.L,l("'%c'",!0),t);{let n=R[t-257];return t<289?A.luaO_pushfstring(e.L,l("'%s'",!0),n):n}},M=function(e){return 10===e.current||13===e.current},P=function(e){e.current=e.z.zgetc()},C=function(e){I(e,e.current),P(e)},D=new A.TValue(r,!0),V=function(e,t){let n=e.L,r=b(n,t),u=e.h.strong.get(T(r));if(u)r=u.key.tsvalue();else{let t=new A.TValue(a,r);O.luaH_setfrom(n,e.h,t,D)}return r},B=function(e){let t=e.current;i(M(e)),P(e),M(e)&&e.current!==t&&P(e),++e.linenumber>=o&&j(e,l("chunk has too many lines",!0),0)},G=function(e,t){return e.current===t&&(P(e),!0)},K=function(e,t){return(e.current===t[0].charCodeAt(0)||e.current===t[1].charCodeAt(0))&&(C(e),!0)},F=function(e,t){let n="Ee",r=e.current;for(i(f(e.current)),C(e),48===r&&K(e,"xX")&&(n="Pp");;)if(K(e,n)&&K(e,"-+"),d(e.current))C(e);else{if(46!==e.current)break;C(e)}let a=new A.TValue;return 0===A.luaO_str2num(v(e.buff),a)&&j(e,l("malformed number",!0),290),a.ttisinteger()?(t.i=a.value,291):(i(a.ttisfloat()),t.r=a.value,290)},j=function(e,t,n){t=c.luaG_addinfo(e.L,t,e.source,e.linenumber),n&&A.luaO_pushfstring(e.L,l("%s near %s"),t,function(e,t){switch(t){case 292:case 293:case 290:case 291:return A.luaO_pushfstring(e.L,l("'%s'",!0),v(e.buff));default:return y(e,t)}}(e,n)),_.luaD_throw(e.L,u)},H=function(e){let t=0,n=e.current;for(i(91===n||93===n),C(e);61===e.current;)C(e),t++;return e.current===n?t:-t-1},X=function(e,t,n){let r=e.linenumber;C(e),M(e)&&B(e);let a=!1;for(;!a;)switch(e.current){case k:j(e,l(`unfinished long ${t?"string":"comment"} (starting at line ${r})`),289);break;case 93:H(e)===n&&(C(e),a=!0);break;case 10:case 13:I(e,10),B(e),t||m(e.buff);break;default:t?C(e):P(e)}t&&(t.ts=V(e,e.buff.buffer.subarray(2+n,e.buff.n-(2+n))))},z=function(e,t,n){t||(e.current!==k&&C(e),j(e,n,293))},Y=function(e){return C(e),z(e,d(e.current),l("hexadecimal digit expected",!0)),A.luaO_hexavalue(e.current)},q=function(e){let t=Y(e);return t=(t<<4)+Y(e),E(e.buff,2),t},Z=function(e){let t=new Uint8Array(A.UTF8BUFFSZ),n=A.luaO_utf8esc(t,function(e){let t=4;C(e),z(e,123===e.current,l("missing '{'",!0));let n=Y(e);for(C(e);d(e.current);)t++,n=(n<<4)+A.luaO_hexavalue(e.current),z(e,n<=1114111,l("UTF-8 value too large",!0)),C(e);return z(e,125===e.current,l("missing '}'",!0)),P(e),E(e.buff,t),n}(e));for(;n>0;n--)I(e,t[A.UTF8BUFFSZ-n])},J=function(e){let t,n=0;for(t=0;t<3&&f(e.current);t++)n=10*n+e.current-48,C(e);return z(e,n<=255,l("decimal escape too large",!0)),E(e.buff,t),n},W=function(e,t,n){for(C(e);e.current!==t;)switch(e.current){case k:j(e,l("unfinished string",!0),289);break;case 10:case 13:j(e,l("unfinished string",!0),293);break;case 92:{let t,n;switch(C(e),e.current){case 97:n=7,t="read_save";break;case 98:n=8,t="read_save";break;case 102:n=12,t="read_save";break;case 110:n=10,t="read_save";break;case 114:n=13,t="read_save";break;case 116:n=9,t="read_save";break;case 118:n=11,t="read_save";break;case 120:n=q(e),t="read_save";break;case 117:Z(e),t="no_save";break;case 10:case 13:B(e),n=10,t="only_save";break;case 92:case 34:case 39:n=e.current,t="read_save";break;case k:t="no_save";break;case 122:for(E(e.buff,1),P(e);h(e.current);)M(e)?B(e):P(e);t="no_save";break;default:z(e,f(e.current),l("invalid escape sequence",!0)),n=J(e),t="only_save"}"read_save"===t&&P(e),"read_save"!==t&&"only_save"!==t||(E(e.buff,1),I(e,n));break}default:C(e)}C(e),n.ts=V(e,e.buff.buffer.subarray(1,e.buff.n-1))},Q=Object.create(null);R.forEach((e,t)=>Q[x(e)]=t);const $=function(e,t){for(m(e.buff);;)switch(i("number"==typeof e.current),e.current){case 10:case 13:B(e);break;case 32:case 12:case 9:case 11:P(e);break;case 45:if(P(e),45!==e.current)return 45;if(P(e),91===e.current){let t=H(e);if(m(e.buff),t>=0){X(e,null,t),m(e.buff);break}}for(;!M(e)&&e.current!==k;)P(e);break;case 91:{let n=H(e);return n>=0?(X(e,t,n),293):(-1!==n&&j(e,l("invalid long string delimiter",!0),293),91)}case 61:return P(e),G(e,61)?282:61;case 60:return P(e),G(e,61)?284:G(e,60)?286:60;case 62:return P(e),G(e,61)?283:G(e,62)?287:62;case 47:return P(e),G(e,47)?279:47;case 126:return P(e),G(e,61)?285:126;case 58:return P(e),G(e,58)?288:58;case 34:case 39:return W(e,e.current,t),293;case 46:return C(e),G(e,46)?G(e,46)?281:280:f(e.current)?F(e,t):46;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return F(e,t);case k:return 289;default:if(L(e.current)){do{C(e)}while(p(e.current));let n=V(e,v(e.buff));t.ts=n;let r=Q[T(n)];return void 0!==r&&r<=22?r+257:292}{let t=e.current;return P(e),t}}};e.exports.FIRST_RESERVED=257,e.exports.LUA_ENV=N,e.exports.LexState=class{constructor(){this.current=NaN,this.linenumber=NaN,this.lastline=NaN,this.t=new w,this.lookahead=new w,this.fs=null,this.L=null,this.z=null,this.buff=null,this.h=null,this.dyd=null,this.source=null,this.envn=null}},e.exports.RESERVED={TK_AND:257,TK_BREAK:258,TK_DO:259,TK_ELSE:260,TK_ELSEIF:261,TK_END:262,TK_FALSE:263,TK_FOR:264,TK_FUNCTION:265,TK_GOTO:266,TK_IF:267,TK_IN:268,TK_LOCAL:269,TK_NIL:270,TK_NOT:271,TK_OR:272,TK_REPEAT:273,TK_RETURN:274,TK_THEN:275,TK_TRUE:276,TK_UNTIL:277,TK_WHILE:278,TK_IDIV:279,TK_CONCAT:280,TK_DOTS:281,TK_EQ:282,TK_GE:283,TK_LE:284,TK_NE:285,TK_SHL:286,TK_SHR:287,TK_DBCOLON:288,TK_EOS:289,TK_FLT:290,TK_INT:291,TK_NAME:292,TK_STRING:293},e.exports.isreserved=function(e){let t=Q[T(e)];return void 0!==t&&t<=22},e.exports.luaX_lookahead=function(e){return i(289===e.lookahead.token),e.lookahead.token=$(e,e.lookahead.seminfo),e.lookahead.token},e.exports.luaX_newstring=V,e.exports.luaX_next=function(e){e.lastline=e.linenumber,289!==e.lookahead.token?(e.t.token=e.lookahead.token,e.t.seminfo.i=e.lookahead.seminfo.i,e.t.seminfo.r=e.lookahead.seminfo.r,e.t.seminfo.ts=e.lookahead.seminfo.ts,e.lookahead.token=289):e.t.token=$(e,e.t.seminfo)},e.exports.luaX_setinput=function(e,t,n,r,a){t.t={token:0,seminfo:new S},t.L=e,t.current=a,t.lookahead={token:289,seminfo:new S},t.z=n,t.fs=null,t.linenumber=1,t.lastline=1,t.source=r,t.envn=g(e,N),U(e,t.buff,s)},e.exports.luaX_syntaxerror=function(e,t){j(e,t,e.t.token)},e.exports.luaX_token2str=y,e.exports.luaX_tokens=R},function(e,t,n){"use strict";const{lua:r,lauxlib:a,lualib:u,to_luastring:l}=n(0),{LUA_MULTRET:s,LUA_OK:o,LUA_REGISTRYINDEX:i,LUA_RIDX_MAINTHREAD:c,LUA_TBOOLEAN:_,LUA_TFUNCTION:f,LUA_TLIGHTUSERDATA:p,LUA_TNIL:L,LUA_TNONE:h,LUA_TNUMBER:d,LUA_TSTRING:A,LUA_TTABLE:g,LUA_TTHREAD:x,LUA_TUSERDATA:T,lua_atnativeerror:b,lua_call:O,lua_getfield:k,lua_gettable:v,lua_gettop:E,lua_isnil:m,lua_isproxy:U,lua_newuserdata:N,lua_pcall:R,lua_pop:S,lua_pushboolean:w,lua_pushcfunction:I,lua_pushinteger:y,lua_pushlightuserdata:M,lua_pushliteral:P,lua_pushnil:C,lua_pushnumber:D,lua_pushstring:V,lua_pushvalue:B,lua_rawgeti:G,lua_rawgetp:K,lua_rawsetp:F,lua_rotate:j,lua_setfield:H,lua_settable:X,lua_settop:z,lua_toboolean:Y,lua_tojsstring:q,lua_tonumber:Z,lua_toproxy:J,lua_tothread:W,lua_touserdata:Q,lua_type:$}=r,{luaL_argerror:ee,luaL_checkany:te,luaL_checkoption:ne,luaL_checkstack:re,luaL_checkudata:ae,luaL_error:ue,luaL_getmetafield:le,luaL_newlib:se,luaL_newmetatable:oe,luaL_requiref:ie,luaL_setfuncs:ce,luaL_setmetatable:_e,luaL_testudata:fe,luaL_tolstring:pe}=a,{luaopen_base:Le}=u,he="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this");let de,Ae,ge;if("undefined"!=typeof Reflect)de=Reflect.apply,Ae=Reflect.construct,ge=Reflect.deleteProperty;else{const e=Function.apply,t=Function.bind;de=function(t,n,r){return e.call(t,n,r)},Ae=function(e,n){switch(n.length){case 0:return new e;case 1:return new e(n[0]);case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[1],n[2]);case 4:return new e(n[0],n[1],n[2],n[3])}let r=[null];return r.push.apply(r,n),new(t.apply(e,r))},ge=Function("t","k","delete t[k]")}const xe=String.prototype.concat.bind(""),Te=function(e){return"object"==typeof e?null!==e:"function"==typeof e},be=l("js object"),Oe=function(e,t){let n=fe(e,t,be);return n?n.data:void 0},ke=function(e,t){return ae(e,t,be).data},ve=function(e,t){N(e).data=t,_e(e,be)},Ee=function(e){G(e,i,c);let t=W(e,-1);return S(e,1),t},me=new WeakMap,Ue=function(e,t){switch(typeof t){case"undefined":C(e);break;case"number":D(e,t);break;case"string":V(e,l(t));break;case"boolean":w(e,t);break;case"symbol":M(e,t);break;case"function":if(U(t,e)){t(e);break}case"object":if(null===t){if(K(e,i,null)!==T)throw Error("js library not loaded into lua_State");break}default:{let n=me.get(Ee(e));if(!n)throw Error("js library not loaded into lua_State");let r=n.get(t);r?r(e):(ve(e,t),r=J(e,-1),n.set(t,r))}}},Ne=function(e){let t=Q(e,1);return Ue(e,t),1},Re=function(e,t){switch($(e,t)){case h:case L:return;case _:return Y(e,t);case p:return Q(e,t);case d:return Z(e,t);case A:return q(e,t);case T:{let n=Oe(e,t);if(void 0!==n)return n}case g:case f:case x:default:return Be(e,J(e,t))}},Se=function(e,t){let n=R(e,t,1,0),r=Re(e,-1);switch(S(e,1),n){case o:return r;default:throw r}},we=function(e,t,n,r,a){if(!Te(r))throw new TypeError("`args` argument must be an object");let u=+r.length;u>=0||(u=0),re(e,2+u,null);let l=E(e);t(e),Ue(e,n);for(let t=0;t<u;t++)Ue(e,r[t]);switch(R(e,1+u,a,0)){case o:{let t=E(e)-l,n=new Array(t);for(let r=0;r<t;r++)n[r]=Re(e,l+r+1);return z(e,l),n}default:{let t=Re(e,-1);throw z(e,l),t}}},Ie=function(e){return v(e,1),1},ye=function(e,t,n){return re(e,3,null),I(e,Ie),t(e),Ue(e,n),Se(e,2)},Me=function(e,t,n){switch(re(e,3,null),I(e,Ie),t(e),Ue(e,n),R(e,2,1,0)){case o:{let t=m(e,-1);return S(e,1),!t}default:{let t=Re(e,-1);throw S(e,1),t}}},Pe=function(e,t,n,r){switch(re(e,4,null),I(e,function(e){return X(e,1),0}),t(e),Ue(e,n),Ue(e,r),R(e,3,0,0)){case o:return;default:{let t=Re(e,-1);throw S(e,1),t}}},Ce=function(e,t,n){switch(re(e,4,null),I(e,function(e){return X(e,1),0}),t(e),Ue(e,n),C(e),R(e,3,0,0)){case o:return;default:{let t=Re(e,-1);throw S(e,1),t}}},De=function(e,t){return re(e,2,null),I(e,function(e){return pe(e,1),1}),t(e),Se(e,1)},Ve=function(){let e=this.L;re(e,3,null);let t=E(e);switch(this.iter(e),this.state(e),this.last(e),R(e,2,s,0)){case o:{let n;if(this.last=J(e,t+1),m(e,-1))n={done:!0,value:void 0};else{let r=E(e)-t,a=new Array(r);for(let n=0;n<r;n++)a[n]=Re(e,t+n+1);n={done:!1,value:a}}return z(e,t),n}default:{let t=Re(e,-1);throw S(e,1),t}}},Be=function(e,t){const n=Ee(e);let r=function(){return we(n,t,this,arguments,1)[0]};r.apply=function(e,r){return we(n,t,e,r,1)[0]},r.invoke=function(e,r){return we(n,t,e,r,s)},r.get=function(e){return ye(n,t,e)},r.has=function(e){return Me(n,t,e)},r.set=function(e,r){return Pe(n,t,e,r)},r.delete=function(e){return Ce(n,t,e)},r.toString=function(){return De(n,t)},"function"==typeof Symbol&&(r[Symbol.toStringTag]="Fengari object",r[Symbol.iterator]=function(){return function(e,t){switch(re(e,1,null),I(e,function(e){return ie(e,l("_G"),Le,0),k(e,-1,l("pairs")),t(e),O(e,1,3),3}),R(e,0,3,0)){case o:{let t=J(e,-3),n=J(e,-2),r=J(e,-1);return S(e,3),{L:e,iter:t,state:n,last:r,next:Ve}}default:{let t=Re(e,-1);throw S(e,1),t}}}(n,t)},Symbol.toPrimitive&&(r[Symbol.toPrimitive]=function(e){if("string"===e)return De(n,t)}));let a=me.get(n);if(!a)throw Error("js library not loaded into lua_State");return a.set(r,t),r},Ge={new:function(e){let t=Re(e,1),n=E(e)-1,r=new Array(n);for(let t=0;t<n;t++)r[t]=Re(e,t+2);return Ue(e,Ae(t,r)),1},tonumber:function(e){let t=Re(e,1);return D(e,+t),1},tostring:function(e){let t=Re(e,1);return P(e,xe(t)),1},instanceof:function(e){let t=Re(e,1),n=Re(e,2);return w(e,t instanceof n),1},typeof:function(e){let t=Re(e,1);return P(e,typeof t),1}};if("function"==typeof Symbol&&Symbol.iterator){const e=function(e,t){let n=ke(e,t),r=n[Symbol.iterator];r||ee(e,t,l("object not iterable"));let a=de(r,n,[]);return Te(a)||ee(e,t,l("Result of the Symbol.iterator method is not an object")),a},t=function(e){let t=Re(e,1).next();return t.done?0:(Ue(e,t.value),1)};Ge.of=function(n){let r=e(n,1);return I(n,t),Ue(n,r),2}}if("function"==typeof Proxy&&"function"==typeof Symbol){const e=Symbol("lua_State"),t=Symbol("fengari-proxy"),n={apply:function(n,r,a){return we(n[e],n[t],r,a,1)[0]},construct:function(n,r){let a=n[e],u=n[t],s=r.length;re(a,2+s,null),u(a);let o=E(a);if(le(a,o,l("construct"))===L)throw S(a,1),new TypeError("not a constructor");j(a,o,1);for(let e=0;e<s;e++)Ue(a,r[e]);return Se(a,1+s)},defineProperty:function(n,r,a){let u=n[e],s=n[t];return re(u,4,null),s(u),le(u,-1,l("defineProperty"))===L?(S(u,1),!1):(j(u,-2,1),Ue(u,r),Ue(u,a),Se(u,3))},deleteProperty:function(n,r){return Ce(n[e],n[t],r)},get:function(n,r){return ye(n[e],n[t],r)},getOwnPropertyDescriptor:function(n,r){let a=n[e],u=n[t];if(re(a,3,null),u(a),le(a,-1,l("getOwnPropertyDescriptor"))!==L)return j(a,-2,1),Ue(a,r),Se(a,2);S(a,1)},getPrototypeOf:function(n){let r=n[e],a=n[t];return re(r,2,null),a(r),le(r,-1,l("getPrototypeOf"))===L?(S(r,1),null):(j(r,-2,1),Se(r,1))},has:function(n,r){return Me(n[e],n[t],r)},ownKeys:function(n){let r=n[e],a=n[t];if(re(r,2,null),a(r),le(r,-1,l("ownKeys"))===L)throw S(r,1),Error("ownKeys unknown for fengari object");return j(r,-2,1),Se(r,1)},set:function(n,r,a){return Pe(n[e],n[t],r,a),!0},setPrototypeOf:function(n,r){let a=n[e],u=n[t];return re(a,3,null),u(a),le(a,-1,l("setPrototypeOf"))===L?(S(a,1),!1):(j(a,-2,1),Ue(a,r),Se(a,2))}},r=function(){let e=function(){}.bind();return delete e.length,delete e.name,e},a=Function("return ()=>void 0;"),u=function(){let e=a();return delete e.length,delete e.name,e},s=function(a,l,s){const o=Ee(a);let i;switch(s){case"function":i=r();break;case"arrow_function":i=u();break;case"object":i={};break;default:throw TypeError("invalid type to createproxy")}return i[t]=l,i[e]=o,new Proxy(i,n)},o=["function","arrow_function","object"],i=o.map(e=>l(e));Ge.createproxy=function(e){te(e,1);let t=o[ne(e,2,i[0],i)],n=s(e,J(e,1),t);return Ue(e,n),1}}let Ke={__index:function(e){let t=ke(e,1),n=Re(e,2);return Ue(e,t[n]),1},__newindex:function(e){let t=ke(e,1),n=Re(e,2),r=Re(e,3);return void 0===r?ge(t,n):t[n]=r,0},__tostring:function(e){let t=ke(e,1),n=xe(t);return V(e,l(n)),1},__call:function(e){let t,n=ke(e,1),r=E(e)-1,a=new Array(Math.max(0,r-1));if(r>0&&(t=Re(e,2),r-- >0))for(let t=0;t<r;t++)a[t]=Re(e,t+3);return Ue(e,de(n,t,a)),1},__pairs:function(e){let t,n,r,a,u=ke(e,1);if("function"!=typeof Symbol||void 0===(t=u[Symbol.for("__pairs")]))n=function(e){if(this.index>=this.keys.length)return;let t=this.keys[this.index++];return[t,this.object[t]]},r={object:u,keys:Object.keys(u),index:0};else{let s=de(t,u,[]);void 0===s&&ue(e,l("bad '__pairs' result (object with keys 'iter', 'state', 'first' expected)")),void 0===(n=s.iter)&&ue(e,l("bad '__pairs' result (object.iter is missing)")),r=s.state,a=s.first}return I(e,function(){let t=Re(e,1),r=Re(e,2),a=de(n,t,[r]);if(void 0===a)return 0;Array.isArray(a)||ue(e,l("bad iterator result (Array or undefined expected)")),re(e,a.length,null);for(let t=0;t<a.length;t++)Ue(e,a[t]);return a.length}),Ue(e,r),Ue(e,a),3},__len:function(e){let t,n,r=ke(e,1);return n="function"!=typeof Symbol||void 0===(t=r[Symbol.for("__len")])?r.length:de(t,r,[]),Ue(e,n),1}};e.exports.FENGARI_INTEROP_VERSION="0.1",e.exports.FENGARI_INTEROP_VERSION_NUM=1,e.exports.FENGARI_INTEROP_RELEASE="0.1.2",e.exports.checkjs=ke,e.exports.testjs=Oe,e.exports.pushjs=ve,e.exports.push=Ue,e.exports.tojs=Re,e.exports.luaopen_js=function(e){return me.set(Ee(e),new WeakMap),b(e,Ne),se(e,Ge),P(e,"0.1"),H(e,-2,l("_VERSION")),y(e,1),H(e,-2,l("_VERSION_NUM")),P(e,"0.1.2"),H(e,-2,l("_RELEASE")),oe(e,be),ce(e,Ke,0),S(e,1),ve(e,null),B(e,-1),F(e,i,null),H(e,-2,l("null")),Ue(e,he),H(e,-2,l("global")),1}},function(e,t,n){"use strict";const{luastring_of:r}=n(1),a=r(0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,22,22,22,22,22,22,22,22,22,22,4,4,4,4,4,4,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,5,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);e.exports.lisdigit=function(e){return 0!=(2&a[e+1])},e.exports.lislalnum=function(e){return 0!=(3&a[e+1])},e.exports.lislalpha=function(e){return 0!=(1&a[e+1])},e.exports.lisprint=function(e){return 0!=(4&a[e+1])},e.exports.lisspace=function(e){return 0!=(8&a[e+1])},e.exports.lisxdigit=function(e){return 0!=(16&a[e+1])}},function(e,t,n){"use strict";const{LUA_MULTRET:r,to_luastring:a}=n(1),{BinOpr:{OPR_ADD:u,OPR_AND:l,OPR_BAND:s,OPR_BOR:o,OPR_BXOR:i,OPR_CONCAT:c,OPR_DIV:_,OPR_EQ:f,OPR_GE:p,OPR_GT:L,OPR_IDIV:h,OPR_LE:d,OPR_LT:A,OPR_MOD:g,OPR_MUL:x,OPR_NE:T,OPR_NOBINOPR:b,OPR_OR:O,OPR_POW:k,OPR_SHL:v,OPR_SHR:E,OPR_SUB:m},UnOpr:{OPR_BNOT:U,OPR_LEN:N,OPR_MINUS:R,OPR_NOT:S,OPR_NOUNOPR:w},NO_JUMP:I,getinstruction:y,luaK_checkstack:M,luaK_codeABC:P,luaK_codeABx:C,luaK_codeAsBx:D,luaK_codek:V,luaK_concat:B,luaK_dischargevars:G,luaK_exp2RK:K,luaK_exp2anyreg:F,luaK_exp2anyregup:j,luaK_exp2nextreg:H,luaK_exp2val:X,luaK_fixline:z,luaK_getlabel:Y,luaK_goiffalse:q,luaK_goiftrue:Z,luaK_indexed:J,luaK_infix:W,luaK_intK:Q,luaK_jump:$,luaK_jumpto:ee,luaK_nil:te,luaK_patchclose:ne,luaK_patchlist:re,luaK_patchtohere:ae,luaK_posfix:ue,luaK_prefix:le,luaK_reserveregs:se,luaK_ret:oe,luaK_self:ie,luaK_setlist:ce,luaK_setmultret:_e,luaK_setoneret:fe,luaK_setreturns:pe,luaK_storevar:Le,luaK_stringK:he}=n(35),de=n(8),Ae=n(13),ge=n(20),{LUAI_MAXCCALLS:xe,MAX_INT:Te,lua_assert:be}=n(4),Oe=n(6),{OpCodesI:{OP_CALL:ke,OP_CLOSURE:ve,OP_FORLOOP:Ee,OP_FORPREP:me,OP_GETUPVAL:Ue,OP_MOVE:Ne,OP_NEWTABLE:Re,OP_SETTABLE:Se,OP_TAILCALL:we,OP_TFORCALL:Ie,OP_TFORLOOP:ye,OP_VARARG:Me},LFIELDS_PER_FLUSH:Pe,SETARG_B:Ce,SETARG_C:De,SET_OPCODE:Ve}=n(16),{luaS_eqlngstr:Be,luaS_new:Ge,luaS_newliteral:Ke}=n(10),Fe=n(9),je=Ae.Proto,He=ge.RESERVED,Xe=function(e){return e===qe.VCALL||e===qe.VVARARG},ze=function(e,t){return Be(e,t)};class Ye{constructor(){this.previous=null,this.firstlabel=NaN,this.firstgoto=NaN,this.nactvar=NaN,this.upval=NaN,this.isloop=NaN}}const qe={VVOID:0,VNIL:1,VTRUE:2,VFALSE:3,VK:4,VKFLT:5,VKINT:6,VNONRELOC:7,VLOCAL:8,VUPVAL:9,VINDEXED:10,VJMP:11,VRELOCABLE:12,VCALL:13,VVARARG:14};class Ze{constructor(){this.k=NaN,this.u={ival:NaN,nval:NaN,info:NaN,ind:{idx:NaN,t:NaN,vt:NaN}},this.t=NaN,this.f=NaN}to(e){this.k=e.k,this.u=e.u,this.t=e.t,this.f=e.f}}class Je{constructor(){this.f=null,this.prev=null,this.ls=null,this.bl=null,this.pc=NaN,this.lasttarget=NaN,this.jpc=NaN,this.nk=NaN,this.np=NaN,this.firstlocal=NaN,this.nlocvars=NaN,this.nactvar=NaN,this.nups=NaN,this.freereg=NaN}}class We{constructor(){this.arr=[],this.n=NaN,this.size=NaN}}const Qe=function(e,t){e.t.token=0,ge.luaX_syntaxerror(e,t)},$e=function(e,t){ge.luaX_syntaxerror(e,Oe.luaO_pushfstring(e.L,a("%s expected",!0),ge.luaX_token2str(e,t)))},et=function(e,t,n,r){t>n&&function(e,t,n){let r=e.ls.L,u=e.f.linedefined,l=0===u?a("main function",!0):Oe.luaO_pushfstring(r,a("function at line %d",!0),u),s=Oe.luaO_pushfstring(r,a("too many %s (limit is %d) in %s",!0),n,t,l);ge.luaX_syntaxerror(e.ls,s)}(e,n,r)},tt=function(e,t){return e.t.token===t&&(ge.luaX_next(e),!0)},nt=function(e,t){e.t.token!==t&&$e(e,t)},rt=function(e,t){nt(e,t),ge.luaX_next(e)},at=function(e,t,n){t||ge.luaX_syntaxerror(e,n)},ut=function(e,t,n,r){tt(e,t)||(r===e.linenumber?$e(e,t):ge.luaX_syntaxerror(e,Oe.luaO_pushfstring(e.L,a("%s expected (to close %s at line %d)"),ge.luaX_token2str(e,t),ge.luaX_token2str(e,n),r)))},lt=function(e){nt(e,He.TK_NAME);let t=e.t.seminfo.ts;return ge.luaX_next(e),t},st=function(e,t,n){e.f=e.t=I,e.k=t,e.u.info=n},ot=function(e,t,n){st(t,qe.VK,he(e.fs,n))},it=function(e,t){ot(e,t,lt(e))},ct=function(e,t){let n=e.fs,r=e.dyd,u=function(e,t){let n=e.fs,r=n.f;return r.locvars[n.nlocvars]=new Oe.LocVar,r.locvars[n.nlocvars].varname=t,n.nlocvars++}(e,t);et(n,r.actvar.n+1-n.firstlocal,200,a("local variables",!0)),r.actvar.arr[r.actvar.n]=new class{constructor(){this.idx=NaN}},r.actvar.arr[r.actvar.n].idx=u,r.actvar.n++},_t=function(e,t){ct(e,ge.luaX_newstring(e,a(t,!0)))},ft=function(e,t){let n=e.ls.dyd.actvar.arr[e.firstlocal+t].idx;return be(n<e.nlocvars),e.f.locvars[n]},pt=function(e,t){let n=e.fs;for(n.nactvar=n.nactvar+t;t;t--)ft(n,n.nactvar-t).startpc=n.pc},Lt=function(e,t,n){let r=e.f;return et(e,e.nups+1,Ae.MAXUPVAL,a("upvalues",!0)),r.upvalues[e.nups]={instack:n.k===qe.VLOCAL,idx:n.u.info,name:t},e.nups++},ht=function(e,t,n,r){if(null===e)st(n,qe.VVOID,0);else{let a=function(e,t){for(let n=e.nactvar-1;n>=0;n--)if(ze(t,ft(e,n).varname))return n;return-1}(e,t);if(a>=0)st(n,qe.VLOCAL,a),r||function(e,t){let n=e.bl;for(;n.nactvar>t;)n=n.previous;n.upval=1}(e,a);else{let r=function(e,t){let n=e.f.upvalues;for(let r=0;r<e.nups;r++)if(ze(n[r].name,t))return r;return-1}(e,t);if(r<0){if(ht(e.prev,t,n,0),n.k===qe.VVOID)return;r=Lt(e,t,n)}st(n,qe.VUPVAL,r)}}},dt=function(e,t){let n=lt(e),r=e.fs;if(ht(r,n,t,1),t.k===qe.VVOID){let a=new Ze;ht(r,e.envn,t,1),be(t.k!==qe.VVOID),ot(e,a,n),J(r,t,a)}},At=function(e,t,n,r){let a=e.fs,u=t-n;if(Xe(r.k))++u<0&&(u=0),pe(a,r,u),u>1&&se(a,u-1);else if(r.k!==qe.VVOID&&H(a,r),u>0){let e=a.freereg;se(a,u),te(a,e,u)}n>t&&(e.fs.freereg-=n-t)},gt=function(e){let t=e.L;++t.nCcalls,et(e.fs,t.nCcalls,xe,a("JS levels",!0))},xt=function(e){return e.L.nCcalls--},Tt=function(e,t,n){let r=e.fs,u=e.dyd.gt,l=u.arr[t];if(be(ze(l.name,n.name)),l.nactvar<n.nactvar){let t=ft(r,l.nactvar).varname,n=Oe.luaO_pushfstring(e.L,a("<goto %s> at line %d jumps into the scope of local '%s'"),l.name.getstr(),l.line,t.getstr());Qe(e,n)}re(r,l.pc,n.pc);for(let e=t;e<u.n-1;e++)u.arr[e]=u.arr[e+1];u.n--},bt=function(e,t){let n=e.fs.bl,r=e.dyd,a=r.gt.arr[t];for(let u=n.firstlabel;u<r.label.n;u++){let l=r.label.arr[u];if(ze(l.name,a.name))return a.nactvar>l.nactvar&&(n.upval||r.label.n>n.firstlabel)&&ne(e.fs,a.pc,l.nactvar),Tt(e,t,l),!0}return!1},Ot=function(e,t,n,r,a){let u=t.n;return t.arr[u]=new class{constructor(){this.name=null,this.pc=NaN,this.line=NaN,this.nactvar=NaN}},t.arr[u].name=n,t.arr[u].line=r,t.arr[u].nactvar=e.fs.nactvar,t.arr[u].pc=a,t.n=u+1,u},kt=function(e,t){let n=e.dyd.gt,r=e.fs.bl.firstgoto;for(;r<n.n;)ze(n.arr[r].name,t.name)?Tt(e,r,t):r++},vt=function(e,t,n){t.isloop=n,t.nactvar=e.nactvar,t.firstlabel=e.ls.dyd.label.n,t.firstgoto=e.ls.dyd.gt.n,t.upval=0,t.previous=e.bl,e.bl=t,be(e.freereg===e.nactvar)},Et=function(e,t,n){t.prev=e.fs,t.ls=e,e.fs=t,t.pc=0,t.lasttarget=0,t.jpc=I,t.freereg=0,t.nk=0,t.np=0,t.nups=0,t.nlocvars=0,t.nactvar=0,t.firstlocal=e.dyd.actvar.n,t.bl=null;let r=t.f;r.source=e.source,r.maxstacksize=2,vt(t,n,!1)},mt=function(e){let t=e.bl,n=e.ls;if(t.previous&&t.upval){let n=$(e);ne(e,n,t.nactvar),ae(e,n)}t.isloop&&function(e){let t=Ke(e.L,"break"),n=Ot(e,e.dyd.label,t,0,e.fs.pc);kt(e,e.dyd.label.arr[n])}(n),e.bl=t.previous,function(e,t){for(e.ls.dyd.actvar.n-=e.nactvar-t;e.nactvar>t;)ft(e,--e.nactvar).endpc=e.pc}(e,t.nactvar),be(t.nactvar===e.nactvar),e.freereg=e.nactvar,n.dyd.label.n=t.firstlabel,t.previous?function(e,t){let n=t.firstgoto,r=e.ls.dyd.gt;for(;n<r.n;){let a=r.arr[n];a.nactvar>t.nactvar&&(t.upval&&ne(e,a.pc,t.nactvar),a.nactvar=t.nactvar),bt(e.ls,n)||n++}}(e,t):t.firstgoto<n.dyd.gt.n&&function(e,t){let n=ge.isreserved(t.name)?"<%s> at line %d not inside a loop":"no visible label '%s' for <goto> at line %d";n=Oe.luaO_pushfstring(e.L,a(n),t.name.getstr(),t.line),Qe(e,n)}(n,n.dyd.gt.arr[t.firstgoto])},Ut=function(e){let t=e.fs;oe(t,0,0),mt(t),be(null===t.bl),e.fs=t.prev},Nt=function(e,t){switch(e.t.token){case He.TK_ELSE:case He.TK_ELSEIF:case He.TK_END:case He.TK_EOS:return!0;case He.TK_UNTIL:return t;default:return!1}},Rt=function(e){for(;!Nt(e,1);){if(e.t.token===He.TK_RETURN)return void Qt(e);Qt(e)}},St=function(e,t){let n=e.fs,r=new Ze;j(n,t),ge.luaX_next(e),it(e,r),J(n,t,r)},wt=function(e,t){ge.luaX_next(e),jt(e,t),X(e.fs,t),rt(e,93)},It=function(e,t){let n=e.fs,r=e.fs.freereg,u=new Ze,l=new Ze;e.t.token===He.TK_NAME?(et(n,t.nh,Te,a("items in a constructor",!0)),it(e,u)):wt(e,u),t.nh++,rt(e,61);let s=K(n,u);jt(e,l),P(n,Se,t.t.u.info,s,K(n,l)),n.freereg=r},yt=function(e,t){t.v.k!==qe.VVOID&&(H(e,t.v),t.v.k=qe.VVOID,t.tostore===Pe&&(ce(e,t.t.u.info,t.na,t.tostore),t.tostore=0))},Mt=function(e,t){jt(e,t.v),et(e.fs,t.na,Te,a("items in a constructor",!0)),t.na++,t.tostore++},Pt=function(e,t){switch(e.t.token){case He.TK_NAME:61!==ge.luaX_lookahead(e)?Mt(e,t):It(e,t);break;case 91:It(e,t);break;default:Mt(e,t)}},Ct=function(e,t){let n=e.fs,a=e.linenumber,u=P(n,Re,0,0,0),l=new class{constructor(){this.v=new Ze,this.t=new Ze,this.nh=NaN,this.na=NaN,this.tostore=NaN}};l.na=l.nh=l.tostore=0,l.t=t,st(t,qe.VRELOCABLE,u),st(l.v,qe.VVOID,0),H(e.fs,t),rt(e,123);do{if(be(l.v.k===qe.VVOID||l.tostore>0),125===e.t.token)break;yt(n,l),Pt(e,l)}while(tt(e,44)||tt(e,59));ut(e,125,123,a),function(e,t){0!==t.tostore&&(Xe(t.v.k)?(_e(e,t.v),ce(e,t.t.u.info,t.na,r),t.na--):(t.v.k!==qe.VVOID&&H(e,t.v),ce(e,t.t.u.info,t.na,t.tostore)))}(n,l),Ce(n.f.code[u],Oe.luaO_int2fb(l.na)),De(n.f.code[u],Oe.luaO_int2fb(l.nh))},Dt=function(e,t,n,r){let u=new Je,l=new Ye;u.f=function(e){let t=e.L,n=new je(t),r=e.fs;return r.f.p[r.np++]=n,n}(e),u.f.linedefined=r,Et(e,u,l),rt(e,40),n&&(_t(e,"self"),pt(e,1)),function(e){let t=e.fs,n=t.f,r=0;if(n.is_vararg=!1,41!==e.t.token)do{switch(e.t.token){case He.TK_NAME:ct(e,lt(e)),r++;break;case He.TK_DOTS:ge.luaX_next(e),n.is_vararg=!0;break;default:ge.luaX_syntaxerror(e,a("<name> or '...' expected",!0))}}while(!n.is_vararg&&tt(e,44));pt(e,r),n.numparams=t.nactvar,se(t,t.nactvar)}(e),rt(e,41),Rt(e),u.f.lastlinedefined=e.linenumber,ut(e,He.TK_END,He.TK_FUNCTION,r),function(e,t){let n=e.fs.prev;st(t,qe.VRELOCABLE,C(n,ve,0,n.np-1)),H(n,t)}(e,t),Ut(e)},Vt=function(e,t){let n=1;for(jt(e,t);tt(e,44);)H(e.fs,t),jt(e,t),n++;return n},Bt=function(e,t,n){let u,l=e.fs,s=new Ze;switch(e.t.token){case 40:ge.luaX_next(e),41===e.t.token?s.k=qe.VVOID:(Vt(e,s),_e(l,s)),ut(e,41,40,n);break;case 123:Ct(e,s);break;case He.TK_STRING:ot(e,s,e.t.seminfo.ts),ge.luaX_next(e);break;default:ge.luaX_syntaxerror(e,a("function arguments expected",!0))}be(t.k===qe.VNONRELOC);let o=t.u.info;Xe(s.k)?u=r:(s.k!==qe.VVOID&&H(l,s),u=l.freereg-(o+1)),st(t,qe.VCALL,P(l,ke,o,u+1,2)),z(l,n),l.freereg=o+1},Gt=function(e,t){let n=e.fs,r=e.linenumber;for(function(e,t){switch(e.t.token){case 40:{let n=e.linenumber;return ge.luaX_next(e),jt(e,t),ut(e,41,40,n),void G(e.fs,t)}case He.TK_NAME:return void dt(e,t);default:ge.luaX_syntaxerror(e,a("unexpected symbol",!0))}}(e,t);;)switch(e.t.token){case 46:St(e,t);break;case 91:{let r=new Ze;j(n,t),wt(e,r),J(n,t,r);break}case 58:{let a=new Ze;ge.luaX_next(e),it(e,a),ie(n,t,a),Bt(e,t,r);break}case 40:case He.TK_STRING:case 123:H(n,t),Bt(e,t,r);break;default:return}},Kt=[{left:10,right:10},{left:10,right:10},{left:11,right:11},{left:11,right:11},{left:14,right:13},{left:11,right:11},{left:11,right:11},{left:6,right:6},{left:4,right:4},{left:5,right:5},{left:7,right:7},{left:7,right:7},{left:9,right:8},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:2,right:2},{left:1,right:1}],Ft=function(e,t,n){gt(e);let r=function(e){switch(e){case He.TK_NOT:return S;case 45:return R;case 126:return U;case 35:return N;default:return w}}(e.t.token);if(r!==w){let n=e.linenumber;ge.luaX_next(e),Ft(e,t,12),le(e.fs,r,t,n)}else!function(e,t){switch(e.t.token){case He.TK_FLT:st(t,qe.VKFLT,0),t.u.nval=e.t.seminfo.r;break;case He.TK_INT:st(t,qe.VKINT,0),t.u.ival=e.t.seminfo.i;break;case He.TK_STRING:ot(e,t,e.t.seminfo.ts);break;case He.TK_NIL:st(t,qe.VNIL,0);break;case He.TK_TRUE:st(t,qe.VTRUE,0);break;case He.TK_FALSE:st(t,qe.VFALSE,0);break;case He.TK_DOTS:{let n=e.fs;at(e,n.f.is_vararg,a("cannot use '...' outside a vararg function",!0)),st(t,qe.VVARARG,P(n,Me,0,1,0));break}case 123:return void Ct(e,t);case He.TK_FUNCTION:return ge.luaX_next(e),void Dt(e,t,0,e.linenumber);default:return void Gt(e,t)}ge.luaX_next(e)}(e,t);let I=function(e){switch(e){case 43:return u;case 45:return m;case 42:return x;case 37:return g;case 94:return k;case 47:return _;case He.TK_IDIV:return h;case 38:return s;case 124:return o;case 126:return i;case He.TK_SHL:return v;case He.TK_SHR:return E;case He.TK_CONCAT:return c;case He.TK_NE:return T;case He.TK_EQ:return f;case 60:return A;case He.TK_LE:return d;case 62:return L;case He.TK_GE:return p;case He.TK_AND:return l;case He.TK_OR:return O;default:return b}}(e.t.token);for(;I!==b&&Kt[I].left>n;){let n=new Ze,r=e.linenumber;ge.luaX_next(e),W(e.fs,I,t);let a=Ft(e,n,Kt[I].right);ue(e.fs,I,t,n,r),I=a}return xt(e),I},jt=function(e,t){Ft(e,t,0)},Ht=function(e){let t=e.fs,n=new Ye;vt(t,n,0),Rt(e),mt(t)};class Xt{constructor(){this.prev=null,this.v=new Ze}}const zt=function(e,t,n){let r=new Ze;if(at(e,function(e){return qe.VLOCAL<=e&&e<=qe.VINDEXED}(t.v.k),a("syntax error",!0)),tt(e,44)){let r=new Xt;r.prev=t,Gt(e,r.v),r.v.k!==qe.VINDEXED&&function(e,t,n){let r=e.fs,a=r.freereg,u=!1;for(;t;t=t.prev)t.v.k===qe.VINDEXED&&(t.v.u.ind.vt===n.k&&t.v.u.ind.t===n.u.info&&(u=!0,t.v.u.ind.vt=qe.VLOCAL,t.v.u.ind.t=a),n.k===qe.VLOCAL&&t.v.u.ind.idx===n.u.info&&(u=!0,t.v.u.ind.idx=a));if(u){let e=n.k===qe.VLOCAL?Ne:Ue;P(r,e,a,n.u.info,0),se(r,1)}}(e,t,r.v),et(e.fs,n+e.L.nCcalls,xe,a("JS levels",!0)),zt(e,r,n+1)}else{rt(e,61);let a=Vt(e,r);if(a===n)return fe(e.fs,r),void Le(e.fs,t.v,r);At(e,n,a,r)}st(r,qe.VNONRELOC,e.fs.freereg-1),Le(e.fs,t.v,r)},Yt=function(e){let t=new Ze;return jt(e,t),t.k===qe.VNIL&&(t.k=qe.VFALSE),Z(e.fs,t),t.f},qt=function(e,t){let n,r=e.linenumber;tt(e,He.TK_GOTO)?n=lt(e):(ge.luaX_next(e),n=Ke(e.L,"break"));let a=Ot(e,e.dyd.gt,n,r,t);bt(e,a)},Zt=function(e){let t=new Ze;return jt(e,t),H(e.fs,t),be(t.k===qe.VNONRELOC),t.u.info},Jt=function(e,t,n,r,a){let u,l=new Ye,s=e.fs;pt(e,3),rt(e,He.TK_DO);let o=a?D(s,me,t,I):$(s);vt(s,l,0),pt(e,r),se(s,r),Ht(e),mt(s),ae(s,o),a?u=D(s,Ee,t,I):(P(s,Ie,t,0,r),z(s,n),u=D(s,ye,t+2,I)),re(s,u,o+1),z(s,n)},Wt=function(e,t){let n,r=new Ye,a=e.fs,u=new Ze;if(ge.luaX_next(e),jt(e,u),rt(e,He.TK_THEN),e.t.token===He.TK_GOTO||e.t.token===He.TK_BREAK){for(q(e.fs,u),vt(a,r,!1),qt(e,u.t);tt(e,59););if(Nt(e,0))return mt(a),t;n=$(a)}else Z(e.fs,u),vt(a,r,!1),n=u.f;return Rt(e),mt(a),e.t.token!==He.TK_ELSE&&e.t.token!==He.TK_ELSEIF||(t=B(a,t,$(a))),ae(a,n),t},Qt=function(e){let t=e.linenumber;switch(gt(e),e.t.token){case 59:ge.luaX_next(e);break;case He.TK_IF:!function(e,t){let n=e.fs,r=I;for(r=Wt(e,r);e.t.token===He.TK_ELSEIF;)r=Wt(e,r);tt(e,He.TK_ELSE)&&Ht(e),ut(e,He.TK_END,He.TK_IF,t),ae(n,r)}(e,t);break;case He.TK_WHILE:!function(e,t){let n=e.fs,r=new Ye;ge.luaX_next(e);let a=Y(n),u=Yt(e);vt(n,r,1),rt(e,He.TK_DO),Ht(e),ee(n,a),ut(e,He.TK_END,He.TK_WHILE,t),mt(n),ae(n,u)}(e,t);break;case He.TK_DO:ge.luaX_next(e),Ht(e),ut(e,He.TK_END,He.TK_DO,t);break;case He.TK_FOR:!function(e,t){let n=e.fs,r=new Ye;vt(n,r,1),ge.luaX_next(e);let u=lt(e);switch(e.t.token){case 61:!function(e,t,n){let r=e.fs,a=r.freereg;_t(e,"(for index)"),_t(e,"(for limit)"),_t(e,"(for step)"),ct(e,t),rt(e,61),Zt(e),rt(e,44),Zt(e),tt(e,44)?Zt(e):(V(r,r.freereg,Q(r,1)),se(r,1)),Jt(e,a,n,1,1)}(e,u,t);break;case 44:case He.TK_IN:!function(e,t){let n=e.fs,r=new Ze,a=4,u=n.freereg;for(_t(e,"(for generator)"),_t(e,"(for state)"),_t(e,"(for control)"),ct(e,t);tt(e,44);)ct(e,lt(e)),a++;rt(e,He.TK_IN);let l=e.linenumber;At(e,3,Vt(e,r),r),M(n,3),Jt(e,u,l,a-3,0)}(e,u);break;default:ge.luaX_syntaxerror(e,a("'=' or 'in' expected",!0))}ut(e,He.TK_END,He.TK_FOR,t),mt(n)}(e,t);break;case He.TK_REPEAT:!function(e,t){let n=e.fs,r=Y(n),a=new Ye,u=new Ye;vt(n,a,1),vt(n,u,0),ge.luaX_next(e),Rt(e),ut(e,He.TK_UNTIL,He.TK_REPEAT,t);let l=Yt(e);u.upval&&ne(n,l,u.nactvar),mt(n),re(n,l,r),mt(n)}(e,t);break;case He.TK_FUNCTION:!function(e,t){let n=new Ze,r=new Ze;ge.luaX_next(e);let a=function(e,t){let n=0;for(dt(e,t);46===e.t.token;)St(e,t);return 58===e.t.token&&(n=1,St(e,t)),n}(e,n);Dt(e,r,a,t),Le(e.fs,n,r),z(e.fs,t)}(e,t);break;case He.TK_LOCAL:ge.luaX_next(e),tt(e,He.TK_FUNCTION)?function(e){let t=new Ze,n=e.fs;ct(e,lt(e)),pt(e,1),Dt(e,t,0,e.linenumber),ft(n,t.u.info).startpc=n.pc}(e):function(e){let t,n=0,r=new Ze;do{ct(e,lt(e)),n++}while(tt(e,44));tt(e,61)?t=Vt(e,r):(r.k=qe.VVOID,t=0),At(e,n,t,r),pt(e,n)}(e);break;case He.TK_DBCOLON:ge.luaX_next(e),function(e,t,n){let r,u=e.fs,l=e.dyd.label;!function(e,t,n){for(let r=e.bl.firstlabel;r<t.n;r++)if(ze(n,t.arr[r].name)){let u=Oe.luaO_pushfstring(e.ls.L,a("label '%s' already defined on line %d",!0),n.getstr(),t.arr[r].line);Qe(e.ls,u)}}(u,l,t),rt(e,He.TK_DBCOLON),r=Ot(e,l,t,n,Y(u)),function(e){for(;59===e.t.token||e.t.token===He.TK_DBCOLON;)Qt(e)}(e),Nt(e,0)&&(l.arr[r].nactvar=u.bl.nactvar),kt(e,l.arr[r])}(e,lt(e),t);break;case He.TK_RETURN:ge.luaX_next(e),function(e){let t,n,a=e.fs,u=new Ze;Nt(e,1)||59===e.t.token?t=n=0:(n=Vt(e,u),Xe(u.k)?(_e(a,u),u.k===qe.VCALL&&1===n&&(Ve(y(a,u),we),be(y(a,u).A===a.nactvar)),t=a.nactvar,n=r):1===n?t=F(a,u):(H(a,u),t=a.nactvar,be(n===a.freereg-t))),oe(a,t,n),tt(e,59)}(e);break;case He.TK_BREAK:case He.TK_GOTO:qt(e,$(e.fs));break;default:!function(e){let t=e.fs,n=new Xt;Gt(e,n.v),61===e.t.token||44===e.t.token?(n.prev=null,zt(e,n,1)):(at(e,n.v.k===qe.VCALL,a("syntax error",!0)),De(y(t,n.v),1))}(e)}be(e.fs.f.maxstacksize>=e.fs.freereg&&e.fs.freereg>=e.fs.nactvar),e.fs.freereg=e.fs.nactvar,xt(e)};e.exports.Dyndata=class{constructor(){this.actvar={arr:[],n:NaN,size:NaN},this.gt=new We,this.label=new We}},e.exports.expkind=qe,e.exports.expdesc=Ze,e.exports.luaY_parser=function(e,t,n,r,a,u){let l=new ge.LexState,s=new Je,o=Ae.luaF_newLclosure(e,1);return de.luaD_inctop(e),e.stack[e.top-1].setclLvalue(o),l.h=Fe.luaH_new(e),de.luaD_inctop(e),e.stack[e.top-1].sethvalue(l.h),s.f=o.p=new je(e),s.f.source=Ge(e,a),l.buff=n,l.dyd=r,r.actvar.n=r.gt.n=r.label.n=0,ge.luaX_setinput(e,l,t,s.f.source,u),function(e,t){let n=new Ye,r=new Ze;Et(e,t,n),t.f.is_vararg=!0,st(r,qe.VLOCAL,0),Lt(t,e.envn,r),ge.luaX_next(e),Rt(e),nt(e,He.TK_EOS),Ut(e)}(l,s),be(!s.prev&&1===s.nups&&!l.fs),be(0===r.actvar.n&&0===r.gt.n&&0===r.label.n),delete e.stack[--e.top],o},e.exports.vkisinreg=function(e){return e===qe.VNONRELOC||e===qe.VLOCAL}},function(e,t,n){"use strict";const{LUA_MULTRET:r,LUA_OK:a,LUA_TFUNCTION:u,LUA_TNIL:l,LUA_TNONE:s,LUA_TNUMBER:o,LUA_TSTRING:i,LUA_TTABLE:c,LUA_VERSION:_,LUA_YIELD:f,lua_call:p,lua_callk:L,lua_concat:h,lua_error:d,lua_getglobal:A,lua_geti:g,lua_getmetatable:x,lua_gettop:T,lua_insert:b,lua_isnil:O,lua_isnone:k,lua_isstring:v,lua_load:E,lua_next:m,lua_pcallk:U,lua_pop:N,lua_pushboolean:R,lua_pushcfunction:S,lua_pushglobaltable:w,lua_pushinteger:I,lua_pushliteral:y,lua_pushnil:M,lua_pushstring:P,lua_pushvalue:C,lua_rawequal:D,lua_rawget:V,lua_rawlen:B,lua_rawset:G,lua_remove:K,lua_replace:F,lua_rotate:j,lua_setfield:H,lua_setmetatable:X,lua_settop:z,lua_setupvalue:Y,lua_stringtonumber:q,lua_toboolean:Z,lua_tolstring:J,lua_tostring:W,lua_type:Q,lua_typename:$}=n(2),{luaL_argcheck:ee,luaL_checkany:te,luaL_checkinteger:ne,luaL_checkoption:re,luaL_checkstack:ae,luaL_checktype:ue,luaL_error:le,luaL_getmetafield:se,luaL_loadbufferx:oe,luaL_loadfile:ie,luaL_loadfilex:ce,luaL_optinteger:_e,luaL_optstring:fe,luaL_setfuncs:pe,luaL_tolstring:Le,luaL_where:he}=n(7),{to_jsstring:de,to_luastring:Ae}=n(5);let ge,xe;if("function"==typeof TextDecoder){let e="",t=new TextDecoder("utf-8");ge=function(n){e+=t.decode(n,{stream:!0})};let n=new Uint8Array(0);xe=function(){e+=t.decode(n),console.log(e),e=""}}else{let e=[];ge=function(t){try{t=de(t)}catch(e){let n=new Uint8Array(t.length);n.set(t),t=n}e.push(t)},xe=function(){console.log.apply(console.log,e),e=[]}}const Te=["stop","restart","collect","count","step","setpause","setstepmul","isrunning"].map(e=>Ae(e)),be=function(e){return ue(e,1,c),z(e,2),m(e,1)?2:(M(e),1)},Oe=function(e){let t=ne(e,2)+1;return I(e,t),g(e,1,t)===l?1:2},ke=function(e){let t=_e(e,2,1);return z(e,1),Q(e,1)===i&&t>0&&(he(e,t),C(e,1),h(e,2)),d(e)},ve=function(e,t,n){return t!==a&&t!==f?(R(e,0),C(e,-2),2):T(e)-n},Ee=function(e,t,n){return t===a?(0!==n&&(C(e,n),Y(e,-2,1)||N(e,1)),1):(M(e),b(e,-2),2)},me=function(e,t){return ae(e,2,"too many nested functions"),C(e,1),p(e,0,1),O(e,-1)?(N(e,1),null):(v(e,-1)||le(e,Ae("reader function must return a string")),F(e,5),W(e,5))},Ue=function(e,t,n){return T(e)-1},Ne={assert:function(e){return Z(e,1)?T(e):(te(e,1),K(e,1),y(e,"assertion failed!"),z(e,1),ke(e))},collectgarbage:function(e){re(e,1,"collect",Te),_e(e,2,0),le(e,Ae("lua_gc not implemented"))},dofile:function(e){let t=fe(e,1,null);return z(e,1),ie(e,t)!==a?d(e):(L(e,0,r,0,Ue),Ue(e))},error:ke,getmetatable:function(e){return te(e,1),x(e,1)?(se(e,1,Ae("__metatable",!0)),1):(M(e),1)},ipairs:function(e){return te(e,1),S(e,Oe),C(e,1),I(e,0),3},load:function(e){let t,n=W(e,1),r=fe(e,3,"bt"),a=k(e,4)?0:4;if(null!==n){let a=fe(e,2,n);t=oe(e,n,n.length,a,r)}else{let n=fe(e,2,"=(load)");ue(e,1,u),z(e,5),t=E(e,me,null,n,r)}return Ee(e,t,a)},loadfile:function(e){let t=fe(e,1,null),n=fe(e,2,null),r=k(e,3)?0:3,a=ce(e,t,n);return Ee(e,a,r)},next:be,pairs:function(e){return function(e,t,n,r){return te(e,1),se(e,1,t)===l?(S(e,r),C(e,1),M(e)):(C(e,1),p(e,1,3)),3}(e,Ae("__pairs",!0),0,be)},pcall:function(e){te(e,1),R(e,1),b(e,1);let t=U(e,T(e)-2,r,0,0,ve);return ve(e,t,0)},print:function(e){let t=T(e);A(e,Ae("tostring",!0));for(let n=1;n<=t;n++){C(e,-1),C(e,n),p(e,1,1);let t=J(e,-1);if(null===t)return le(e,Ae("'tostring' must return a string to 'print'"));n>1&&ge(Ae("\t")),ge(t),N(e,1)}return xe(),0},rawequal:function(e){return te(e,1),te(e,2),R(e,D(e,1,2)),1},rawget:function(e){return ue(e,1,c),te(e,2),z(e,2),V(e,1),1},rawlen:function(e){let t=Q(e,1);return ee(e,t===c||t===i,1,"table or string expected"),I(e,B(e,1)),1},rawset:function(e){return ue(e,1,c),te(e,2),te(e,3),z(e,3),G(e,1),1},select:function(e){let t=T(e);if(Q(e,1)===i&&35===W(e,1)[0])return I(e,t-1),1;{let n=ne(e,1);return n<0?n=t+n:n>t&&(n=t),ee(e,1<=n,1,"index out of range"),t-n}},setmetatable:function(e){let t=Q(e,2);return ue(e,1,c),ee(e,t===l||t===c,2,"nil or table expected"),se(e,1,Ae("__metatable",!0))!==l?le(e,Ae("cannot change a protected metatable")):(z(e,2),X(e,1),1)},tonumber:function(e){if(Q(e,2)<=0){if(te(e,1),Q(e,1)===o)return z(e,1),1;{let t=W(e,1);if(null!==t&&q(e,t)===t.length+1)return 1}}else{let t=ne(e,2);ue(e,1,i);let n=W(e,1);ee(e,2<=t&&t<=36,2,"base out of range");let r=function(e,t){try{e=de(e)}catch(e){return null}let n=/^[\t\v\f \n\r]*([+-]?)0*([0-9A-Za-z]+)[\t\v\f \n\r]*$/.exec(e);if(!n)return null;let r=parseInt(n[1]+n[2],t);return isNaN(r)?null:0|r}(n,t);if(null!==r)return I(e,r),1}return M(e),1},tostring:function(e){return te(e,1),Le(e,1),1},type:function(e){let t=Q(e,1);return ee(e,t!==s,1,"value expected"),P(e,$(e,t)),1},xpcall:function(e){let t=T(e);ue(e,2,u),R(e,1),C(e,1),j(e,3,2);let n=U(e,t-2,r,2,2,ve);return ve(e,n,2)}};e.exports.luaopen_base=function(e){return w(e),pe(e,Ne,0),C(e,-1),H(e,-2,Ae("_G")),y(e,_),H(e,-2,Ae("_VERSION")),1}},function(e,t,n){"use strict";const{LUA_OK:r,LUA_TFUNCTION:a,LUA_TSTRING:u,LUA_YIELD:l,lua_Debug:s,lua_checkstack:o,lua_concat:i,lua_error:c,lua_getstack:_,lua_gettop:f,lua_insert:p,lua_isyieldable:L,lua_newthread:h,lua_pop:d,lua_pushboolean:A,lua_pushcclosure:g,lua_pushliteral:x,lua_pushthread:T,lua_pushvalue:b,lua_resume:O,lua_status:k,lua_tothread:v,lua_type:E,lua_upvalueindex:m,lua_xmove:U,lua_yield:N}=n(2),{luaL_argcheck:R,luaL_checktype:S,luaL_newlib:w,luaL_where:I}=n(7),y=function(e){let t=v(e,1);return R(e,t,1,"thread expected"),t},M=function(e,t,n){if(!o(t,n))return x(e,"too many arguments to resume"),-1;if(k(t)===r&&0===f(t))return x(e,"cannot resume dead coroutine"),-1;U(e,t,n);let a=O(t,e,n);if(a===r||a===l){let n=f(t);return o(e,n+1)?(U(t,e,n),n):(d(t,n),x(e,"too many results to resume"),-1)}return U(t,e,1),-1},P=function(e){let t=v(e,m(1)),n=M(e,t,f(e));return n<0?(E(e,-1)===u&&(I(e,1),p(e,-2),i(e,2)),c(e)):n},C=function(e){S(e,1,a);let t=h(e);return b(e,1),U(e,t,1),1},D={create:C,isyieldable:function(e){return A(e,L(e)),1},resume:function(e){let t=y(e),n=M(e,t,f(e)-1);return n<0?(A(e,0),p(e,-2),2):(A(e,1),p(e,-(n+1)),n+1)},running:function(e){return A(e,T(e)),2},status:function(e){let t=y(e);if(e===t)x(e,"running");else switch(k(t)){case l:x(e,"suspended");break;case r:{let n=new s;_(t,0,n)>0?x(e,"normal"):0===f(t)?x(e,"dead"):x(e,"suspended");break}default:x(e,"dead")}return 1},wrap:function(e){return C(e),g(e,P,1),1},yield:function(e){return N(e,f(e))}};e.exports.luaopen_coroutine=function(e){return w(e,D),1}},function(e,t,n){"use strict";const{LUA_MAXINTEGER:r}=n(3),{LUA_OPEQ:a,LUA_OPLT:u,LUA_TFUNCTION:l,LUA_TNIL:s,LUA_TTABLE:o,lua_call:i,lua_checkstack:c,lua_compare:_,lua_createtable:f,lua_geti:p,lua_getmetatable:L,lua_gettop:h,lua_insert:d,lua_isnil:A,lua_isnoneornil:g,lua_isstring:x,lua_pop:T,lua_pushinteger:b,lua_pushnil:O,lua_pushstring:k,lua_pushvalue:v,lua_rawget:E,lua_setfield:m,lua_seti:U,lua_settop:N,lua_toboolean:R,lua_type:S}=n(2),{luaL_Buffer:w,luaL_addlstring:I,luaL_addvalue:y,luaL_argcheck:M,luaL_buffinit:P,luaL_checkinteger:C,luaL_checktype:D,luaL_error:V,luaL_len:B,luaL_newlib:G,luaL_opt:K,luaL_optinteger:F,luaL_optlstring:j,luaL_pushresult:H,luaL_typename:X}=n(7),z=n(17),{to_luastring:Y}=n(5),q=function(e,t,n){return k(e,t),E(e,-n)!==s},Z=function(e,t,n){if(S(e,t)!==o){let r=1;!L(e,t)||1&n&&!q(e,Y("__index",!0),++r)||2&n&&!q(e,Y("__newindex",!0),++r)||4&n&&!q(e,Y("__len",!0),++r)?D(e,t,o):T(e,r)}},J=function(e,t,n){return Z(e,t,4|n),B(e,t)},W=function(e,t,n){p(e,1,n),x(e,-1)||V(e,Y("invalid value (%s) at index %d in table for 'concat'"),X(e,-1),n),y(t)},Q=function(e,t,n){U(e,1,t),U(e,1,n)},$=function(e,t,n){if(A(e,2))return _(e,t,n,u);{v(e,2),v(e,t-1),v(e,n-2),i(e,2,1);let r=R(e,-1);return T(e,1),r}},ee=function(e,t,n){let r=t,a=n-1;for(;;){for(;p(e,1,++r),$(e,-1,-2);)r==n-1&&V(e,Y("invalid order function for sorting")),T(e,1);for(;p(e,1,--a),$(e,-3,-1);)a<r&&V(e,Y("invalid order function for sorting")),T(e,1);if(a<r)return T(e,1),Q(e,n-1,r),r;Q(e,r,a)}},te=function(e,t,n){let r=Math.floor((t-e)/4),a=n%(2*r)+(e+r);return z.lua_assert(e+r<=a&&a<=t-r),a},ne=function(e,t,n,r){for(;t<n;){if(p(e,1,t),p(e,1,n),$(e,-1,-2)?Q(e,t,n):T(e,2),n-t==1)return;let a,u;if(a=n-t<100||0===r?Math.floor((t+n)/2):te(t,n,r),p(e,1,a),p(e,1,t),$(e,-2,-1)?Q(e,a,t):(T(e,1),p(e,1,n),$(e,-1,-2)?Q(e,a,n):T(e,2)),n-t==2)return;p(e,1,a),v(e,-1),p(e,1,n-1),Q(e,a,n-1),(a=ee(e,t,n))-t<n-a?(ne(e,t,a-1,r),u=a-t,t=a+1):(ne(e,a+1,n,r),u=n-a,n=a-1),(n-t)/128>u&&(r=Math.floor(4294967296*Math.random()))}},re={concat:function(e){let t=J(e,1,1),n=j(e,2,""),r=n.length,a=F(e,3,1);t=F(e,4,t);let u=new w;for(P(e,u);a<t;a++)W(e,u,a),I(u,n,r);return a===t&&W(e,u,a),H(u),1},insert:function(e){let t,n=J(e,1,3)+1;switch(h(e)){case 2:t=n;break;case 3:t=C(e,2),M(e,1<=t&&t<=n,2,"position out of bounds");for(let r=n;r>t;r--)p(e,1,r-1),U(e,1,r);break;default:return V(e,"wrong number of arguments to 'insert'")}return U(e,1,t),0},move:function(e){let t=C(e,2),n=C(e,3),u=C(e,4),l=g(e,5)?1:5;if(Z(e,1,1),Z(e,l,2),n>=t){M(e,t>0||n<r+t,3,"too many elements to move");let s=n-t+1;if(M(e,u<=r-s+1,4,"destination wrap around"),u>n||u<=t||1!==l&&1!==_(e,1,l,a))for(let n=0;n<s;n++)p(e,1,t+n),U(e,l,u+n);else for(let n=s-1;n>=0;n--)p(e,1,t+n),U(e,l,u+n)}return v(e,l),1},pack:function(e){let t=h(e);f(e,t,1),d(e,1);for(let n=t;n>=1;n--)U(e,1,n);return b(e,t),m(e,1,Y("n")),1},remove:function(e){let t=J(e,1,3),n=F(e,2,t);for(n!==t&&M(e,1<=n&&n<=t+1,1,"position out of bounds"),p(e,1,n);n<t;n++)p(e,1,n+1),U(e,1,n);return O(e),U(e,1,n),1},sort:function(e){let t=J(e,1,3);return t>1&&(M(e,t<r,1,"array too big"),g(e,2)||D(e,2,l),N(e,2),ne(e,1,t,0)),0},unpack:function(e){let t=F(e,2,1),n=K(e,C,3,B(e,1));if(t>n)return 0;let r=n-t;if(r>=Number.MAX_SAFE_INTEGER||!c(e,++r))return V(e,Y("too many results to unpack"));for(;t<n;t++)p(e,1,t);return p(e,1,n),r}};e.exports.luaopen_table=function(e){return G(e,re),1}},function(e,t,n){"use strict";const{LUA_TNIL:r,LUA_TTABLE:a,lua_close:u,lua_createtable:l,lua_getfield:s,lua_isboolean:o,lua_isnoneornil:i,lua_pop:c,lua_pushboolean:_,lua_pushfstring:f,lua_pushinteger:p,lua_pushliteral:L,lua_pushnil:h,lua_pushnumber:d,lua_pushstring:A,lua_setfield:g,lua_settop:x,lua_toboolean:T,lua_tointegerx:b}=n(2),{luaL_Buffer:O,luaL_addchar:k,luaL_addstring:v,luaL_argerror:E,luaL_buffinit:m,luaL_checkinteger:U,luaL_checkstring:N,luaL_checktype:R,luaL_error:S,luaL_execresult:w,luaL_fileresult:I,luaL_newlib:y,luaL_optinteger:M,luaL_optlstring:P,luaL_optstring:C,luaL_pushresult:D}=n(7),{luastring_eq:V,to_jsstring:B,to_luastring:G}=n(5),K=G("aAbBcCdDeFhHIjklmMnpPrRStTuUwWxXyYzZ%"),F=function(e,t,n){p(e,n),g(e,-2,G(t,!0))},j=function(e,t,n){F(e,"sec",n?t.getUTCSeconds():t.getSeconds()),F(e,"min",n?t.getUTCMinutes():t.getMinutes()),F(e,"hour",n?t.getUTCHours():t.getHours()),F(e,"day",n?t.getUTCDate():t.getDate()),F(e,"month",(n?t.getUTCMonth():t.getMonth())+1),F(e,"year",n?t.getUTCFullYear():t.getFullYear()),F(e,"wday",(n?t.getUTCDay():t.getDay())+1),F(e,"yday",Math.floor((t-new Date(t.getFullYear(),0,0))/864e5))},H=Number.MAX_SAFE_INTEGER/2,X=function(e,t,n,a){let u=s(e,-1,G(t,!0)),l=b(e,-1);if(!1===l){if(u!==r)return S(e,G("field '%s' is not an integer"),t);if(n<0)return S(e,G("field '%s' missing in date table"),t);l=n}else{if(!(-H<=l&&l<=H))return S(e,G("field '%s' is out-of-bound"),t);l-=a}return c(e,1),l},z={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(e=>G(e)),shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>G(e)),months:["January","February","March","April","May","June","July","August","September","October","November","December"].map(e=>G(e)),shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e=>G(e)),AM:G("AM"),PM:G("PM"),am:G("am"),pm:G("pm"),formats:{c:G("%a %b %e %H:%M:%S %Y"),D:G("%m/%d/%y"),F:G("%Y-%m-%d"),R:G("%H:%M"),r:G("%I:%M:%S %p"),T:G("%H:%M:%S"),X:G("%T"),x:G("%D")}},Y=function(e,t){let n=e.getDay();"monday"===t&&(0===n?n=6:n--);let r=(e-new Date(e.getFullYear(),0,1))/864e5;return Math.floor((r+7-n)/7)},q=function(e,t,n){t<10&&k(e,n),v(e,G(String(t)))},Z=function(e,t,n,r){let a=0;for(;a<n.length;)if(37!==n[a])k(t,n[a++]);else{let u=J(e,n,++a);switch(n[a]){case 37:k(t,37);break;case 65:v(t,z.days[r.getDay()]);break;case 66:v(t,z.months[r.getMonth()]);break;case 67:q(t,Math.floor(r.getFullYear()/100),48);break;case 68:Z(e,t,z.formats.D,r);break;case 70:Z(e,t,z.formats.F,r);break;case 72:q(t,r.getHours(),48);break;case 73:q(t,(r.getHours()+11)%12+1,48);break;case 77:q(t,r.getMinutes(),48);break;case 80:v(t,r.getHours()<12?z.am:z.pm);break;case 82:Z(e,t,z.formats.R,r);break;case 83:q(t,r.getSeconds(),48);break;case 84:Z(e,t,z.formats.T,r);break;case 85:q(t,Y(r,"sunday"),48);break;case 87:q(t,Y(r,"monday"),48);break;case 88:Z(e,t,z.formats.X,r);break;case 89:v(t,G(String(r.getFullYear())));break;case 90:{let e=r.toString().match(/\(([\w\s]+)\)/);e&&v(t,G(e[1]));break}case 97:v(t,z.shortDays[r.getDay()]);break;case 98:case 104:v(t,z.shortMonths[r.getMonth()]);break;case 99:Z(e,t,z.formats.c,r);break;case 100:q(t,r.getDate(),48);break;case 101:q(t,r.getDate(),32);break;case 106:{let e=Math.floor((r-new Date(r.getFullYear(),0,1))/864e5);e<100&&(e<10&&k(t,48),k(t,48)),v(t,G(String(e)));break}case 107:q(t,r.getHours(),32);break;case 108:q(t,(r.getHours()+11)%12+1,32);break;case 109:q(t,r.getMonth()+1,48);break;case 110:k(t,10);break;case 112:v(t,r.getHours()<12?z.AM:z.PM);break;case 114:Z(e,t,z.formats.r,r);break;case 115:v(t,G(String(Math.floor(r/1e3))));break;case 116:k(t,8);break;case 117:{let e=r.getDay();v(t,G(String(0===e?7:e)));break}case 119:v(t,G(String(r.getDay())));break;case 120:Z(e,t,z.formats.x,r);break;case 121:q(t,r.getFullYear()%100,48);break;case 122:{let e=r.getTimezoneOffset();e>0?k(t,45):(e=-e,k(t,43)),q(t,Math.floor(e/60),48),q(t,e%60,48);break}}a+=u}},J=function(e,t,n){let r=K,a=0,u=1;for(;a<r.length&&u<=t.length-n;a+=u)if(r[a]==="|".charCodeAt(0))u++;else if(V(t.subarray(n,n+u),r.subarray(a,a+u)))return u;E(e,1,f(e,G("invalid conversion specifier '%%%s'"),t))},W=function(e,t){return U(e,t)},Q={date:function(e){let t=P(e,1,"%c"),n=i(e,2)?new Date:new Date(1e3*W(e,2)),r=!1,a=0;if(t[a]==="!".charCodeAt(0)&&(r=!0,a++),t[a]==="*".charCodeAt(0)&&t[a+1]==="t".charCodeAt(0))l(e,0,9),j(e,n,r);else{new Uint8Array(4)[0]="%".charCodeAt(0);let r=new O;m(e,r),Z(e,r,t,n),D(r)}return 1},difftime:function(e){let t=W(e,1),n=W(e,2);return d(e,t-n),1},time:function(e){let t;return i(e,1)?t=new Date:(R(e,1,a),x(e,1),t=new Date(X(e,"year",-1,0),X(e,"month",-1,1),X(e,"day",-1,0),X(e,"hour",12,0),X(e,"min",0,0),X(e,"sec",0,0)),j(e,t)),p(e,Math.floor(t/1e3)),1},clock:function(e){return d(e,performance.now()/1e3),1}};e.exports.luaopen_os=function(e){return y(e,Q),1}},function(e,t,n){"use strict";const{sprintf:r}=n(38),{LUA_INTEGER_FMT:a,LUA_INTEGER_FRMLEN:u,LUA_MININTEGER:l,LUA_NUMBER_FMT:s,LUA_NUMBER_FRMLEN:o,frexp:i,lua_getlocaledecpoint:c}=n(3),{LUA_TBOOLEAN:_,LUA_TFUNCTION:f,LUA_TNIL:p,LUA_TNUMBER:L,LUA_TSTRING:h,LUA_TTABLE:d,lua_call:A,lua_createtable:g,lua_dump:x,lua_gettable:T,lua_gettop:b,lua_isinteger:O,lua_isstring:k,lua_pop:v,lua_pushcclosure:E,lua_pushinteger:m,lua_pushlightuserdata:U,lua_pushliteral:N,lua_pushlstring:R,lua_pushnil:S,lua_pushnumber:w,lua_pushstring:I,lua_pushvalue:y,lua_remove:M,lua_setfield:P,lua_setmetatable:C,lua_settop:D,lua_toboolean:V,lua_tointeger:B,lua_tonumber:G,lua_tostring:K,lua_touserdata:F,lua_type:j,lua_upvalueindex:H}=n(2),{luaL_Buffer:X,luaL_addchar:z,luaL_addlstring:Y,luaL_addsize:q,luaL_addstring:Z,luaL_addvalue:J,luaL_argcheck:W,luaL_argerror:Q,luaL_buffinit:$,luaL_buffinitsize:ee,luaL_checkinteger:te,luaL_checknumber:ne,luaL_checkstack:re,luaL_checkstring:ae,luaL_checktype:ue,luaL_error:le,luaL_newlib:se,luaL_optinteger:oe,luaL_optstring:ie,luaL_prepbuffsize:ce,luaL_pushresult:_e,luaL_pushresultsize:fe,luaL_tolstring:pe,luaL_typename:Le}=n(7),he=n(17),{luastring_eq:de,luastring_indexOf:Ae,to_jsstring:ge,to_luastring:xe}=n(5),Te="%".charCodeAt(0),be=function(e){let t=Ae(e,0);return t>-1?t:e.length},Oe=function(e,t){return e>=0?e:0-e>t?0:t+e+1},ke=function(e,t,n,r){return Y(r,t,n),0},ve=o.length+1,Ee=function(e,t,n){let a=function(e){if(Object.is(e,1/0))return xe("inf");if(Object.is(e,-1/0))return xe("-inf");if(Number.isNaN(e))return xe("nan");if(0===e){let t=r(s+"x0p+0",e);return Object.is(e,-0)&&(t="-"+t),xe(t)}{let t="",n=i(e),a=n[0],u=n[1];return a<0&&(t+="-",a=-a),t+="0x",t+=(2*a).toString(16),t+=r("p%+d",u-=1),xe(t)}}(n);if(65===t[ve])for(let e=0;e<a.length;e++){let t=a[e];t>=97&&(a[e]=223&t)}else 97!==t[ve]&&le(e,xe("modifiers for format '%%a'/'%%A' not implemented"));return a},me=xe("-+ #0"),Ue=e=>97<=e&&e<=122||65<=e&&e<=90,Ne=e=>48<=e&&e<=57,Re=e=>0<=e&&e<=31||127===e,Se=e=>33<=e&&e<=126,we=e=>97<=e&&e<=122,Ie=e=>65<=e&&e<=90,ye=e=>97<=e&&e<=122||65<=e&&e<=90||48<=e&&e<=57,Me=e=>Se(e)&&!ye(e),Pe=e=>32===e||e>=9&&e<=13,Ce=e=>48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102,De=function(e,t,n){switch(j(e,n)){case h:{let r=K(e,n);!function(e,t,n){z(e,34);let r=0;for(;n--;){if(34===t[r]||92===t[r]||10===t[r])z(e,92),z(e,t[r]);else if(Re(t[r])){let n=""+t[r];Ne(t[r+1])&&(n="0".repeat(3-n.length)+n),Z(e,xe("\\"+n))}else z(e,t[r]);r++}z(e,34)}(t,r,r.length);break}case L:{let s;if(O(e,n)){let t=B(e,n);s=xe(r(t===l?"0x%"+u+"x":a,t))}else{let t=G(e,n);!function(e){if(Ae(e,46)<0){let t=c(),n=Ae(e,t);n&&(e[n]=46)}}(s=Ee(e,xe(`%${u}a`),t))}Z(t,s);break}case p:case _:pe(e,n),J(t);break;default:Q(e,n,xe("value has no literal form"))}},Ve=function(e,t,n,r){let a=n;for(;0!==t[a]&&Ae(me,t[a])>=0;)a++;a-n>=me.length&&le(e,xe("invalid format (repeated flags)")),Ne(t[a])&&a++,Ne(t[a])&&a++,46===t[a]&&(Ne(t[++a])&&a++,Ne(t[a])&&a++),Ne(t[a])&&le(e,xe("invalid format (width or precision too long)")),r[0]=37;for(let e=0;e<a-n+1;e++)r[e+1]=t[n+e];return a},Be=function(e,t){let n=e.length,r=t.length,a=e[n-1];for(let a=0;a<r;a++)e[a+n-1]=t[a];e[n+r-1]=a};class Ge{constructor(e){this.L=e,this.islittle=!0,this.maxalign=1}}const Ke=Ne,Fe=function(e,t){if(e.off>=e.s.length||!Ke(e.s[e.off]))return t;{let t=0;do{t=10*t+(e.s[e.off++]-48)}while(e.off<e.s.length&&Ke(e.s[e.off])&&t<=214748363.8);return t}},je=function(e,t,n){let r=Fe(t,n);return(r>16||r<=0)&&le(e.L,xe("integral size (%d) out of limits [1,%d]"),r,16),r},He=function(e,t){let n={opt:t.s[t.off++],size:0};switch(n.opt){case 98:return n.size=1,n.opt=0,n;case 66:return n.size=1,n.opt=1,n;case 104:return n.size=2,n.opt=0,n;case 72:return n.size=2,n.opt=1,n;case 108:return n.size=4,n.opt=0,n;case 76:return n.size=4,n.opt=1,n;case 106:return n.size=4,n.opt=0,n;case 74:case 84:return n.size=4,n.opt=1,n;case 102:return n.size=4,n.opt=2,n;case 100:case 110:return n.size=8,n.opt=2,n;case 105:return n.size=je(e,t,4),n.opt=0,n;case 73:return n.size=je(e,t,4),n.opt=1,n;case 115:return n.size=je(e,t,4),n.opt=4,n;case 99:return n.size=Fe(t,-1),-1===n.size&&le(e.L,xe("missing size for format option 'c'")),n.opt=3,n;case 122:return n.opt=5,n;case 120:return n.size=1,n.opt=6,n;case 88:return n.opt=7,n;case 32:break;case 60:e.islittle=!0;break;case 62:e.islittle=!1;break;case 61:e.islittle=!0;break;case 33:e.maxalign=je(e,t,8);break;default:le(e.L,xe("invalid format option '%c'"),n.opt)}return n.opt=8,n},Xe=function(e,t,n){let r={opt:NaN,size:NaN,ntoalign:NaN},a=He(e,n);r.size=a.size,r.opt=a.opt;let u=r.size;if(7===r.opt)if(n.off>=n.s.length||0===n.s[n.off])Q(e.L,1,xe("invalid next option for option 'X'"));else{let t=He(e,n);u=t.size,3!==(t=t.opt)&&0!==u||Q(e.L,1,xe("invalid next option for option 'X'"))}return u<=1||3===r.opt?r.ntoalign=0:(u>e.maxalign&&(u=e.maxalign),0!=(u&u-1)&&Q(e.L,1,xe("format asks for alignment not power of 2")),r.ntoalign=u-(t&u-1)&u-1),r},ze=function(e,t,n,r,a){let u=ce(e,r);u[n?0:r-1]=255&t;for(let e=1;e<r;e++)t>>=8,u[n?e:r-1-e]=255&t;if(a&&r>4)for(let e=4;e<r;e++)u[n?e:r-1-e]=255;q(e,r)},Ye=function(e,t,n,r,a){let u=0,l=r<=4?r:4;for(let e=l-1;e>=0;e--)u<<=8,u|=t[n?e:r-1-e];if(r<4){if(a){let e=1<<8*r-1;u=(u^e)-e}}else if(r>4){let s=!a||u>=0?0:255;for(let a=l;a<r;a++)t[n?a:r-1-a]!==s&&le(e,xe("%d-byte integer does not fit into Lua Integer"),r)}return u},qe=function(e,t,n,r){he.lua_assert(t.length>=r);let a=new DataView(new ArrayBuffer(r));for(let e=0;e<r;e++)a.setUint8(e,t[e],n);return 4==r?a.getFloat32(0,n):a.getFloat64(0,n)},Ze=xe("^$*+?.([%-");class Je{constructor(e){this.src=null,this.src_init=null,this.src_end=null,this.p=null,this.p_end=null,this.L=e,this.matchdepth=NaN,this.level=NaN,this.capture=[]}}const We=function(e,t){switch(e.p[t++]){case Te:return t===e.p_end&&le(e.L,xe("malformed pattern (ends with '%%')")),t+1;case 91:94===e.p[t]&&t++;do{t===e.p_end&&le(e.L,xe("malformed pattern (missing ']')")),e.p[t++]===Te&&t<e.p_end&&t++}while(93!==e.p[t]);return t+1;default:return t}},Qe=function(e,t){switch(t){case 97:return Ue(e);case 65:return!Ue(e);case 99:return Re(e);case 67:return!Re(e);case 100:return Ne(e);case 68:return!Ne(e);case 103:return Se(e);case 71:return!Se(e);case 108:return we(e);case 76:return!we(e);case 112:return Me(e);case 80:return!Me(e);case 115:return Pe(e);case 83:return!Pe(e);case 117:return Ie(e);case 85:return!Ie(e);case 119:return ye(e);case 87:return!ye(e);case 120:return Ce(e);case 88:return!Ce(e);case 122:return 0===e;case 90:return 0!==e;default:return t===e}},$e=function(e,t,n,r){let a=!0;for(94===e.p[n+1]&&(a=!1,n++);++n<r;)if(e.p[n]===Te){if(n++,Qe(t,e.p[n]))return a}else if(45===e.p[n+1]&&n+2<r){if(n+=2,e.p[n-2]<=t&&t<=e.p[n])return a}else if(e.p[n]===t)return a;return!a},et=function(e,t,n,r){if(t>=e.src_end)return!1;{let a=e.src[t];switch(e.p[n]){case 46:return!0;case Te:return Qe(a,e.p[n+1]);case 91:return $e(e,a,n,r-1);default:return e.p[n]===a}}},tt=function(e,t,n){if(n>=e.p_end-1&&le(e.L,xe("malformed pattern (missing arguments to '%%b'")),e.src[t]!==e.p[n])return null;{let r=e.p[n],a=e.p[n+1],u=1;for(;++t<e.src_end;)if(e.src[t]===a){if(0==--u)return t+1}else e.src[t]===r&&u++}return null},nt=function(e,t,n,r){let a=0;for(;et(e,t+a,n,r);)a++;for(;a>=0;){let n=st(e,t+a,r+1);if(n)return n;a--}return null},rt=function(e,t,n,r){for(;;){let a=st(e,t,r+1);if(null!==a)return a;if(!et(e,t,n,r))return null;t++}},at=function(e,t,n,r){let a,u=e.level;return u>=32&&le(e.L,xe("too many captures")),e.capture[u]=e.capture[u]?e.capture[u]:{},e.capture[u].init=t,e.capture[u].len=r,e.level=u+1,null===(a=st(e,t,n))&&e.level--,a},ut=function(e,t,n){let r,a=function(e){let t=e.level;for(t--;t>=0;t--)if(-1===e.capture[t].len)return t;return le(e.L,xe("invalid pattern capture"))}(e);return e.capture[a].len=t-e.capture[a].init,null===(r=st(e,t,n))&&(e.capture[a].len=-1),r},lt=function(e,t,n){n=function(e,t){return(t-=49)<0||t>=e.level||-1===e.capture[t].len?le(e.L,xe("invalid capture index %%%d"),t+1):t}(e,n);let r=e.capture[n].len;return e.src_end-t>=r&&function(e,t,n,r,a){return de(e.subarray(t,t+a),n.subarray(r,r+a))}(e.src,e.capture[n].init,e.src,t,r)?t+r:null},st=function(e,t,n){let r=!1,a=!0;for(0==e.matchdepth--&&le(e.L,xe("pattern too complex"));a||r;)if(a=!1,n!==e.p_end)switch(r?void 0:e.p[n]){case 40:t=41===e.p[n+1]?at(e,t,n+2,-2):at(e,t,n+1,-1);break;case 41:t=ut(e,t,n+1);break;case 36:if(n+1!==e.p_end){r=!0;break}t=e.src.length-t==0?t:null;break;case Te:switch(e.p[n+1]){case 98:null!==(t=tt(e,t,n+2))&&(n+=4,a=!0);break;case 102:{n+=2,91!==e.p[n]&&le(e.L,xe("missing '[' after '%%f' in pattern"));let r=We(e,n),u=t===e.src_init?0:e.src[t-1];if(!$e(e,u,n,r-1)&&$e(e,t===e.src_end?0:e.src[t],n,r-1)){n=r,a=!0;break}t=null;break}case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:null!==(t=lt(e,t,e.p[n+1]))&&(n+=2,a=!0);break;default:r=!0}break;default:{r=!1;let u=We(e,n);if(et(e,t,n,u))switch(e.p[u]){case 63:{let r;null!==(r=st(e,t+1,u+1))?t=r:(n=u+1,a=!0);break}case 43:t++;case 42:t=nt(e,t,n,u);break;case 45:t=rt(e,t,n,u);break;default:t++,n=u,a=!0}else{if(42===e.p[u]||63===e.p[u]||45===e.p[u]){n=u+1,a=!0;break}t=null}break}}return e.matchdepth++,t},ot=function(e,t,n,r){if(t>=e.level)0===t?R(e.L,e.src.subarray(n,r),r-n):le(e.L,xe("invalid capture index %%%d"),t+1);else{let n=e.capture[t].len;-1===n&&le(e.L,xe("unfinished capture")),-2===n?m(e.L,e.capture[t].init-e.src_init+1):R(e.L,e.src.subarray(e.capture[t].init),n)}},it=function(e,t,n){let r=0===e.level&&e.src.subarray(t)?1:e.level;re(e.L,r,"too many captures");for(let a=0;a<r;a++)ot(e,a,t,n);return r},ct=function(e,t,n,r,a,u){e.L=t,e.matchdepth=200,e.src=n,e.src_init=0,e.src_end=r,e.p=a,e.p_end=u},_t=function(e){e.level=0,he.lua_assert(200===e.matchdepth)},ft=function(e,t){let n=ae(e,1),r=ae(e,2),a=n.length,u=r.length,l=Oe(oe(e,3,1),a);if(l<1)l=1;else if(l>a+1)return S(e),1;if(t&&(V(e,4)||function(e,t){for(let n=0;n<t;n++)if(-1!==Ae(Ze,e[n]))return!1;return!0}(r,u))){let t=function(e,t,n){var r=0,a=t.length;if(0===a)return r;for(;-1!==(r=e.indexOf(t[0],r));r++)if(de(e.subarray(r,r+a),t))return r;return-1}(n.subarray(l-1),r);if(t>-1)return m(e,l+t),m(e,l+t+u-1),2}else{let s=new Je(e),o=l-1,i=94===r[0];i&&(r=r.subarray(1),u--),ct(s,e,n,a,r,u);do{let n;if(_t(s),null!==(n=st(s,o,0)))return t?(m(e,o+1),m(e,n),it(s,null,0)+2):it(s,o,n)}while(o++<s.src_end&&!i)}return S(e),1},pt=function(e){let t=F(e,H(3));t.ms.L=e;for(let e=t.src;e<=t.ms.src_end;e++){let n;if(_t(t.ms),null!==(n=st(t.ms,e,t.p))&&n!==t.lastmatch)return t.src=t.lastmatch=n,it(t.ms,e,n)}return 0},Lt=function(e,t,n,r,a){let u=e.L;switch(a){case f:{y(u,3);let t=it(e,n,r);A(u,t,1);break}case d:ot(e,0,n,r),T(u,3);break;default:return void function(e,t,n,r){let a=e.L,u=K(a,3),l=u.length;for(let s=0;s<l;s++)u[s]!==Te?z(t,u[s]):Ne(u[++s])?48===u[s]?Y(t,e.src.subarray(n,r),r-n):(ot(e,u[s]-49,n,r),pe(a,-1),M(a,-2),J(t)):(u[s]!==Te&&le(a,xe("invalid use of '%c' in replacement string"),Te),z(t,u[s]))}(e,t,n,r)}V(u,-1)?k(u,-1)||le(u,xe("invalid replacement value (a %s)"),Le(u,-1)):(v(u,1),R(u,e.src.subarray(n,r),r-n)),J(t)},ht={byte:function(e){let t=ae(e,1),n=t.length,r=Oe(oe(e,2,1),n),a=Oe(oe(e,3,r),n);if(r<1&&(r=1),a>n&&(a=n),r>a)return 0;if(a-r>=Number.MAX_SAFE_INTEGER)return le(e,"string slice too long");let u=a-r+1;re(e,u,"string slice too long");for(let n=0;n<u;n++)m(e,t[r+n-1]);return u},char:function(e){let t=b(e),n=new X,r=ee(e,n,t);for(let n=1;n<=t;n++){let t=te(e,n);W(e,t>=0&&t<=255,"value out of range"),r[n-1]=t}return fe(n,t),1},dump:function(e){let t=new X,n=V(e,2);return ue(e,1,f),D(e,1),$(e,t),0!==x(e,ke,t,n)?le(e,xe("unable to dump given function")):(_e(t),1)},find:function(e){return ft(e,1)},format:function(e){let t=b(e),n=1,a=ae(e,n),l=0,s=new X;for($(e,s);l<a.length;)if(a[l]!==Te)z(s,a[l++]);else if(a[++l]===Te)z(s,a[l++]);else{let o=[];switch(++n>t&&Q(e,n,xe("no value")),l=Ve(e,a,l,o),String.fromCharCode(a[l++])){case"c":z(s,te(e,n));break;case"d":case"i":case"o":case"u":case"x":case"X":{let t=te(e,n);Be(o,xe(u,!0)),Z(s,xe(r(String.fromCharCode(...o),t)));break}case"a":case"A":Be(o,xe(u,!0)),Z(s,Ee(e,o,ne(e,n)));break;case"e":case"E":case"f":case"g":case"G":{let t=ne(e,n);Be(o,xe(u,!0)),Z(s,xe(r(String.fromCharCode(...o),t)));break}case"q":De(e,s,n);break;case"s":{let t=pe(e,n);o.length<=2||0===o[2]?J(s):(W(e,t.length===be(t),n,"string contains zeros"),Ae(o,46)<0&&t.length>=100?J(s):(Z(s,xe(r(String.fromCharCode(...o),ge(t)))),v(e,1)));break}default:return le(e,xe("invalid option '%%%c' to 'format'"),a[l-1])}}return _e(s),1},gmatch:function(e){let t=ae(e,1),n=ae(e,2),r=t.length,a=n.length;D(e,2);let u=new class{constructor(){this.src=NaN,this.p=NaN,this.lastmatch=NaN,this.ms=new Je}};return U(e,u),ct(u.ms,e,t,r,n,a),u.src=0,u.p=0,u.lastmatch=null,E(e,pt,3),1},gsub:function(e){let t=ae(e,1),n=t.length,r=ae(e,2),a=r.length,u=null,l=j(e,3),s=oe(e,4,n+1),o=94===r[0],i=0,c=new Je(e),_=new X;for(W(e,l===L||l===h||l===f||l===d,3,"string/function/table expected"),$(e,_),o&&(r=r.subarray(1),a--),ct(c,e,t,n,r,a),t=0,r=0;i<s;){let e;if(_t(c),null!==(e=st(c,t,r))&&e!==u)i++,Lt(c,_,t,e,l),t=u=e;else{if(!(t<c.src_end))break;z(_,c.src[t++])}if(o)break}return Y(_,c.src.subarray(t,c.src_end),c.src_end-t),_e(_),m(e,i),2},len:function(e){return m(e,ae(e,1).length),1},lower:function(e){let t=ae(e,1),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++){let n=t[e];Ie(n)&&(n|=32),r[e]=n}return I(e,r),1},match:function(e){return ft(e,0)},pack:function(e){let t=new X,n=new Ge(e),r={s:ae(e,1),off:0},a=1,u=0;for(S(e),$(e,t);r.off<r.s.length;){let l=Xe(n,u,r),s=l.opt,o=l.size,i=l.ntoalign;for(u+=i+o;i-- >0;)z(t,0);switch(a++,s){case 0:{let r=te(e,a);if(o<4){let t=1<<8*o-1;W(e,-t<=r&&r<t,a,"integer overflow")}ze(t,r,n.islittle,o,r<0);break}case 1:{let r=te(e,a);o<4&&W(e,r>>>0<1<<8*o,a,"unsigned overflow"),ze(t,r>>>0,n.islittle,o,!1);break}case 2:{let r=ce(t,o),u=ne(e,a),l=new DataView(r.buffer,r.byteOffset,r.byteLength);4===o?l.setFloat32(0,u,n.islittle):l.setFloat64(0,u,n.islittle),q(t,o);break}case 3:{let n=ae(e,a),r=n.length;for(W(e,r<=o,a,"string longer than given size"),Y(t,n,r);r++<o;)z(t,0);break}case 4:{let r=ae(e,a),l=r.length;W(e,o>=4||l<1<<8*o,a,"string length does not fit in given size"),ze(t,l,n.islittle,o,0),Y(t,r,l),u+=l;break}case 5:{let n=ae(e,a),r=n.length;W(e,Ae(n,0)<0,a,"strings contains zeros"),Y(t,n,r),z(t,0),u+=r+1;break}case 6:z(t,0);case 7:case 8:a--}}return _e(t),1},packsize:function(e){let t=new Ge(e),n={s:ae(e,1),off:0},r=0;for(;n.off<n.s.length;){let a=Xe(t,r,n),u=a.opt,l=a.size,s=a.ntoalign;switch(W(e,r<=2147483647-(l+=s),1,"format result too large"),r+=l,u){case 4:case 5:Q(e,1,"variable-length format")}}return m(e,r),1},rep:function(e){let t=ae(e,1),n=t.length,r=te(e,2),a=ie(e,3,""),u=a.length;if(r<=0)N(e,"");else{if(n+u<n||n+u>2147483647/r)return le(e,xe("resulting string too large"));{let l=r*n+(r-1)*u,s=new X,o=ee(e,s,l),i=0;for(;r-- >1;)o.set(t,i),i+=n,u>0&&(o.set(a,i),i+=u);o.set(t,i),fe(s,l)}}return 1},reverse:function(e){let t=ae(e,1),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t[n-1-e];return I(e,r),1},sub:function(e){let t=ae(e,1),n=t.length,r=Oe(te(e,2),n),a=Oe(oe(e,3,-1),n);return r<1&&(r=1),a>n&&(a=n),r<=a?I(e,t.subarray(r-1,r-1+(a-r+1))):N(e,""),1},unpack:function(e){let t=new Ge(e),n={s:ae(e,1),off:0},r=ae(e,2),a=r.length,u=Oe(oe(e,3,1),a)-1,l=0;for(W(e,u<=a&&u>=0,3,"initial position out of string");n.off<n.s.length;){let s=Xe(t,u,n),o=s.opt,i=s.size,c=s.ntoalign;switch(u+c+i>a&&Q(e,2,xe("data string too short")),u+=c,re(e,2,"too many results"),l++,o){case 0:case 1:{let n=Ye(e,r.subarray(u),t.islittle,i,0===o);m(e,n);break}case 2:{let n=qe(0,r.subarray(u),t.islittle,i);w(e,n);break}case 3:I(e,r.subarray(u,u+i));break;case 4:{let n=Ye(e,r.subarray(u),t.islittle,i,0);W(e,u+n+i<=a,2,"data string too short"),I(e,r.subarray(u+i,u+i+n)),u+=n;break}case 5:{let t=Ae(r,0,u);-1===t&&(t=r.length-u),I(e,r.subarray(u,t)),u=t+1;break}case 7:case 6:case 8:l--}u+=i}return m(e,u+1),l+1},upper:function(e){let t=ae(e,1),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++){let n=t[e];we(n)&&(n&=223),r[e]=n}return I(e,r),1}};e.exports.luaopen_string=function(e){return se(e,ht),function(e){g(e,0,1),N(e,""),y(e,-2),C(e,-2),v(e,1),y(e,-2),P(e,-2,xe("__index",!0)),v(e,1)}(e),1}},function(e,t,n){"use strict";const{lua_gettop:r,lua_pushcfunction:a,lua_pushfstring:u,lua_pushinteger:l,lua_pushnil:s,lua_pushstring:o,lua_pushvalue:i,lua_setfield:c,lua_tointeger:_}=n(2),{luaL_Buffer:f,luaL_addvalue:p,luaL_argcheck:L,luaL_buffinit:h,luaL_checkinteger:d,luaL_checkstack:A,luaL_checkstring:g,luaL_error:x,luaL_newlib:T,luaL_optinteger:b,luaL_pushresult:O}=n(7),{luastring_of:k,to_luastring:v}=n(5),E=function(e){return 128==(192&e)},m=function(e,t){return e>=0?e:0-e>t?0:t+e+1},U=[255,127,2047,65535],N=function(e,t){let n=e[t],r=0;if(n<128)r=n;else{let a=0;for(;64&n;){let u=e[t+ ++a];if(128!=(192&u))return null;r=r<<6|63&u,n<<=1}if(r|=(127&n)<<5*a,a>3||r>1114111||r<=U[a])return null;t+=a}return{code:r,pos:t+1}},R=v("%U"),S=function(e,t){let n=d(e,t);L(e,0<=n&&n<=1114111,t,"value out of range"),u(e,R,n)},w=function(e){let t=g(e,1),n=t.length,r=_(e,2)-1;if(r<0)r=0;else if(r<n)for(r++;E(t[r]);)r++;if(r>=n)return 0;{let n=N(t,r);return null===n||E(t[n.pos])?x(e,v("invalid UTF-8 code")):(l(e,r+1),l(e,n.code),2)}},I={char:function(e){let t=r(e);if(1===t)S(e,1);else{let n=new f;h(e,n);for(let r=1;r<=t;r++)S(e,r),p(n);O(n)}return 1},codepoint:function(e){let t=g(e,1),n=m(b(e,2,1),t.length),r=m(b(e,3,n),t.length);if(L(e,n>=1,2,"out of range"),L(e,r<=t.length,3,"out of range"),n>r)return 0;if(r-n>=Number.MAX_SAFE_INTEGER)return x(e,"string slice too long");let a=r-n+1;for(A(e,a,"string slice too long"),a=0,n-=1;n<r;){let r=N(t,n);if(null===r)return x(e,"invalid UTF-8 code");l(e,r.code),n=r.pos,a++}return a},codes:function(e){return g(e,1),a(e,w),i(e,1),l(e,0),3},len:function(e){let t=0,n=g(e,1),r=n.length,a=m(b(e,2,1),r),u=m(b(e,3,-1),r);for(L(e,1<=a&&--a<=r,2,"initial position out of string"),L(e,--u<r,3,"final position out of string");a<=u;){let r=N(n,a);if(null===r)return s(e),l(e,a+1),2;a=r.pos,t++}return l(e,t),1},offset:function(e){let t=g(e,1),n=d(e,2),r=n>=0?1:t.length+1;if(r=m(b(e,3,r),t.length),L(e,1<=r&&--r<=t.length,3,"position out of range"),0===n)for(;r>0&&E(t[r]);)r--;else if(E(t[r])&&x(e,"initial position is a continuation byte"),n<0)for(;n<0&&r>0;){do{r--}while(r>0&&E(t[r]));n++}else for(n--;n>0&&r<t.length;){do{r++}while(E(t[r]));n--}return 0===n?l(e,r+1):s(e),1}},y=k(91,0,45,127,194,45,244,93,91,128,45,191,93,42);e.exports.luaopen_utf8=function(e){return T(e,I),o(e,y),c(e,-2,v("charpattern",!0)),1}},function(e,t,n){"use strict";const{LUA_OPLT:r,LUA_TNUMBER:a,lua_compare:u,lua_gettop:l,lua_isinteger:s,lua_isnoneornil:o,lua_pushboolean:i,lua_pushinteger:c,lua_pushliteral:_,lua_pushnil:f,lua_pushnumber:p,lua_pushvalue:L,lua_setfield:h,lua_settop:d,lua_tointeger:A,lua_tointegerx:g,lua_type:x}=n(2),{luaL_argcheck:T,luaL_argerror:b,luaL_checkany:O,luaL_checkinteger:k,luaL_checknumber:v,luaL_error:E,luaL_newlib:m,luaL_optnumber:U}=n(7),{LUA_MAXINTEGER:N,LUA_MININTEGER:R,lua_numbertointeger:S}=n(3),{to_luastring:w}=n(5);let I;const y=function(){return I=1103515245*I+12345&2147483647},M=function(e,t){let n=S(t);!1!==n?c(e,n):p(e,t)},P={abs:function(e){if(s(e,1)){let t=A(e,1);t<0&&(t=0|-t),c(e,t)}else p(e,Math.abs(v(e,1)));return 1},acos:function(e){return p(e,Math.acos(v(e,1))),1},asin:function(e){return p(e,Math.asin(v(e,1))),1},atan:function(e){let t=v(e,1),n=U(e,2,1);return p(e,Math.atan2(t,n)),1},ceil:function(e){return s(e,1)?d(e,1):M(e,Math.ceil(v(e,1))),1},cos:function(e){return p(e,Math.cos(v(e,1))),1},deg:function(e){return p(e,v(e,1)*(180/Math.PI)),1},exp:function(e){return p(e,Math.exp(v(e,1))),1},floor:function(e){return s(e,1)?d(e,1):M(e,Math.floor(v(e,1))),1},fmod:function(e){if(s(e,1)&&s(e,2)){let t=A(e,2);0===t?b(e,2,"zero"):c(e,A(e,1)%t|0)}else{let t=v(e,1),n=v(e,2);p(e,t%n)}return 1},log:function(e){let t,n=v(e,1);if(o(e,2))t=Math.log(n);else{let r=v(e,2);t=2===r?Math.log2(n):10===r?Math.log10(n):Math.log(n)/Math.log(r)}return p(e,t),1},max:function(e){let t=l(e),n=1;T(e,t>=1,1,"value expected");for(let a=2;a<=t;a++)u(e,n,a,r)&&(n=a);return L(e,n),1},min:function(e){let t=l(e),n=1;T(e,t>=1,1,"value expected");for(let a=2;a<=t;a++)u(e,a,n,r)&&(n=a);return L(e,n),1},modf:function(e){if(s(e,1))d(e,1),p(e,0);else{let t=v(e,1),n=t<0?Math.ceil(t):Math.floor(t);M(e,n),p(e,t===n?0:t-n)}return 2},rad:function(e){return p(e,v(e,1)*(Math.PI/180)),1},random:function(e){let t,n,r=void 0===I?Math.random():y()/2147483648;switch(l(e)){case 0:return p(e,r),1;case 1:t=1,n=k(e,1);break;case 2:t=k(e,1),n=k(e,2);break;default:return E(e,"wrong number of arguments")}return T(e,t<=n,1,"interval is empty"),T(e,t>=0||n<=N+t,1,"interval too large"),r*=n-t+1,c(e,Math.floor(r)+t),1},randomseed:function(e){return function(e){0==(I=0|e)&&(I=1)}(v(e,1)),y(),0},sin:function(e){return p(e,Math.sin(v(e,1))),1},sqrt:function(e){return p(e,Math.sqrt(v(e,1))),1},tan:function(e){return p(e,Math.tan(v(e,1))),1},tointeger:function(e){let t=g(e,1);return!1!==t?c(e,t):(O(e,1),f(e)),1},type:function(e){return x(e,1)===a?s(e,1)?_(e,"integer"):_(e,"float"):(O(e,1),f(e)),1},ult:function(e){let t=k(e,1),n=k(e,2);return i(e,t>=0?n<0||t<n:n<0&&t<n),1}};e.exports.luaopen_math=function(e){return m(e,P),p(e,Math.PI),h(e,-2,w("pi",!0)),p(e,1/0),h(e,-2,w("huge",!0)),c(e,N),h(e,-2,w("maxinteger",!0)),c(e,R),h(e,-2,w("mininteger",!0)),1}},function(e,t,n){"use strict";const{LUA_MASKCALL:r,LUA_MASKCOUNT:a,LUA_MASKLINE:u,LUA_MASKRET:l,LUA_REGISTRYINDEX:s,LUA_TFUNCTION:o,LUA_TNIL:i,LUA_TTABLE:c,LUA_TUSERDATA:_,lua_Debug:f,lua_call:p,lua_checkstack:L,lua_gethook:h,lua_gethookcount:d,lua_gethookmask:A,lua_getinfo:g,lua_getlocal:x,lua_getmetatable:T,lua_getstack:b,lua_getupvalue:O,lua_getuservalue:k,lua_insert:v,lua_iscfunction:E,lua_isfunction:m,lua_isnoneornil:U,lua_isthread:N,lua_newtable:R,lua_pcall:S,lua_pop:w,lua_pushboolean:I,lua_pushfstring:y,lua_pushinteger:M,lua_pushlightuserdata:P,lua_pushliteral:C,lua_pushnil:D,lua_pushstring:V,lua_pushvalue:B,lua_rawgetp:G,lua_rawsetp:K,lua_rotate:F,lua_setfield:j,lua_sethook:H,lua_setlocal:X,lua_setmetatable:z,lua_settop:Y,lua_setupvalue:q,lua_setuservalue:Z,lua_tojsstring:J,lua_toproxy:W,lua_tostring:Q,lua_tothread:$,lua_touserdata:ee,lua_type:te,lua_upvalueid:ne,lua_upvaluejoin:re,lua_xmove:ae}=n(2),{luaL_argcheck:ue,luaL_argerror:le,luaL_checkany:se,luaL_checkinteger:oe,luaL_checkstring:ie,luaL_checktype:ce,luaL_error:_e,luaL_loadbuffer:fe,luaL_newlib:pe,luaL_optinteger:Le,luaL_optstring:he,luaL_traceback:de,lua_writestringerror:Ae}=n(7),ge=n(17),{luastring_indexOf:xe,to_luastring:Te}=n(5),be=function(e,t,n){e===t||L(t,n)||_e(e,Te("stack overflow",!0))},Oe=function(e){return N(e,1)?{arg:1,thread:$(e,1)}:{arg:0,thread:e}},ke=function(e,t,n){V(e,n),j(e,-2,t)},ve=function(e,t,n){M(e,n),j(e,-2,t)},Ee=function(e,t,n){I(e,n),j(e,-2,t)},me=function(e,t,n){e==t?F(e,-2,1):ae(t,e,1),j(e,-2,n)},Ue=function(e,t){let n=oe(e,2);ce(e,1,o);let r=t?O(e,1,n):q(e,1,n);return null===r?0:(V(e,r),v(e,-(t+1)),t+1)},Ne=function(e,t,n){let r=oe(e,n);return ce(e,t,o),ue(e,null!==O(e,t,r),n,"invalid upvalue index"),r},Re=Te("__hooks__",!0),Se=["call","return","line","count","tail call"].map(e=>Te(e)),we=function(e,t){G(e,s,Re);let n=ee(e,-1).get(e);n&&(n(e),V(e,Se[t.event]),t.currentline>=0?M(e,t.currentline):D(e),ge.lua_assert(g(e,Te("lS"),t)),p(e,2,0))},Ie={gethook:function(e){let t=Oe(e).thread,n=new Uint8Array(5),a=A(t),o=h(t);return null===o?D(e):o!==we?C(e,"external hook"):(G(e,s,Re),ee(e,-1).get(t)(e)),V(e,function(e,t){let n=0;return e&r&&(t[n++]=99),e&l&&(t[n++]=114),e&u&&(t[n++]=108),t.subarray(0,n)}(a,n)),M(e,d(t)),3},getinfo:function(e){let t=new f,n=Oe(e),r=n.arg,a=n.thread,u=he(e,r+2,"flnStu");if(be(e,a,3),m(e,r+1))u=y(e,Te(">%s"),u),B(e,r+1),ae(e,a,1);else if(!b(a,oe(e,r+1),t))return D(e),1;return g(a,u,t)||le(e,r+2,"invalid option"),R(e),xe(u,83)>-1&&(ke(e,Te("source",!0),t.source),ke(e,Te("short_src",!0),t.short_src),ve(e,Te("linedefined",!0),t.linedefined),ve(e,Te("lastlinedefined",!0),t.lastlinedefined),ke(e,Te("what",!0),t.what)),xe(u,108)>-1&&ve(e,Te("currentline",!0),t.currentline),xe(u,117)>-1&&(ve(e,Te("nups",!0),t.nups),ve(e,Te("nparams",!0),t.nparams),Ee(e,Te("isvararg",!0),t.isvararg)),xe(u,110)>-1&&(ke(e,Te("name",!0),t.name),ke(e,Te("namewhat",!0),t.namewhat)),xe(u,116)>-1&&Ee(e,Te("istailcall",!0),t.istailcall),xe(u,76)>-1&&me(e,a,Te("activelines",!0)),xe(u,102)>-1&&me(e,a,Te("func",!0)),1},getlocal:function(e){let t=Oe(e),n=t.thread,r=t.arg,a=new f,u=oe(e,r+2);if(m(e,r+1))return B(e,r+1),V(e,x(e,null,u)),1;{let t=oe(e,r+1);if(!b(n,t,a))return le(e,r+1,"level out of range");be(e,n,1);let l=x(n,a,u);return l?(ae(n,e,1),V(e,l),F(e,-2,1),2):(D(e),1)}},getmetatable:function(e){return se(e,1),T(e,1)||D(e),1},getregistry:function(e){return B(e,s),1},getupvalue:function(e){return Ue(e,1)},getuservalue:function(e){return te(e,1)!==_?D(e):k(e,1),1},sethook:function(e){let t,n,c,_,f=Oe(e),p=f.thread,L=f.arg;if(U(e,L+1))Y(e,L+1),c=null,t=0,n=0;else{const s=ie(e,L+2);ce(e,L+1,o),n=Le(e,L+3,0),c=we,t=function(e,t){let n=0;return xe(e,99)>-1&&(n|=r),xe(e,114)>-1&&(n|=l),xe(e,108)>-1&&(n|=u),t>0&&(n|=a),n}(s,n)}G(e,s,Re)===i?(_=new WeakMap,P(e,_),K(e,s,Re)):_=ee(e,-1);let h=W(e,L+1);return _.set(p,h),H(p,c,t,n),0},setlocal:function(e){let t=Oe(e),n=t.thread,r=t.arg,a=new f,u=oe(e,r+1),l=oe(e,r+2);if(!b(n,u,a))return le(e,r+1,"level out of range");se(e,r+3),Y(e,r+3),be(e,n,1),ae(e,n,1);let s=X(n,a,l);return null===s&&w(n,1),V(e,s),1},setmetatable:function(e){const t=te(e,2);return ue(e,t==i||t==c,2,"nil or table expected"),Y(e,2),z(e,1),1},setupvalue:function(e){return se(e,3),Ue(e,0)},setuservalue:function(e){return ce(e,1,_),se(e,2),Y(e,2),Z(e,1),1},traceback:function(e){let t=Oe(e),n=t.thread,r=t.arg,a=Q(e,r+1);if(null!==a||U(e,r+1)){let t=Le(e,r+2,e===n?1:0);de(e,n,a,t)}else B(e,r+1);return 1},upvalueid:function(e){let t=Ne(e,1,2);return P(e,ne(e,1,t)),1},upvaluejoin:function(e){let t=Ne(e,1,2),n=Ne(e,3,4);return ue(e,!E(e,1),1,"Lua function expected"),ue(e,!E(e,3),3,"Lua function expected"),re(e,1,t,3,n),0}};let ye;"undefined"!=typeof window&&(ye=function(){let e=prompt("lua_debug>","");return null!==e?e:""}),ye&&(Ie.debug=function(e){for(;;){let t=ye();if("cont"===t)return 0;if(0===t.length)continue;let n=Te(t);(fe(e,n,n.length,Te("=(debug command)",!0))||S(e,0,0,0))&&Ae(J(e,-1),"\n"),Y(e,0)}}),e.exports.luaopen_debug=function(e){return pe(e,Ie),1}},function(e,t,n){"use strict";const{LUA_DIRSEP:r,LUA_EXEC_DIR:a,LUA_JSPATH_DEFAULT:u,LUA_PATH_DEFAULT:l,LUA_PATH_MARK:s,LUA_PATH_SEP:o}=n(3),{LUA_OK:i,LUA_REGISTRYINDEX:c,LUA_TNIL:_,LUA_TTABLE:f,lua_callk:p,lua_createtable:L,lua_getfield:h,lua_insert:d,lua_isfunction:A,lua_isnil:g,lua_isstring:x,lua_newtable:T,lua_pop:b,lua_pushboolean:O,lua_pushcclosure:k,lua_pushcfunction:v,lua_pushfstring:E,lua_pushglobaltable:m,lua_pushlightuserdata:U,lua_pushliteral:N,lua_pushlstring:R,lua_pushnil:S,lua_pushstring:w,lua_pushvalue:I,lua_rawgeti:y,lua_rawgetp:M,lua_rawseti:P,lua_rawsetp:C,lua_remove:D,lua_setfield:V,lua_setmetatable:B,lua_settop:G,lua_toboolean:K,lua_tostring:F,lua_touserdata:j,lua_upvalueindex:H}=n(2),{LUA_LOADED_TABLE:X,LUA_PRELOAD_TABLE:z,luaL_Buffer:Y,luaL_addvalue:q,luaL_buffinit:Z,luaL_checkstring:J,luaL_error:W,luaL_getsubtable:Q,luaL_gsub:$,luaL_len:ee,luaL_loadfile:te,luaL_newlib:ne,luaL_optstring:re,luaL_pushresult:ae,luaL_setfuncs:ue}=n(7),le=n(17),{luastring_indexOf:se,to_jsstring:oe,to_luastring:ie,to_uristring:ce}=n(5),_e=n(0),fe="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this"),pe=ie("__JSLIBS__"),Le=r,he=r,de=ie("luaopen_"),Ae=ie("_"),ge=ie("");let xe,Te;xe=function(e,t,n){t=ce(t);let r=new XMLHttpRequest;if(r.open("GET",t,!1),r.send(),r.status<200||r.status>=300)return w(e,ie(`${r.status}: ${r.statusText}`)),null;let a,u=r.response;/\/\/[#@] sourceURL=/.test(u)||(u+=" //# sourceURL="+t);try{a=Function("fengari",u)}catch(t){return w(e,ie(`${t.name}: ${t.message}`)),null}let l=a(_e);return"function"==typeof l||"object"==typeof l&&null!==l?l:void 0===l?fe:(w(e,ie(`library returned unexpected type (${typeof l})`)),null)},Te=function(e){e=ce(e);let t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t.status>=200&&t.status<=299};const be=function(e,t,n){let r=ve(e,t);if(null===r){if(null===(r=xe(e,t,(n[0],"*".charCodeAt(0)))))return 1;Ee(e,t,r)}if(n[0]==="*".charCodeAt(0))return O(e,1),0;{let t=function(e,t,n){let r=t[oe(n)];return r&&"function"==typeof r?r:(E(e,ie("undefined symbol: %s"),n),null)}(e,r,n);return null===t?2:(v(e,t),0)}},Oe=fe,ke=function(e,t,n,r){let a=`${n}${le.LUA_VERSUFFIX}`;w(e,ie(a));let u=Oe[a];void 0===u&&(u=Oe[n]),void 0===u||function(e){h(e,c,ie("LUA_NOENV"));let t=K(e,-1);return b(e,1),t}(e)?w(e,r):(u=$(e,ie(u),ie(o+o,!0),ie(o+oe(ge)+o,!0)),$(e,u,ge,r),D(e,-2)),V(e,-3,t),b(e,1)},ve=function(e,t){M(e,c,pe),h(e,-1,t);let n=j(e,-1);return b(e,2),n},Ee=function(e,t,n){M(e,c,pe),U(e,n),I(e,-1),V(e,-3,t),P(e,-2,ee(e,-2)+1),b(e,1)},me=function(e,t){for(;t[0]===o.charCodeAt(0);)t=t.subarray(1);if(0===t.length)return null;let n=se(t,o.charCodeAt(0));return n<0&&(n=t.length),R(e,t,n),t.subarray(n)},Ue=function(e,t,n,r,a){let u=new Y;for(Z(e,u),0!==r[0]&&(t=$(e,t,r,a));null!==(n=me(e,n));){let n=$(e,F(e,-1),ie(s,!0),t);if(D(e,-2),Te(n))return n;E(e,ie("\n\tno file '%s'"),n),D(e,-2),q(u)}return ae(u),null},Ne=function(e,t,n,r){h(e,H(1),n);let a=F(e,-1);return null===a&&W(e,ie("'package.%s' must be a string"),n),Ue(e,t,a,ie("."),r)},Re=function(e,t,n){return t?(w(e,n),2):W(e,ie("error loading module '%s' from file '%s':\n\t%s"),F(e,1),n,F(e,-1))},Se=function(e){let t=J(e,1),n=Ne(e,t,ie("path",!0),ie(he,!0));return null===n?1:Re(e,te(e,n)===i,n)},we=function(e,t,n){let r;n=$(e,n,ie("."),Ae);let a=se(n,"-".charCodeAt(0));if(a>=0){r=R(e,n,a),r=E(e,ie("%s%s"),de,r);let u=be(e,t,r);if(2!==u)return u;n=a+1}return r=E(e,ie("%s%s"),de,n),be(e,t,r)},Ie=function(e){let t=J(e,1),n=Ne(e,t,ie("jspath",!0),ie(Le,!0));return null===n?1:Re(e,0===we(e,n,t),n)},ye=function(e){let t,n=J(e,1),r=se(n,".".charCodeAt(0));if(r<0)return 0;R(e,n,r);let a=Ne(e,F(e,-1),ie("jspath",!0),ie(Le,!0));return null===a?1:0!==(t=we(e,a,n))?2!=t?Re(e,0,a):(w(e,ie("\n\tno module '%s' in file '%s'"),n,a),1):(w(e,a),2)},Me=function(e){let t=J(e,1);return h(e,c,z),h(e,-1,t)===_&&E(e,ie("\n\tno field package.preload['%s']"),t),1},Pe=function(e,t,n){for(;t===i?(y(e,3,n.i)===_&&(b(e,1),ae(n.msg),W(e,ie("module '%s' not found:%s"),n.name,F(e,-1))),w(e,n.name),p(e,1,2,n,Pe)):t=i,!A(e,-2);n.i++)x(e,-2)?(b(e,1),q(n.msg)):b(e,2);return n.k(e,i,n.ctx)},Ce=function(e,t,n){return w(e,n),d(e,-2),p(e,2,1,n,De),De(e,i,n)},De=function(e,t,n){let r=n;return g(e,-1)||V(e,2,r),h(e,2,r)==_&&(O(e,1),I(e,-1),V(e,2,r)),1},Ve={loadlib:function(e){let t=J(e,1),n=J(e,2),r=be(e,t,n);return 0===r?1:(S(e),d(e,-2),N(e,1===r?"open":"init"),3)},searchpath:function(e){return null!==Ue(e,J(e,1),J(e,2),re(e,3,"."),re(e,4,r))?1:(S(e),d(e,-2),2)}},Be={require:function(e){let t=J(e,1);return G(e,1),h(e,c,X),h(e,2,t),K(e,-1)?1:(b(e,1),function(e,t,n,r){let a=new Y;return Z(e,a),h(e,H(1),ie("searchers",!0))!==f&&W(e,ie("'package.searchers' must be a table")),Pe(e,i,{name:t,i:1,msg:a,ctx:n,k:r})}(e,t,t,Ce))}};e.exports.luaopen_package=function(e){return function(e){T(e),L(e,0,1),B(e,-2),C(e,c,pe)}(e),ne(e,Ve),function(e){let t=[Me,Se,Ie,ye,null];L(e);for(let n=0;t[n];n++)I(e,-2),k(e,t[n],1),P(e,-2,n+1);V(e,-2,ie("searchers",!0))}(e),ke(e,ie("path",!0),"LUA_PATH",l),ke(e,ie("jspath",!0),"LUA_JSPATH",u),N(e,r+"\n"+o+"\n"+s+"\n"+a+"\n-\n"),V(e,-2,ie("config",!0)),Q(e,c,X),V(e,-2,ie("loaded",!0)),Q(e,c,z),V(e,-2,ie("preload",!0)),m(e),I(e,-2),ue(e,Be,1),b(e,1),1}},function(e,t,n){const{lua_pushinteger:r,lua_pushliteral:a,lua_setfield:u}=n(2),{luaL_newlib:l}=n(7),{FENGARI_AUTHORS:s,FENGARI_COPYRIGHT:o,FENGARI_RELEASE:i,FENGARI_VERSION:c,FENGARI_VERSION_MAJOR:_,FENGARI_VERSION_MINOR:f,FENGARI_VERSION_NUM:p,FENGARI_VERSION_RELEASE:L,to_luastring:h}=n(5);e.exports.luaopen_fengari=function(e){return l(e,{}),a(e,s),u(e,-2,h("AUTHORS")),a(e,o),u(e,-2,h("COPYRIGHT")),a(e,i),u(e,-2,h("RELEASE")),a(e,c),u(e,-2,h("VERSION")),a(e,_),u(e,-2,h("VERSION_MAJOR")),a(e,f),u(e,-2,h("VERSION_MINOR")),r(e,p),u(e,-2,h("VERSION_NUM")),a(e,L),u(e,-2,h("VERSION_RELEASE")),1}},function(e,t,n){"use strict";n.r(t),n.d(t,"L",function(){return R}),n.d(t,"load",function(){return S});var r=n(0);n.d(t,"FENGARI_AUTHORS",function(){return r.FENGARI_AUTHORS}),n.d(t,"FENGARI_COPYRIGHT",function(){return r.FENGARI_COPYRIGHT}),n.d(t,"FENGARI_RELEASE",function(){return r.FENGARI_RELEASE}),n.d(t,"FENGARI_VERSION",function(){return r.FENGARI_VERSION}),n.d(t,"FENGARI_VERSION_MAJOR",function(){return r.FENGARI_VERSION_MAJOR}),n.d(t,"FENGARI_VERSION_MINOR",function(){return r.FENGARI_VERSION_MINOR}),n.d(t,"FENGARI_VERSION_NUM",function(){return r.FENGARI_VERSION_NUM}),n.d(t,"FENGARI_VERSION_RELEASE",function(){return r.FENGARI_VERSION_RELEASE}),n.d(t,"luastring_eq",function(){return r.luastring_eq}),n.d(t,"luastring_indexOf",function(){return r.luastring_indexOf}),n.d(t,"luastring_of",function(){return r.luastring_of}),n.d(t,"to_jsstring",function(){return r.to_jsstring}),n.d(t,"to_luastring",function(){return r.to_luastring}),n.d(t,"to_uristring",function(){return r.to_uristring}),n.d(t,"lua",function(){return r.lua}),n.d(t,"lauxlib",function(){return r.lauxlib}),n.d(t,"lualib",function(){return r.lualib});var a=n(21);n.d(t,"interop",function(){return a});const{LUA_ERRRUN:u,LUA_ERRSYNTAX:l,LUA_OK:s,LUA_VERSION_MAJOR:o,LUA_VERSION_MINOR:i,lua_Debug:c,lua_getinfo:_,lua_getstack:f,lua_gettop:p,lua_insert:L,lua_pcall:h,lua_pop:d,lua_pushcfunction:A,lua_pushstring:g,lua_remove:x,lua_setglobal:T,lua_tojsstring:b}=r.lua,{luaL_loadbuffer:O,luaL_newstate:k,luaL_requiref:v}=r.lauxlib,{checkjs:E,luaopen_js:m,push:U,tojs:N}=a,R=k();function S(e,t){if("string"==typeof e)e=Object(r.to_luastring)(e);else if(!(e instanceof Uint8Array))throw new TypeError("expects an array of bytes or javascript string");t=t?Object(r.to_luastring)(t):null;let n,a=O(R,e,null,t);if(n=a===l?new SyntaxError(b(R,-1)):N(R,-1),d(R,1),a!==s)throw n;return n}if(r.lualib.luaL_openlibs(R),v(R,Object(r.to_luastring)("js"),m,1),d(R,1),g(R,Object(r.to_luastring)(r.FENGARI_COPYRIGHT)),T(R,Object(r.to_luastring)("_COPYRIGHT")),"undefined"!=typeof document&&document instanceof HTMLDocument){const e=function(e){switch(e){case"anonymous":return"omit";case"use-credentials":return"include";default:return"same-origin"}},t=function(e){let t=new c;return f(e,2,t)&&_(e,Object(r.to_luastring)("Sl"),t),U(e,new ErrorEvent("error",{bubbles:!0,cancelable:!0,message:b(e,1),error:N(e,1),filename:t.short_src?Object(r.to_jsstring)(t.short_src):void 0,lineno:t.currentline>0?t.currentline:void 0})),1},n=function(e,n,r){let a,o=O(R,n,null,r);if(o===l){let t=b(R,-1),n=e.src?e.src:document.location,r=void 0,u=new SyntaxError(t,n,r);a=new ErrorEvent("error",{message:t,error:u,filename:n,lineno:r})}else if(o===s){let n=p(R);A(R,t),L(R,n),Object.defineProperty(document,"currentScript",{value:e,configurable:!0}),o=h(R,0,0,n),delete document.currentScript,x(R,n),o===u&&(a=E(R,-1))}o!==s&&(void 0===a&&(a=new ErrorEvent("error",{message:b(R,-1),error:N(R,-1)})),d(R,1),window.dispatchEvent(a)&&console.error("uncaught exception",a.error))},a=function(e,t,a){if(e.status>=200&&e.status<300){let u=e.response;u="string"==typeof u?Object(r.to_luastring)(e.response):new Uint8Array(u),n(t,u,a)}else t.dispatchEvent(new Event("error"))},g=function(t){if(t.src){let u=Object(r.to_luastring)("@"+t.src);if("complete"===document.readyState||t.async)if("function"==typeof fetch)fetch(t.src,{method:"GET",credentials:e(t.crossorigin),redirect:"follow",integrity:t.integrity}).then(function(e){if(e.ok)return e.arrayBuffer();throw new Error("unable to fetch")}).then(function(e){let r=new Uint8Array(e);n(t,r,u)}).catch(function(e){t.dispatchEvent(new Event("error"))});else{let e=new XMLHttpRequest;e.open("GET",t.src,!0),e.responseType="arraybuffer",e.onreadystatechange=function(){4===e.readyState&&a(e,t,u)},e.send()}else{let e=new XMLHttpRequest;e.open("GET",t.src,!1),e.send(),a(e,t,u)}}else{let e=Object(r.to_luastring)(t.innerHTML),a=t.id?Object(r.to_luastring)("="+t.id):e;n(t,e,a)}},T=/^(.*?\/.*?)([\t ]*;.*)?$/,k=/^(\d+)\.(\d+)$/,v=function(e){if("SCRIPT"!==e.tagName)return;let t=T.exec(e.type);if(!t)return;let n=t[1];if("application/lua"===n||"text/lua"===n){if(e.hasAttribute("lua-version")){let t=k.exec(e.getAttribute("lua-version"));if(!t||t[1]!==o||t[2]!==i)return}g(e)}};"undefined"!=typeof MutationObserver?new MutationObserver(function(e,t){for(let t=0;t<e.length;t++){let n=e[t];for(let e=0;e<n.addedNodes.length;e++)v(n.addedNodes[e])}}).observe(document,{childList:!0,subtree:!0}):console.warn&&console.warn("fengari-web: MutationObserver not found; lua script tags will not be run when inserted");const m='script[type^="application/lua"], script[type^="text/lua"]';Array.prototype.forEach.call(document.querySelectorAll(m),v)}},function(e,t,n){"use strict";const{LUA_MULTRET:r,LUA_OPADD:a,LUA_OPBAND:u,LUA_OPBNOT:l,LUA_OPBOR:s,LUA_OPBXOR:o,LUA_OPDIV:i,LUA_OPIDIV:c,LUA_OPMOD:_,LUA_OPSHL:f,LUA_OPSHR:p,LUA_OPUNM:L,constant_types:{LUA_TBOOLEAN:h,LUA_TLIGHTUSERDATA:d,LUA_TLNGSTR:A,LUA_TNIL:g,LUA_TNUMFLT:x,LUA_TNUMINT:T,LUA_TTABLE:b},to_luastring:O}=n(1),{lua_assert:k}=n(4),v=n(20),E=n(6),m=n(16),U=n(23),N=n(9),R=n(15),S=m.OpCodesI,w=E.TValue,I={OPR_ADD:0,OPR_SUB:1,OPR_MUL:2,OPR_MOD:3,OPR_POW:4,OPR_DIV:5,OPR_IDIV:6,OPR_BAND:7,OPR_BOR:8,OPR_BXOR:9,OPR_SHL:10,OPR_SHR:11,OPR_CONCAT:12,OPR_EQ:13,OPR_LT:14,OPR_LE:15,OPR_NE:16,OPR_GT:17,OPR_GE:18,OPR_AND:19,OPR_OR:20,OPR_NOBINOPR:21},y={OPR_MINUS:0,OPR_BNOT:1,OPR_NOT:2,OPR_LEN:3,OPR_NOUNOPR:4},M=function(e){return e.t!==e.f},P=function(e,t){let n=U.expkind;if(M(e))return!1;switch(e.k){case n.VKINT:return!t||new w(T,e.u.ival);case n.VKFLT:return!t||new w(x,e.u.nval);default:return!1}},C=function(e,t,n){let r,a=t+n-1;if(e.pc>e.lasttarget&&(r=e.f.code[e.pc-1]).opcode===S.OP_LOADNIL){let e=r.A,n=e+r.B;if(e<=t&&t<=n+1||t<=e&&e<=a+1)return e<t&&(t=e),n>a&&(a=n),m.SETARG_A(r,t),void m.SETARG_B(r,a-t)}Q(e,S.OP_LOADNIL,t,n-1,0)},D=function(e,t){return e.f.code[t.u.info]},V=function(e,t){let n=e.f.code[t].sBx;return-1===n?-1:t+1+n},B=function(e,t,n){let r=e.f.code[t],a=n-(t+1);k(-1!==n),Math.abs(a)>m.MAXARG_sBx&&v.luaX_syntaxerror(e.ls,O("control structure too long",!0)),m.SETARG_sBx(r,a)},G=function(e,t,n){if(-1===n)return t;if(-1===t)t=n;else{let r=t,a=V(e,r);for(;-1!==a;)a=V(e,r=a);B(e,r,n)}return t},K=function(e){let t=e.jpc;e.jpc=-1;let n=ee(e,S.OP_JMP,0,-1);return G(e,n,t)},F=function(e,t,n,r,a){return Q(e,t,n,r,a),K(e)},j=function(e){return e.lasttarget=e.pc,e.pc},H=function(e,t){return t>=1&&m.testTMode(e.f.code[t-1].opcode)?t-1:t},X=function(e,t){return e.f.code[H(e,t)]},z=function(e,t,n){let r=H(e,t),a=e.f.code[r];return a.opcode===S.OP_TESTSET&&(n!==m.NO_REG&&n!==a.B?m.SETARG_A(a,n):e.f.code[r]=m.CREATE_ABC(S.OP_TEST,a.B,0,a.C),!0)},Y=function(e,t){for(;-1!==t;t=V(e,t))z(e,t,m.NO_REG)},q=function(e,t,n,r,a){for(;-1!==t;){let u=V(e,t);z(e,t,r)?B(e,t,n):B(e,t,a),t=u}},Z=function(e,t){j(e),e.jpc=G(e,e.jpc,t)},J=function(e,t,n){n===e.pc?Z(e,t):(k(n<e.pc),q(e,t,n,m.NO_REG,n))},W=function(e,t){let n=e.f;return function(e){q(e,e.jpc,e.pc,m.NO_REG,e.pc),e.jpc=-1}(e),n.code[e.pc]=t,n.lineinfo[e.pc]=e.ls.lastline,e.pc++},Q=function(e,t,n,r,a){return k(m.getOpMode(t)===m.iABC),k(m.getBMode(t)!==m.OpArgN||0===r),k(m.getCMode(t)!==m.OpArgN||0===a),k(n<=m.MAXARG_A&&r<=m.MAXARG_B&&a<=m.MAXARG_C),W(e,m.CREATE_ABC(t,n,r,a))},$=function(e,t,n,r){return k(m.getOpMode(t)===m.iABx||m.getOpMode(t)===m.iAsBx),k(m.getCMode(t)===m.OpArgN),k(n<=m.MAXARG_A&&r<=m.MAXARG_Bx),W(e,m.CREATE_ABx(t,n,r))},ee=function(e,t,n,r){return $(e,t,n,r+m.MAXARG_sBx)},te=function(e,t){return k(t<=m.MAXARG_Ax),W(e,m.CREATE_Ax(S.OP_EXTRAARG,t))},ne=function(e,t,n){if(n<=m.MAXARG_Bx)return $(e,S.OP_LOADK,t,n);{let r=$(e,S.OP_LOADKX,t,0);return te(e,n),r}},re=function(e,t){let n=e.freereg+t;n>e.f.maxstacksize&&(n>=255&&v.luaX_syntaxerror(e.ls,O("function or expression needs too many registers",!0)),e.f.maxstacksize=n)},ae=function(e,t){re(e,t),e.freereg+=t},ue=function(e,t){!m.ISK(t)&&t>=e.nactvar&&(e.freereg--,k(t===e.freereg))},le=function(e,t){t.k===U.expkind.VNONRELOC&&ue(e,t.u.info)},se=function(e,t,n){let r=t.k===U.expkind.VNONRELOC?t.u.info:-1,a=n.k===U.expkind.VNONRELOC?n.u.info:-1;r>a?(ue(e,r),ue(e,a)):(ue(e,a),ue(e,r))},oe=function(e,t,n){let r=e.f,a=N.luaH_get(e.L,e.ls.h,t);if(a.ttisinteger()){let t=a.value;if(t<e.nk&&r.k[t].ttype()===n.ttype()&&r.k[t].value===n.value)return t}let u=e.nk;return N.luaH_setfrom(e.L,e.ls.h,t,new E.TValue(T,u)),r.k[u]=n,e.nk++,u},ie=function(e,t){let n=new w(d,t),r=new w(T,t);return oe(e,n,r)},ce=function(e,t){let n=new w(x,t);return oe(e,n,n)},_e=function(e,t){let n=new w(h,t);return oe(e,n,n)},fe=function(e,t,n){let a=U.expkind;if(t.k===a.VCALL)m.SETARG_C(D(e,t),n+1);else if(t.k===a.VVARARG){let r=D(e,t);m.SETARG_B(r,n+1),m.SETARG_A(r,e.freereg),ae(e,1)}else k(n===r)},pe=function(e,t){let n=U.expkind;t.k===n.VCALL?(k(2===D(e,t).C),t.k=n.VNONRELOC,t.u.info=D(e,t).A):t.k===n.VVARARG&&(m.SETARG_B(D(e,t),2),t.k=n.VRELOCABLE)},Le=function(e,t){let n=U.expkind;switch(t.k){case n.VLOCAL:t.k=n.VNONRELOC;break;case n.VUPVAL:t.u.info=Q(e,S.OP_GETUPVAL,0,t.u.info,0),t.k=n.VRELOCABLE;break;case n.VINDEXED:{let r;ue(e,t.u.ind.idx),t.u.ind.vt===n.VLOCAL?(ue(e,t.u.ind.t),r=S.OP_GETTABLE):(k(t.u.ind.vt===n.VUPVAL),r=S.OP_GETTABUP),t.u.info=Q(e,r,0,t.u.ind.t,t.u.ind.idx),t.k=n.VRELOCABLE;break}case n.VVARARG:case n.VCALL:pe(e,t)}},he=function(e,t,n,r){return j(e),Q(e,S.OP_LOADBOOL,t,n,r)},de=function(e,t,n){let r=U.expkind;switch(Le(e,t),t.k){case r.VNIL:C(e,n,1);break;case r.VFALSE:case r.VTRUE:Q(e,S.OP_LOADBOOL,n,t.k===r.VTRUE,0);break;case r.VK:ne(e,n,t.u.info);break;case r.VKFLT:ne(e,n,ce(e,t.u.nval));break;case r.VKINT:ne(e,n,ie(e,t.u.ival));break;case r.VRELOCABLE:{let r=D(e,t);m.SETARG_A(r,n);break}case r.VNONRELOC:n!==t.u.info&&Q(e,S.OP_MOVE,n,t.u.info,0);break;default:return void k(t.k===r.VJMP)}t.u.info=n,t.k=r.VNONRELOC},Ae=function(e,t){t.k!==U.expkind.VNONRELOC&&(ae(e,1),de(e,t,e.freereg-1))},ge=function(e,t){for(;-1!==t;t=V(e,t))if(X(e,t).opcode!==S.OP_TESTSET)return!0;return!1},xe=function(e,t,n){let r=U.expkind;if(de(e,t,n),t.k===r.VJMP&&(t.t=G(e,t.t,t.u.info)),M(t)){let a,u=-1,l=-1;if(ge(e,t.t)||ge(e,t.f)){let a=t.k===r.VJMP?-1:K(e);u=he(e,n,0,1),l=he(e,n,1,0),Z(e,a)}a=j(e),q(e,t.f,a,n,u),q(e,t.t,a,n,l)}t.f=t.t=-1,t.u.info=n,t.k=r.VNONRELOC},Te=function(e,t){Le(e,t),le(e,t),ae(e,1),xe(e,t,e.freereg-1)},be=function(e,t){if(Le(e,t),t.k===U.expkind.VNONRELOC){if(!M(t))return t.u.info;if(t.u.info>=e.nactvar)return xe(e,t,t.u.info),t.u.info}return Te(e,t),t.u.info},Oe=function(e,t){M(t)?be(e,t):Le(e,t)},ke=function(e,t){let n=U.expkind,r=!1;switch(Oe(e,t),t.k){case n.VTRUE:t.u.info=_e(e,!0),r=!0;break;case n.VFALSE:t.u.info=_e(e,!1),r=!0;break;case n.VNIL:t.u.info=function(e){let t=new w(g,null),n=new w(b,e.ls.h);return oe(e,n,t)}(e),r=!0;break;case n.VKINT:t.u.info=ie(e,t.u.ival),r=!0;break;case n.VKFLT:t.u.info=ce(e,t.u.nval),r=!0;break;case n.VK:r=!0}return r&&(t.k=n.VK,t.u.info<=m.MAXINDEXRK)?m.RKASK(t.u.info):be(e,t)},ve=function(e,t){let n=X(e,t.u.info);k(m.testTMode(n.opcode)&&n.opcode!==S.OP_TESTSET&&n.opcode!==S.OP_TEST),m.SETARG_A(n,!n.A)},Ee=function(e,t,n){if(t.k===U.expkind.VRELOCABLE){let r=D(e,t);if(r.opcode===S.OP_NOT)return e.pc--,F(e,S.OP_TEST,r.B,0,!n)}return Ae(e,t),le(e,t),F(e,S.OP_TESTSET,m.NO_REG,t.u.info,n)},me=function(e,t){let n,r=U.expkind;switch(Le(e,t),t.k){case r.VJMP:ve(e,t),n=t.u.info;break;case r.VK:case r.VKFLT:case r.VKINT:case r.VTRUE:n=-1;break;default:n=Ee(e,t,0)}t.f=G(e,t.f,n),Z(e,t.t),t.t=-1},Ue=function(e,t){let n,r=U.expkind;switch(Le(e,t),t.k){case r.VJMP:n=t.u.info;break;case r.VNIL:case r.VFALSE:n=-1;break;default:n=Ee(e,t,1)}t.t=G(e,t.t,n),Z(e,t.f),t.f=-1},Ne=function(e,t,n){let r,a,L=U.expkind;if(!(r=P(t,!0))||!(a=P(n,!0))||!function(e,t,n){switch(e){case u:case s:case o:case f:case p:case l:return!1!==R.tointeger(t)&&!1!==R.tointeger(n);case i:case c:case _:return 0!==n.value;default:return 1}}(e,r,a))return 0;let h=new w;if(E.luaO_arith(null,e,r,a,h),h.ttisinteger())t.k=L.VKINT,t.u.ival=h.value;else{let e=h.value;if(isNaN(e)||0===e)return!1;t.k=L.VKFLT,t.u.nval=e}return!0},Re=function(e,t,n,r,a){let u=ke(e,r),l=ke(e,n);se(e,n,r),n.u.info=Q(e,t,0,l,u),n.k=U.expkind.VRELOCABLE,Se(e,a)},Se=function(e,t){e.f.lineinfo[e.pc-1]=t};e.exports.BinOpr=I,e.exports.NO_JUMP=-1,e.exports.UnOpr=y,e.exports.getinstruction=D,e.exports.luaK_checkstack=re,e.exports.luaK_code=W,e.exports.luaK_codeABC=Q,e.exports.luaK_codeABx=$,e.exports.luaK_codeAsBx=ee,e.exports.luaK_codek=ne,e.exports.luaK_concat=G,e.exports.luaK_dischargevars=Le,e.exports.luaK_exp2RK=ke,e.exports.luaK_exp2anyreg=be,e.exports.luaK_exp2anyregup=function(e,t){(t.k!==U.expkind.VUPVAL||M(t))&&be(e,t)},e.exports.luaK_exp2nextreg=Te,e.exports.luaK_exp2val=Oe,e.exports.luaK_fixline=Se,e.exports.luaK_getlabel=j,e.exports.luaK_goiffalse=Ue,e.exports.luaK_goiftrue=me,e.exports.luaK_indexed=function(e,t,n){let r=U.expkind;k(!M(t)&&(U.vkisinreg(t.k)||t.k===r.VUPVAL)),t.u.ind.t=t.u.info,t.u.ind.idx=ke(e,n),t.u.ind.vt=t.k===r.VUPVAL?r.VUPVAL:r.VLOCAL,t.k=r.VINDEXED},e.exports.luaK_infix=function(e,t,n){switch(t){case I.OPR_AND:me(e,n);break;case I.OPR_OR:Ue(e,n);break;case I.OPR_CONCAT:Te(e,n);break;case I.OPR_ADD:case I.OPR_SUB:case I.OPR_MUL:case I.OPR_DIV:case I.OPR_IDIV:case I.OPR_MOD:case I.OPR_POW:case I.OPR_BAND:case I.OPR_BOR:case I.OPR_BXOR:case I.OPR_SHL:case I.OPR_SHR:P(n,!1)||ke(e,n);break;default:ke(e,n)}},e.exports.luaK_intK=ie,e.exports.luaK_jump=K,e.exports.luaK_jumpto=function(e,t){return J(e,K(e),t)},e.exports.luaK_nil=C,e.exports.luaK_numberK=ce,e.exports.luaK_patchclose=function(e,t,n){for(n++;-1!==t;t=V(e,t)){let r=e.f.code[t];k(r.opcode===S.OP_JMP&&(0===r.A||r.A>=n)),m.SETARG_A(r,n)}},e.exports.luaK_patchlist=J,e.exports.luaK_patchtohere=Z,e.exports.luaK_posfix=function(e,t,n,r,u){let l=U.expkind;switch(t){case I.OPR_AND:k(-1===n.t),Le(e,r),r.f=G(e,r.f,n.f),n.to(r);break;case I.OPR_OR:k(-1===n.f),Le(e,r),r.t=G(e,r.t,n.t),n.to(r);break;case I.OPR_CONCAT:{Oe(e,r);let t=D(e,r);r.k===l.VRELOCABLE&&t.opcode===S.OP_CONCAT?(k(n.u.info===t.B-1),le(e,n),m.SETARG_B(t,n.u.info),n.k=l.VRELOCABLE,n.u.info=r.u.info):(Te(e,r),Re(e,S.OP_CONCAT,n,r,u));break}case I.OPR_ADD:case I.OPR_SUB:case I.OPR_MUL:case I.OPR_DIV:case I.OPR_IDIV:case I.OPR_MOD:case I.OPR_POW:case I.OPR_BAND:case I.OPR_BOR:case I.OPR_BXOR:case I.OPR_SHL:case I.OPR_SHR:Ne(t+a,n,r)||Re(e,t+S.OP_ADD,n,r,u);break;case I.OPR_EQ:case I.OPR_LT:case I.OPR_LE:case I.OPR_NE:case I.OPR_GT:case I.OPR_GE:!function(e,t,n,r){let a,u=U.expkind;n.k===u.VK?a=m.RKASK(n.u.info):(k(n.k===u.VNONRELOC),a=n.u.info);let l=ke(e,r);switch(se(e,n,r),t){case I.OPR_NE:n.u.info=F(e,S.OP_EQ,0,a,l);break;case I.OPR_GT:case I.OPR_GE:{let r=t-I.OPR_NE+S.OP_EQ;n.u.info=F(e,r,1,l,a);break}default:{let r=t-I.OPR_EQ+S.OP_EQ;n.u.info=F(e,r,1,a,l);break}}n.k=u.VJMP}(e,t,n,r)}return n},e.exports.luaK_prefix=function(e,t,n,r){let a=new U.expdesc;switch(a.k=U.expkind.VKINT,a.u.ival=a.u.nval=a.u.info=0,a.t=-1,a.f=-1,t){case y.OPR_MINUS:case y.OPR_BNOT:if(Ne(t+L,n,a))break;case y.OPR_LEN:!function(e,t,n,r){let a=be(e,n);le(e,n),n.u.info=Q(e,t,0,a,0),n.k=U.expkind.VRELOCABLE,Se(e,r)}(e,t+S.OP_UNM,n,r);break;case y.OPR_NOT:!function(e,t){let n=U.expkind;switch(Le(e,t),t.k){case n.VNIL:case n.VFALSE:t.k=n.VTRUE;break;case n.VK:case n.VKFLT:case n.VKINT:case n.VTRUE:t.k=n.VFALSE;break;case n.VJMP:ve(e,t);break;case n.VRELOCABLE:case n.VNONRELOC:Ae(e,t),le(e,t),t.u.info=Q(e,S.OP_NOT,0,t.u.info,0),t.k=n.VRELOCABLE}{let e=t.f;t.f=t.t,t.t=e}Y(e,t.f),Y(e,t.t)}(e,n)}},e.exports.luaK_reserveregs=ae,e.exports.luaK_ret=function(e,t,n){Q(e,S.OP_RETURN,t,n+1,0)},e.exports.luaK_self=function(e,t,n){be(e,t);let r=t.u.info;le(e,t),t.u.info=e.freereg,t.k=U.expkind.VNONRELOC,ae(e,2),Q(e,S.OP_SELF,t.u.info,r,ke(e,n)),le(e,n)},e.exports.luaK_setlist=function(e,t,n,a){let u=(n-1)/m.LFIELDS_PER_FLUSH+1,l=a===r?0:a;k(0!==a&&a<=m.LFIELDS_PER_FLUSH),u<=m.MAXARG_C?Q(e,S.OP_SETLIST,t,l,u):u<=m.MAXARG_Ax?(Q(e,S.OP_SETLIST,t,l,0),te(e,u)):v.luaX_syntaxerror(e.ls,O("constructor too long",!0)),e.freereg=t+1},e.exports.luaK_setmultret=function(e,t){fe(e,t,r)},e.exports.luaK_setoneret=pe,e.exports.luaK_setreturns=fe,e.exports.luaK_storevar=function(e,t,n){let r=U.expkind;switch(t.k){case r.VLOCAL:return le(e,n),void xe(e,n,t.u.info);case r.VUPVAL:{let r=be(e,n);Q(e,S.OP_SETUPVAL,r,t.u.info,0);break}case r.VINDEXED:{let a=t.u.ind.vt===r.VLOCAL?S.OP_SETTABLE:S.OP_SETTABUP,u=ke(e,n);Q(e,a,t.u.ind.t,t.u.ind.idx,u);break}}le(e,n)},e.exports.luaK_stringK=function(e,t){let n=new w(A,t);return oe(e,n,n)}},function(e,t,n){"use strict";const{LUA_SIGNATURE:r,constant_types:{LUA_TBOOLEAN:a,LUA_TLNGSTR:u,LUA_TNIL:l,LUA_TNUMFLT:s,LUA_TNUMINT:o,LUA_TSHRSTR:i},thread_status:{LUA_ERRSYNTAX:c},is_luastring:_,luastring_eq:f,to_luastring:p}=n(1),L=n(8),h=n(13),d=n(6),{MAXARG_sBx:A,POS_A:g,POS_Ax:x,POS_B:T,POS_Bx:b,POS_C:O,POS_OP:k,SIZE_A:v,SIZE_Ax:E,SIZE_B:m,SIZE_Bx:U,SIZE_C:N,SIZE_OP:R}=n(16),{lua_assert:S}=n(4),{luaS_bless:w}=n(10),{luaZ_read:I,ZIO:y}=n(19);let M=[25,147,13,10,26,10];class P{constructor(e,t,n){this.intSize=4,this.size_tSize=4,this.instructionSize=4,this.integerSize=4,this.numberSize=8,S(t instanceof y,"BytecodeParser only operates on a ZIO"),S(_(n)),64===n[0]||61===n[0]?this.name=n.subarray(1):n[0]==r[0]?this.name=p("binary string",!0):this.name=n,this.L=e,this.Z=t,this.arraybuffer=new ArrayBuffer(Math.max(this.intSize,this.size_tSize,this.instructionSize,this.integerSize,this.numberSize)),this.dv=new DataView(this.arraybuffer),this.u8=new Uint8Array(this.arraybuffer)}read(e){let t=new Uint8Array(e);return 0!==I(this.Z,t,0,e)&&this.error("truncated"),t}LoadByte(){return 0!==I(this.Z,this.u8,0,1)&&this.error("truncated"),this.u8[0]}LoadInt(){return 0!==I(this.Z,this.u8,0,this.intSize)&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadNumber(){return 0!==I(this.Z,this.u8,0,this.numberSize)&&this.error("truncated"),this.dv.getFloat64(0,!0)}LoadInteger(){return 0!==I(this.Z,this.u8,0,this.integerSize)&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadSize_t(){return this.LoadInteger()}LoadString(){let e=this.LoadByte();return 255===e&&(e=this.LoadSize_t()),0===e?null:w(this.L,this.read(e-1))}static MASK1(e,t){return~(-1<<e)<<t}LoadCode(e){let t=this.LoadInt(),n=P;for(let r=0;r<t;r++){0!==I(this.Z,this.u8,0,this.instructionSize)&&this.error("truncated");let t=this.dv.getUint32(0,!0);e.code[r]={code:t,opcode:t>>k&n.MASK1(R,0),A:t>>g&n.MASK1(v,0),B:t>>T&n.MASK1(m,0),C:t>>O&n.MASK1(N,0),Bx:t>>b&n.MASK1(U,0),Ax:t>>x&n.MASK1(E,0),sBx:(t>>b&n.MASK1(U,0))-A}}}LoadConstants(e){let t=this.LoadInt();for(let n=0;n<t;n++){let t=this.LoadByte();switch(t){case l:e.k.push(new d.TValue(l,null));break;case a:e.k.push(new d.TValue(a,0!==this.LoadByte()));break;case s:e.k.push(new d.TValue(s,this.LoadNumber()));break;case o:e.k.push(new d.TValue(o,this.LoadInteger()));break;case i:case u:e.k.push(new d.TValue(u,this.LoadString()));break;default:this.error(`unrecognized constant '${t}'`)}}}LoadProtos(e){let t=this.LoadInt();for(let n=0;n<t;n++)e.p[n]=new h.Proto(this.L),this.LoadFunction(e.p[n],e.source)}LoadUpvalues(e){let t=this.LoadInt();for(let n=0;n<t;n++)e.upvalues[n]={name:null,instack:this.LoadByte(),idx:this.LoadByte()}}LoadDebug(e){let t=this.LoadInt();for(let n=0;n<t;n++)e.lineinfo[n]=this.LoadInt();t=this.LoadInt();for(let n=0;n<t;n++)e.locvars[n]={varname:this.LoadString(),startpc:this.LoadInt(),endpc:this.LoadInt()};t=this.LoadInt();for(let n=0;n<t;n++)e.upvalues[n].name=this.LoadString()}LoadFunction(e,t){e.source=this.LoadString(),null===e.source&&(e.source=t),e.linedefined=this.LoadInt(),e.lastlinedefined=this.LoadInt(),e.numparams=this.LoadByte(),e.is_vararg=0!==this.LoadByte(),e.maxstacksize=this.LoadByte(),this.LoadCode(e),this.LoadConstants(e),this.LoadUpvalues(e),this.LoadProtos(e),this.LoadDebug(e)}checkliteral(e,t){let n=this.read(e.length);f(n,e)||this.error(t)}checkHeader(){this.checkliteral(r.subarray(1),"not a"),83!==this.LoadByte()&&this.error("version mismatch in"),0!==this.LoadByte()&&this.error("format mismatch in"),this.checkliteral(M,"corrupted"),this.intSize=this.LoadByte(),this.size_tSize=this.LoadByte(),this.instructionSize=this.LoadByte(),this.integerSize=this.LoadByte(),this.numberSize=this.LoadByte(),this.checksize(this.intSize,4,"int"),this.checksize(this.size_tSize,4,"size_t"),this.checksize(this.instructionSize,4,"instruction"),this.checksize(this.integerSize,4,"integer"),this.checksize(this.numberSize,8,"number"),22136!==this.LoadInteger()&&this.error("endianness mismatch in"),370.5!==this.LoadNumber()&&this.error("float format mismatch in")}error(e){d.luaO_pushfstring(this.L,p("%s: %s precompiled chunk"),this.name,p(e)),L.luaD_throw(this.L,c)}checksize(e,t,n){e!==t&&this.error(`${n} size mismatch in`)}}e.exports.luaU_undump=function(e,t,n){let r=new P(e,t,n);r.checkHeader();let a=h.luaF_newLclosure(e,r.LoadByte());return L.luaD_inctop(e),e.stack[e.top-1].setclLvalue(a),a.p=new h.Proto(e),r.LoadFunction(a.p,null),S(a.nupvalues===a.p.upvalues.length),a}},function(e,t,n){"use strict";const{LUA_SIGNATURE:r,LUA_VERSION_MAJOR:a,LUA_VERSION_MINOR:u,constant_types:{LUA_TBOOLEAN:l,LUA_TLNGSTR:s,LUA_TNIL:o,LUA_TNUMFLT:i,LUA_TNUMINT:c,LUA_TSHRSTR:_},luastring_of:f}=n(1),p=f(25,147,13,10,26,10),L=16*Number(a)+Number(u),h=function(e,t,n){0===n.status&&t>0&&(n.status=n.writer(n.L,e,t,n.data))},d=function(e,t){h(f(e),1,t)},A=function(e,t){let n=new ArrayBuffer(4);new DataView(n).setInt32(0,e,!0);let r=new Uint8Array(n);h(r,4,t)},g=function(e,t){let n=new ArrayBuffer(4);new DataView(n).setInt32(0,e,!0);let r=new Uint8Array(n);h(r,4,t)},x=function(e,t){let n=new ArrayBuffer(8);new DataView(n).setFloat64(0,e,!0);let r=new Uint8Array(n);h(r,8,t)},T=function(e,t){if(null===e)d(0,t);else{let n=e.tsslen()+1,r=e.getstr();n<255?d(n,t):(d(255,t),g(n,t)),h(r,n-1,t)}},b=function(e,t,n){n.strip||e.source===t?T(null,n):T(e.source,n),A(e.linedefined,n),A(e.lastlinedefined,n),d(e.numparams,n),d(e.is_vararg?1:0,n),d(e.maxstacksize,n),function(e,t){let n=e.code.map(e=>e.code);A(n.length,t);for(let e=0;e<n.length;e++)A(n[e],t)}(e,n),function(e,t){let n=e.k.length;A(n,t);for(let r=0;r<n;r++){let n=e.k[r];switch(d(n.ttype(),t),n.ttype()){case o:break;case l:d(n.value?1:0,t);break;case i:x(n.value,t);break;case c:g(n.value,t);break;case _:case s:T(n.tsvalue(),t)}}}(e,n),function(e,t){let n=e.upvalues.length;A(n,t);for(let r=0;r<n;r++)d(e.upvalues[r].instack?1:0,t),d(e.upvalues[r].idx,t)}(e,n),function(e,t){let n=e.p.length;A(n,t);for(let r=0;r<n;r++)b(e.p[r],e.source,t)}(e,n),function(e,t){let n=t.strip?0:e.lineinfo.length;A(n,t);for(let r=0;r<n;r++)A(e.lineinfo[r],t);n=t.strip?0:e.locvars.length,A(n,t);for(let r=0;r<n;r++)T(e.locvars[r].varname,t),A(e.locvars[r].startpc,t),A(e.locvars[r].endpc,t);n=t.strip?0:e.upvalues.length,A(n,t);for(let r=0;r<n;r++)T(e.upvalues[r].name,t)}(e,n)};e.exports.luaU_dump=function(e,t,n,a,u){let l=new class{constructor(){this.L=null,this.write=null,this.data=null,this.strip=NaN,this.status=NaN}};return l.L=e,l.writer=n,l.data=a,l.strip=u,l.status=0,function(e){h(r,r.length,e),d(L,e),d(0,e),h(p,p.length,e),d(4,e),d(4,e),d(4,e),d(4,e),d(8,e),g(22136,e),x(370.5,e)}(l),d(t.upvalues.length,l),b(t,null,l),l.status}},function(e,t,n){var r;!function(){"use strict";var a={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function u(e){return function(e,t){var n,r,l,s,o,i,c,_,f,p=1,L=e.length,h="";for(r=0;r<L;r++)if("string"==typeof e[r])h+=e[r];else if(Array.isArray(e[r])){if((s=e[r])[2])for(n=t[p],l=0;l<s[2].length;l++){if(!n.hasOwnProperty(s[2][l]))throw new Error(u('[sprintf] property "%s" does not exist',s[2][l]));n=n[s[2][l]]}else n=s[1]?t[s[1]]:t[p++];if(a.not_type.test(s[8])&&a.not_primitive.test(s[8])&&n instanceof Function&&(n=n()),a.numeric_arg.test(s[8])&&"number"!=typeof n&&isNaN(n))throw new TypeError(u("[sprintf] expecting number but found %T",n));switch(a.number.test(s[8])&&(_=n>=0),s[8]){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,s[6]?parseInt(s[6]):0);break;case"e":n=s[7]?parseFloat(n).toExponential(s[7]):parseFloat(n).toExponential();break;case"f":n=s[7]?parseFloat(n).toFixed(s[7]):parseFloat(n);break;case"g":n=s[7]?String(Number(n.toPrecision(s[7]))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=s[7]?n.substring(0,s[7]):n;break;case"t":n=String(!!n),n=s[7]?n.substring(0,s[7]):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=s[7]?n.substring(0,s[7]):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=s[7]?n.substring(0,s[7]):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}a.json.test(s[8])?h+=n:(!a.number.test(s[8])||_&&!s[3]?f="":(f=_?"+":"-",n=n.toString().replace(a.sign,"")),i=s[4]?"0"===s[4]?"0":s[4].charAt(1):" ",c=s[6]-(f+n).length,o=s[6]&&c>0?i.repeat(c):"",h+=s[5]?f+n+o:"0"===i?f+o+n:o+f+n)}return h}(function(e){if(s[e])return s[e];for(var t,n=e,r=[],u=0;n;){if(null!==(t=a.text.exec(n)))r.push(t[0]);else if(null!==(t=a.modulo.exec(n)))r.push("%");else{if(null===(t=a.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){u|=1;var l=[],o=t[2],i=[];if(null===(i=a.key.exec(o)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(l.push(i[1]);""!==(o=o.substring(i[0].length));)if(null!==(i=a.key_access.exec(o)))l.push(i[1]);else{if(null===(i=a.index_access.exec(o)))throw new SyntaxError("[sprintf] failed to parse named argument key");l.push(i[1])}t[2]=l}else u|=2;if(3===u)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push(t)}n=n.substring(t[0].length)}return s[e]=r}(e),arguments)}function l(e,t){return u.apply(null,[e].concat(t||[]))}var s=Object.create(null);t.sprintf=u,t.vsprintf=l,"undefined"!=typeof window&&(window.sprintf=u,window.vsprintf=l,void 0===(r=function(){return{sprintf:u,vsprintf:l}}.call(t,n,t,e))||(e.exports=r))}()},function(e,t,n){"use strict";const{lua_pop:r}=n(2),{luaL_requiref:a}=n(7),{to_luastring:u}=n(5),l={};e.exports.luaL_openlibs=function(e){for(let t in l)a(e,u(t),l[t],1),r(e,1)};const s=n(17),{luaopen_base:o}=n(24),{luaopen_coroutine:i}=n(25),{luaopen_debug:c}=n(31),{luaopen_math:_}=n(30),{luaopen_package:f}=n(32),{luaopen_os:p}=n(27),{luaopen_string:L}=n(28),{luaopen_table:h}=n(26),{luaopen_utf8:d}=n(29);l._G=o,l[s.LUA_LOADLIBNAME]=f,l[s.LUA_COLIBNAME]=i,l[s.LUA_TABLIBNAME]=h,l[s.LUA_OSLIBNAME]=p,l[s.LUA_STRLIBNAME]=L,l[s.LUA_MATHLIBNAME]=_,l[s.LUA_UTF8LIBNAME]=d,l[s.LUA_DBLIBNAME]=c;const{luaopen_fengari:A}=n(33);l[s.LUA_FENGARILIBNAME]=A}])}]);
//# sourceMappingURL=fengari.worker.js.map